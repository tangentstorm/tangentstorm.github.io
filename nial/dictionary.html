<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>q'nial dictionary version 6.3</title>
<!-- 2014-05-30 Fri 09:30 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="nial systems, limited" />
<link rel="stylesheet" type="text/css" href="/etc/style.css">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">q'nial dictionary version 6.3</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. <code>abs</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span></span></a>
<ul>
<li><a href="#sec-1-1">1.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-2">2. <code>ACCUMULATE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="apl">apl</span></span></a>
<ul>
<li><a href="#sec-2-1">2.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-2-2">2.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-3">3. <i>action</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-4">4. <code>ACROSS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-4-1">4.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-4-2">4.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-5">5. address&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-6">6. <code>allbools</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-6-1">6.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-7">7. <code>allchars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-7-1">7.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-8">8. <code>allin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-8-1">8.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-8-2">8.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-9">9. <code>allints</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-9-1">9.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-10">10. <code>allnumeric</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-10-1">10.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-11">11. <code>allreals</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></a>
<ul>
<li><a href="#sec-11-1">11.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-12">12. <code>and</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="bit">bit</span></span></a>
<ul>
<li><a href="#sec-12-1">12.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-13">13. <code>append</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="ctor">ctor</span></span></a>
<ul>
<li><a href="#sec-13-1">13.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-13-2">13.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-14">14. <code>appendfile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="file">file</span></span></a>
<ul>
<li><a href="#sec-14-1">14.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-15">15. <code>apply</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="eval">eval</span></span></a></li>
<li><a href="#sec-16">16. <code>arccos</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></a>
<ul>
<li><a href="#sec-16-1">16.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-16-2">16.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-17">17. <code>arcsin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></a>
<ul>
<li><a href="#sec-17-1">17.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-18">18. <code>arctan</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></a>
<ul>
<li><a href="#sec-18-1">18.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-19">19. argument&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-20">20. array&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-21">21. <code>assign</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="eval">eval</span></span></a></li>
<li><a href="#sec-22">22. <i>assign expression</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-23">23. <code>atlas</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-24">24. <code>atomic</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="test">test</span>&#xa0;<span class="struct">struct</span></span></a>
<ul>
<li><a href="#sec-24-1">24.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-24-2">24.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-25">25. <code>axes</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="metric">metric</span></span></a>
<ul>
<li><a href="#sec-25-1">25.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-25-2">25.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-26">26. <code>binary</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prop">prop</span></span></a></li>
<li><a href="#sec-27">27. binary pervasive&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></a>
<ul>
<li><a href="#sec-27-1">27.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-28">28. <code>blend</code></a>
<ul>
<li><a href="#sec-28-1">28.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-29">29. <i>block</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-30">30. <i>bracket-comma notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-31">31. <code>break</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></a></li>
<li><a href="#sec-32">32. <code>breakin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></a></li>
<li><a href="#sec-33">33. <code>breaklist</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></a></li>
<li><a href="#sec-34">34. <code>BYCOLS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></a>
<ul>
<li><a href="#sec-34-1">34.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-34-2">34.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-35">35. <code>bye</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ex">ex</span>&#xa0;<span class="sys">sys</span></span></a></li>
<li><a href="#sec-36">36. <code>BYKEY</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></a>
<ul>
<li><a href="#sec-36-1">36.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-36-2">36.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-37">37. <code>BYROWS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></a>
<ul>
<li><a href="#sec-37-1">37.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-37-2">37.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-38">38. by-variable&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-39">39. <code>callc</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></a></li>
<li><a href="#sec-40">40. <code>calldllfun</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></a></li>
<li><a href="#sec-41">41. <code>callstack</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></a></li>
<li><a href="#sec-42">42. canonical&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a>
<ul>
<li><a href="#sec-42-1">42.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-43">43. <code>cart</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="ctor">ctor</span></span></a>
<ul>
<li><a href="#sec-43-1">43.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-44">44. <code>case-expr</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ctrl">ctrl</span></span></a></li>
<li><a href="#sec-45">45. <i>cast</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span>&#xa0;<span class="table">table</span></span></a></li>
<li><a href="#sec-46">46. <code>catenate</code></a>
<ul>
<li><a href="#sec-46-1">46.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-47">47. <code>ceiling</code></a>
<ul>
<li><a href="#sec-47-1">47.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-48">48. <code>char</code></a>
<ul>
<li><a href="#sec-48-1">48.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-49">49. <code>charrep</code></a>
<ul>
<li><a href="#sec-49-1">49.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-50">50. <code>checkpoint</code></a></li>
<li><a href="#sec-51">51. <code>choose</code></a>
<ul>
<li><a href="#sec-51-1">51.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-51-2">51.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-52">52. clear workspace&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-53">53. <code>clearprofile</code></a>
<ul>
<li><a href="#sec-53-1">53.1. Example</a></li>
</ul>
</li>
<li><a href="#sec-54">54. <code>clearws</code></a></li>
<li><a href="#sec-55">55. <code>close</code></a></li>
<li><a href="#sec-56">56. <code>cols</code></a>
<ul>
<li><a href="#sec-56-1">56.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-56-2">56.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-57">57. <i>comment</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-58">58. conform</a>
<ul>
<li><a href="#sec-58-1">58.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-59">59. <code>content</code></a>
<ul>
<li><a href="#sec-59-1">59.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-59-2">59.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-60">60. <code>continue</code></a></li>
<li><a href="#sec-61">61. continue workspace&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-62">62. control tuples</a></li>
<li><a href="#sec-63">63. <code>CONVERSE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-63-1">63.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-63-2">63.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-64">64. <code>copyright</code></a></li>
<li><a href="#sec-65">65. <code>cos</code></a>
<ul>
<li><a href="#sec-65-1">65.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-66">66. <code>cosh</code></a>
<ul>
<li><a href="#sec-66-1">66.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-67">67. <code>count</code></a>
<ul>
<li><a href="#sec-67-1">67.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-67-2">67.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-68">68. <code>cull</code></a>
<ul>
<li><a href="#sec-68-1">68.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-68-2">68.2. Equations</a></li>
<li><a href="#sec-68-3">68.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-69">69. curried operation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-70">70. <code>cut</code></a>
<ul>
<li><a href="#sec-70-1">70.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-70-2">70.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-71">71. <code>cutall</code></a>
<ul>
<li><a href="#sec-71-1">71.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-72">72. debugging&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a>
<ul>
<li><a href="#sec-72-1">72.1. Debugging Definitions</a></li>
<li><a href="#sec-72-2">72.2. Defining a Break Point</a></li>
</ul>
</li>
<li><a href="#sec-73">73. <code>deepplace</code></a>
<ul>
<li><a href="#sec-73-1">73.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-73-2">73.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-74">74. <code>deepupdate</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="eval">eval</span></span></a></li>
<li><a href="#sec-75">75. definition</a></li>
<li><a href="#sec-76">76. <code>deparse</code></a>
<ul>
<li><a href="#sec-76-1">76.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-77">77. <code>depth</code></a>
<ul>
<li><a href="#sec-77-1">77.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-77-2">77.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-78">78. <code>descan</code></a>
<ul>
<li><a href="#sec-78-1">78.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-79">79. <code>diagram</code></a>
<ul>
<li><a href="#sec-79-1">79.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-80">80. dimensions&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-81">81. <code>display</code></a>
<ul>
<li><a href="#sec-81-1">81.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-82">82. <code>diverse</code></a>
<ul>
<li><a href="#sec-82-1">82.1. Definition</a></li>
<li><a href="#sec-82-2">82.2. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-83">83. <code>divide</code></a>
<ul>
<li><a href="#sec-83-1">83.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-84">84. <code>dlllist</code></a></li>
<li><a href="#sec-85">85. <code>DOWN</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-85-1">85.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-85-2">85.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-86">86. <code>drop</code></a>
<ul>
<li><a href="#sec-86-1">86.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-86-2">86.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-87">87. <del>dropright</del></a>
<ul>
<li><a href="#sec-87-1">87.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-88">88. <code>EACH</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-88-1">88.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-89">89. <code>EACHALL</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-89-1">89.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-89-2">89.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-90">90. <code>EACHBOTH</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-90-1">90.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-90-2">90.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-91">91. <code>EACHLEFT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-91-1">91.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-91-2">91.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-92">92. <code>EACHRIGHT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-92-1">92.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-92-2">92.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-93">93. <code>edit</code></a></li>
<li><a href="#sec-94">94. <code>empty</code></a>
<ul>
<li><a href="#sec-94-1">94.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-95">95. <code>equal</code></a>
<ul>
<li><a href="#sec-95-1">95.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-96">96. equations</a></li>
<li><a href="#sec-97">97. <span class="todo TODO">TODO</span> <code>erase</code></a></li>
<li><a href="#sec-98">98. <code>eraserecord</code></a></li>
<li><a href="#sec-99">99. <code>eval</code></a>
<ul>
<li><a href="#sec-99-1">99.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-100">100. <code>except</code></a>
<ul>
<li><a href="#sec-100-1">100.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-100-2">100.2. Equations</a></li>
<li><a href="#sec-100-3">100.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-101">101. <code>execute</code></a>
<ul>
<li><a href="#sec-101-1">101.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-101-2">101.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-102">102. <code>exp</code></a>
<ul>
<li><a href="#sec-102-1">102.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-103">103. expression&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-104">104. <i>expression sequence</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-105">105. <code>exprs</code></a>
<ul>
<li><a href="#sec-105-1">105.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-106">106. extent</a></li>
<li><a href="#sec-107">107. <i>external declaration</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-108">108. <code>false</code></a>
<ul>
<li><a href="#sec-108-1">108.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-109">109. <code>fault</code></a>
<ul>
<li><a href="#sec-109-1">109.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-110">110. fault triggering</a></li>
<li><a href="#sec-111">111. fault values&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></a></li>
<li><a href="#sec-112">112. <code>filelength</code></a></li>
<li><a href="#sec-113">113. <code>filepath</code></a>
<ul>
<li><a href="#sec-113-1">113.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-114">114. <code>filestatus</code></a></li>
<li><a href="#sec-115">115. <code>filetally</code></a></li>
<li><a href="#sec-116">116. <code>FILTER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-116-1">116.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-116-2">116.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-117">117. <code>find</code></a>
<ul>
<li><a href="#sec-117-1">117.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-117-2">117.2. Equations</a></li>
<li><a href="#sec-117-3">117.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-118">118. <code>findall</code></a>
<ul>
<li><a href="#sec-118-1">118.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-118-2">118.2. Equations</a></li>
<li><a href="#sec-118-3">118.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-119">119. <code>first</code></a>
<ul>
<li><a href="#sec-119-1">119.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-119-2">119.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-120">120. <del>flip</del></a></li>
<li><a href="#sec-121">121. <code>floor</code></a>
<ul>
<li><a href="#sec-121-1">121.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-122">122. <code>FOLD</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-122-1">122.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-122-2">122.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-123">123. <code>FORK</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-123-1">123.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-124">124. <code>for</code>-loop</a></li>
<li><a href="#sec-125">125. <code>fromraw</code></a>
<ul>
<li><a href="#sec-125-1">125.1. Equations</a></li>
<li><a href="#sec-125-2">125.2. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-126">126. <code>front</code></a>
<ul>
<li><a href="#sec-126-1">126.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-126-2">126.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-127">127. functions in nial</a></li>
<li><a href="#sec-128">128. <code>fuse</code></a>
<ul>
<li><a href="#sec-128-1">128.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-129">129. <code>gage</code></a>
<ul>
<li><a href="#sec-129-1">129.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-130">130. <code>getdef</code></a></li>
<li><a href="#sec-131">131. <code>getfile</code></a>
<ul>
<li><a href="#sec-131-1">131.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-132">132. <code>getname</code></a></li>
<li><a href="#sec-133">133. <code>getsyms</code></a></li>
<li><a href="#sec-134">134. global environment</a></li>
<li><a href="#sec-135">135. <code>GRADE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-135-1">135.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-136">136. <code>gradeup</code></a>
<ul>
<li><a href="#sec-136-1">136.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-137">137. <code>grid</code></a>
<ul>
<li><a href="#sec-137-1">137.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-137-2">137.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-138">138. <code>gt</code></a>
<ul>
<li><a href="#sec-138-1">138.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-139">139. <code>gte</code></a>
<ul>
<li><a href="#sec-139-1">139.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-140">140. <code>help</code></a></li>
<li><a href="#sec-141">141. <code>hitch</code></a>
<ul>
<li><a href="#sec-141-1">141.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-141-2">141.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-142">142. <code>host</code></a></li>
<li><a href="#sec-143">143. <code>if</code>-expr</a></li>
<li><a href="#sec-144">144. <code>in</code></a>
<ul>
<li><a href="#sec-144-1">144.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-144-2">144.2. Equations</a></li>
<li><a href="#sec-144-3">144.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-145">145. indexing&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></a></li>
<li><a href="#sec-146">146. <i>infix notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-147">147. initial subdirectory</a></li>
<li><a href="#sec-148">148. <code>INNER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-148-1">148.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-148-2">148.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-149">149. <code>innerproduct</code></a></li>
<li><a href="#sec-150">150. interrupt</a></li>
<li><a href="#sec-151">151. <code>inverse</code></a>
<ul>
<li><a href="#sec-151-1">151.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-152">152. <code>isboolean</code></a>
<ul>
<li><a href="#sec-152-1">152.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-153">153. <code>ischar</code></a>
<ul>
<li><a href="#sec-153-1">153.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-154">154. <code>isfault</code></a>
<ul>
<li><a href="#sec-154-1">154.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-155">155. <code>isinteger</code></a>
<ul>
<li><a href="#sec-155-1">155.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-156">156. <code>isphrase</code></a>
<ul>
<li><a href="#sec-156-1">156.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-157">157. <code>isreal</code></a>
<ul>
<li><a href="#sec-157-1">157.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-158">158. <code>isstring</code></a>
<ul>
<li><a href="#sec-158-1">158.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-158-2">158.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-159">159. item</a></li>
<li><a href="#sec-160">160. <code>ITERATE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-160-1">160.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-161">161. <i>juxtaposition</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span>&#xa0;<span class="table">table</span></span></a></li>
<li><a href="#sec-162">162. <code>laminate</code></a>
<ul>
<li><a href="#sec-162-1">162.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-163">163. <code>last</code></a>
<ul>
<li><a href="#sec-163-1">163.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-163-2">163.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-164">164. <span class="todo TODO">TODO</span> <code>latent</code></a></li>
<li><a href="#sec-165">165. <code>LEAF</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-165-1">165.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-165-2">165.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-166">166. level</a></li>
<li><a href="#sec-167">167. <code>libpath</code></a></li>
<li><a href="#sec-168">168. <code>library</code></a></li>
<li><a href="#sec-169">169. <code>like</code></a>
<ul>
<li><a href="#sec-169-1">169.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-170">170. <code>link</code></a>
<ul>
<li><a href="#sec-170-1">170.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-171">171. <code>list</code></a>
<ul>
<li><a href="#sec-171-1">171.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-171-2">171.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-172">172. <code>ln</code></a>
<ul>
<li><a href="#sec-172-1">172.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-173">173. <code>load</code></a></li>
<li><a href="#sec-174">174. <code>loaddefs</code></a></li>
<li><a href="#sec-175">175. local environment</a></li>
<li><a href="#sec-176">176. <code>log</code></a>
<ul>
<li><a href="#sec-176-1">176.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-177">177. log file</a></li>
<li><a href="#sec-178">178. <code>lower</code></a>
<ul>
<li><a href="#sec-178-1">178.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-178-2">178.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-179">179. <code>lt</code></a>
<ul>
<li><a href="#sec-179-1">179.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-180">180. <code>lte</code></a></li>
<li><a href="#sec-181">181. <code>match</code></a></li>
<li><a href="#sec-182">182. <code>mate</code></a>
<ul>
<li><a href="#sec-182-1">182.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-183">183. <code>max</code></a>
<ul>
<li><a href="#sec-183-1">183.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-184">184. <code>min</code></a>
<ul>
<li><a href="#sec-184-1">184.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-185">185. <code>minus</code></a>
<ul>
<li><a href="#sec-185-1">185.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-186">186. <code>mix</code></a>
<ul>
<li><a href="#sec-186-1">186.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-186-2">186.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-187">187. <code>mod</code></a>
<ul>
<li><a href="#sec-187-1">187.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-187-2">187.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-188">188. <del>mold</del></a>
<ul>
<li><a href="#sec-188-1">188.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-189">189. multi pervasive</a>
<ul>
<li><a href="#sec-189-1">189.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-190">190. nested definition</a></li>
<li><a href="#sec-191">191. <code>next</code></a></li>
<li><a href="#sec-192">192. <code>nialroot</code></a></li>
<li><a href="#sec-193">193. <code>no_expr</code></a></li>
<li><a href="#sec-194">194. <code>no_op</code></a></li>
<li><a href="#sec-195">195. <code>NO_TR</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a></li>
<li><a href="#sec-196">196. <code>?no_value</code></a></li>
<li><a href="#sec-197">197. <code>not</code></a>
<ul>
<li><a href="#sec-197-1">197.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-198">198. <code>notin</code></a>
<ul>
<li><a href="#sec-198-1">198.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-198-2">198.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-199">199. <code>null</code></a>
<ul>
<li><a href="#sec-199-1">199.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-199-2">199.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-200">200. numeric type hierarchy</a></li>
<li><a href="#sec-201">201. <code>open</code></a></li>
<li><a href="#sec-202">202. operation</a></li>
<li><a href="#sec-203">203. operation composition</a></li>
<li><a href="#sec-204">204. <i>operation form</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-205">205. <code>opposite</code></a>
<ul>
<li><a href="#sec-205-1">205.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-205-2">205.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-206">206. <code>ops</code></a>
<ul>
<li><a href="#sec-206-1">206.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-207">207. <code>or</code></a>
<ul>
<li><a href="#sec-207-1">207.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-208">208. <code>OUTER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-208-1">208.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-208-2">208.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-209">209. overflow</a></li>
<li><a href="#sec-210">210. <code>pack</code></a>
<ul>
<li><a href="#sec-210-1">210.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-211">211. <code>pair</code></a>
<ul>
<li><a href="#sec-211-1">211.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-211-2">211.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-212">212. <code>parse</code></a>
<ul>
<li><a href="#sec-212-1">212.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-213">213. <code>PARTITION</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-213-1">213.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-213-2">213.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-214">214. <code>pass</code></a>
<ul>
<li><a href="#sec-214-1">214.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-214-2">214.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-215">215. <code>paste</code></a></li>
<li><a href="#sec-216">216. pervasive</a></li>
<li><a href="#sec-217">217. <code>phrase</code></a>
<ul>
<li><a href="#sec-217-1">217.1. Equations</a></li>
<li><a href="#sec-217-2">217.2. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-218">218. <code>pi</code></a></li>
<li><a href="#sec-219">219. <code>pick</code></a>
<ul>
<li><a href="#sec-219-1">219.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-220">220. <code>picture</code></a>
<ul>
<li><a href="#sec-220-1">220.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-221">221. <code>place</code></a>
<ul>
<li><a href="#sec-221-1">221.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-222">222. <code>placeall</code></a>
<ul>
<li><a href="#sec-222-1">222.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-223">223. <code>plus</code></a></li>
<li><a href="#sec-224">224. <code>positions</code></a></li>
<li><a href="#sec-225">225. <code>post</code></a>
<ul>
<li><a href="#sec-225-1">225.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-225-2">225.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-226">226. <code>power</code></a>
<ul>
<li><a href="#sec-226-1">226.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-227">227. predicate</a></li>
<li><a href="#sec-228">228. <i>prefix notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-229">229. prelattice of atoms</a></li>
<li><a href="#sec-230">230. <code>product</code></a>
<ul>
<li><a href="#sec-230-1">230.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-231">231. <code>profile</code></a></li>
<li><a href="#sec-232">232. <code>profiletable</code></a></li>
<li><a href="#sec-233">233. <code>profiletree</code></a></li>
<li><a href="#sec-234">234. profiling</a></li>
<li><a href="#sec-235">235. program fragment</a></li>
<li><a href="#sec-236">236. <code>putfile</code></a>
<ul>
<li><a href="#sec-236-1">236.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-237">237. <code>quiet_fault</code></a>
<ul>
<li><a href="#sec-237-1">237.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-238">238. <code>quotient</code></a></li>
<li><a href="#sec-239">239. <code>raise</code></a>
<ul>
<li><a href="#sec-239-1">239.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-239-2">239.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-240">240. <code>random</code></a></li>
<li><a href="#sec-241">241. <code>RANK</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-241-1">241.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-242">242. <code>reach</code></a>
<ul>
<li><a href="#sec-242-1">242.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-242-2">242.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-243">243. <code>read</code></a>
<ul>
<li><a href="#sec-243-1">243.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-244">244. <code>readarray</code></a></li>
<li><a href="#sec-245">245. <code>readchar</code></a></li>
<li><a href="#sec-246">246. <code>readcursor</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="kvm">kvm</span></span></a></li>
<li><a href="#sec-247">247. <code>readfield</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-248">248. <code>readfile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-249">249. <code>readrecord</code></a></li>
<li><a href="#sec-250">250. <code>readscreen</code></a></li>
<li><a href="#sec-251">251. <code>reciprocal</code></a>
<ul>
<li><a href="#sec-251-1">251.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-251-2">251.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-252">252. <code>recover</code></a></li>
<li><a href="#sec-253">253. <code>RECUR</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-253-1">253.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-253-2">253.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-254">254. <code>REDUCE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-254-1">254.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-254-2">254.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-255">255. <code>REDUCECOLS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-255-1">255.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-256">256. <code>REDUCEROWS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-256-1">256.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-257">257. reductive</a></li>
<li><a href="#sec-258">258. <code>refresh</code></a></li>
<li><a href="#sec-259">259. <code>regexp</code></a></li>
<li><a href="#sec-260">260. <code>regexp_match</code></a></li>
<li><a href="#sec-261">261. <code>regexp_substitute</code></a></li>
<li><a href="#sec-262">262. <code>registerdllfun</code></a>
<ul>
<li><a href="#sec-262-1">262.1. Calling Conventions (C or Pascal)</a></li>
<li><a href="#sec-262-2">262.2. Arguments to DLL routines</a></li>
<li><a href="#sec-262-3">262.3. Variable Parameters</a></li>
<li><a href="#sec-262-4">262.4. Example 1</a></li>
<li><a href="#sec-262-5">262.5. Example 2</a></li>
<li><a href="#sec-262-6">262.6. A Word of Warning</a></li>
</ul>
</li>
<li><a href="#sec-263">263. regular expression notation</a></li>
<li><a href="#sec-264">264. repeat-loop</a></li>
<li><a href="#sec-265">265. <i>reserved words</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-266">266. <code>reshap</code></a>
<ul>
<li><a href="#sec-266-1">266.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-267">267. <code>rest</code></a>
<ul>
<li><a href="#sec-267-1">267.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-267-2">267.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-268">268. <code>restart</code></a></li>
<li><a href="#sec-269">269. <code>resume</code></a></li>
<li><a href="#sec-270">270. <code>reverse</code></a>
<ul>
<li><a href="#sec-270-1">270.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-270-2">270.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-271">271. role</a></li>
<li><a href="#sec-272">272. <code>rotate</code></a>
<ul>
<li><a href="#sec-272-1">272.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-272-2">272.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-273">273. <code>rows</code></a>
<ul>
<li><a href="#sec-273-1">273.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-273-2">273.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-274">274. <code>save</code></a></li>
<li><a href="#sec-275">275. <code>scan</code></a>
<ul>
<li><a href="#sec-275-1">275.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-276">276. scope of a variable</a></li>
<li><a href="#sec-277">277. <code>screensize</code></a></li>
<li><a href="#sec-278">278. <code>second</code></a>
<ul>
<li><a href="#sec-278-1">278.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-278-2">278.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-279">279. <code>see</code></a>
<ul>
<li><a href="#sec-279-1">279.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-280">280. <code>seed</code></a></li>
<li><a href="#sec-281">281. <code>seek</code></a>
<ul>
<li><a href="#sec-281-1">281.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-281-2">281.2. Equations</a></li>
<li><a href="#sec-281-3">281.3. Pragmatics</a></li>
</ul>
</li>
<li><a href="#sec-282">282. <code>seeprimcalls</code></a></li>
<li><a href="#sec-283">283. <code>seeusercalls</code></a></li>
<li><a href="#sec-284">284. <code>separator</code></a></li>
<li><a href="#sec-285">285. <code>set</code></a></li>
<li><a href="#sec-286">286. <code>setdeftrace</code></a></li>
<li><a href="#sec-287">287. <code>setformat</code></a></li>
<li><a href="#sec-288">288. <code>setinterrupts</code></a></li>
<li><a href="#sec-289">289. <code>setlogname</code></a></li>
<li><a href="#sec-290">290. <code>setprofile</code></a>
<ul>
<li><a href="#sec-290-1">290.1. Example of use:</a></li>
</ul>
</li>
<li><a href="#sec-291">291. <code>setprompt</code></a></li>
<li><a href="#sec-292">292. <code>settrigger</code></a></li>
<li><a href="#sec-293">293. <code>setwidth</code></a></li>
<li><a href="#sec-294">294. <code>shape</code></a>
<ul>
<li><a href="#sec-294-1">294.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-295">295. <code>simple</code></a>
<ul>
<li><a href="#sec-295-1">295.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-295-2">295.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-296">296. <code>sin</code></a>
<ul>
<li><a href="#sec-296-1">296.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-297">297. <code>single</code></a>
<ul>
<li><a href="#sec-297-1">297.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-297-2">297.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-298">298. <code>sinh</code></a>
<ul>
<li><a href="#sec-298-1">298.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-299">299. <code>sketch</code></a>
<ul>
<li><a href="#sec-299-1">299.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-299-2">299.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-300">300. <code>solitary</code></a>
<ul>
<li><a href="#sec-300-1">300.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-300-2">300.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-301">301. <code>solve</code></a></li>
<li><a href="#sec-302">302. <code>SORT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-302-1">302.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-302-2">302.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-303">303. <code>sortup</code></a>
<ul>
<li><a href="#sec-303-1">303.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-303-2">303.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-304">304. <code>split</code></a>
<ul>
<li><a href="#sec-304-1">304.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-304-2">304.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-305">305. <code>sqrt</code></a>
<ul>
<li><a href="#sec-305-1">305.1. Example</a></li>
<li><a href="#sec-305-2">305.2. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-305-3">305.3. Equation</a></li>
</ul>
</li>
<li><a href="#sec-306">306. standard definitions&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-307">307. <code>status</code></a></li>
<li><a href="#sec-308">308. <code>step</code></a></li>
<li><a href="#sec-309">309. <code>stepin</code></a></li>
<li><a href="#sec-310">310. <i>strand notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-311">311. <code>string</code></a>
<ul>
<li><a href="#sec-311-1">311.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-312">312. <code>string_split</code></a></li>
<li><a href="#sec-313">313. <code>string_translate</code></a></li>
<li><a href="#sec-314">314. <code>sublist</code></a>
<ul>
<li><a href="#sec-314-1">314.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-315">315. <code>sum</code></a>
<ul>
<li><a href="#sec-315-1">315.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-316">316. <code>symbols</code></a></li>
<li><a href="#sec-317">317. <i>synonym</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-318">318. <code>system</code></a></li>
<li><a href="#sec-319">319. <code>take</code></a>
<ul>
<li><a href="#sec-319-1">319.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-320">320. <del>takeright</del></a>
<ul>
<li><a href="#sec-320-1">320.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-321">321. <code>tally</code></a>
<ul>
<li><a href="#sec-321-1">321.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-321-2">321.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-322">322. <code>tan</code></a>
<ul>
<li><a href="#sec-322-1">322.1. Definition Equation</a></li>
</ul>
</li>
<li><a href="#sec-323">323. <code>tanh</code></a>
<ul>
<li><a href="#sec-323-1">323.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-323-2">323.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-324">324. <code>TEAM</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a></li>
<li><a href="#sec-325">325. <code>tell</code></a>
<ul>
<li><a href="#sec-325-1">325.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-326">326. <code>third</code></a>
<ul>
<li><a href="#sec-326-1">326.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-326-2">326.2. Equation</a></li>
</ul>
</li>
<li><a href="#sec-327">327. <code>time</code></a></li>
<li><a href="#sec-328">328. <span class="todo TODO">TODO</span> <code>TIMEIT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a></li>
<li><a href="#sec-329">329. <code>times</code></a></li>
<li><a href="#sec-330">330. <code>timestamp</code></a></li>
<li><a href="#sec-331">331. <code>toend</code></a></li>
<li><a href="#sec-332">332. <code>tolower</code></a></li>
<li><a href="#sec-333">333. <code>tonumber</code></a>
<ul>
<li><a href="#sec-333-1">333.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-334">334. top level loop&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></a></li>
<li><a href="#sec-335">335. <code>topic</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="old">old</span></span></a></li>
<li><a href="#sec-336">336. <code>toplevel</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ex">ex</span></span></a></li>
<li><a href="#sec-337">337. <code>toraw</code></a>
<ul>
<li><a href="#sec-337-1">337.1. Equation</a></li>
</ul>
</li>
<li><a href="#sec-338">338. <code>toupper</code></a></li>
<li><a href="#sec-339">339. transformer</a></li>
<li><a href="#sec-340">340. <i>transformer form</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a></li>
<li><a href="#sec-341">341. <code>transpose</code></a>
<ul>
<li><a href="#sec-341-1">341.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-341-2">341.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-342">342. <code>trs</code></a>
<ul>
<li><a href="#sec-342-1">342.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-343">343. <code>true</code></a>
<ul>
<li><a href="#sec-343-1">343.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-343-2">343.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-344">344. <code>TWIG</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></a>
<ul>
<li><a href="#sec-344-1">344.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-344-2">344.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-345">345. <code>type</code></a></li>
<li><a href="#sec-346">346. unary pervasive</a>
<ul>
<li><a href="#sec-346-1">346.1. Equations</a></li>
</ul>
</li>
<li><a href="#sec-347">347. <code>unequal</code></a>
<ul>
<li><a href="#sec-347-1">347.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-348">348. <code>up</code></a>
<ul>
<li><a href="#sec-348-1">348.1. Equations</a></li>
<li><a href="#sec-348-2">348.2. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-349">349. <code>update</code></a></li>
<li><a href="#sec-350">350. <code>updateall</code></a></li>
<li><a href="#sec-351">351. user primitives</a></li>
<li><a href="#sec-352">352. <code>vacate</code></a>
<ul>
<li><a href="#sec-352-1">352.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-352-2">352.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-353">353. <code>valence</code></a>
<ul>
<li><a href="#sec-353-1">353.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-353-2">353.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-354">354. <code>value</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="eval">eval</span></span></a></li>
<li><a href="#sec-355">355. <i>variable</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></a>
<ul>
<li><a href="#sec-355-1">355.1. Role of a Variable</a></li>
<li><a href="#sec-355-2">355.2. Indexed Variable</a></li>
</ul>
</li>
<li><a href="#sec-356">356. <code>vars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="sys">sys</span></span></a>
<ul>
<li><a href="#sec-356-1">356.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-357">357. <code>version</code></a></li>
<li><a href="#sec-358">358. <del>void</del></a>
<ul>
<li><a href="#sec-358-1">358.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
<li><a href="#sec-358-2">358.2. Equations</a></li>
</ul>
</li>
<li><a href="#sec-359">359. <code>watch</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="debug">debug</span></span></a></li>
<li><a href="#sec-360">360. <code>watchlist</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="debug">debug</span></span></a></li>
<li><a href="#sec-361">361. <code>while</code>-loop&#xa0;&#xa0;&#xa0;<span class="tag"><span class="control">control</span></span></a></li>
<li><a href="#sec-362">362. <code>window</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="gui">gui</span></span></a></li>
<li><a href="#sec-363">363. <code>write</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="io">io</span></span></a>
<ul>
<li><a href="#sec-363-1">363.1. Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></a></li>
</ul>
</li>
<li><a href="#sec-364">364. <code>writearray</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-365">365. <code>writechars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-366">366. <code>writefield</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a>
<ul>
<li><a href="#sec-366-1">366.1. Example</a></li>
</ul>
</li>
<li><a href="#sec-367">367. <code>writefile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-368">368. <code>writerecord</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></a></li>
<li><a href="#sec-369">369. <code>writescreen</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="io">io</span></span></a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> <code>abs</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span></span></h2>
<div class="outline-text-2" id="text-1">

<p>
The operation <a href="#sec-1">1</a> produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">corresponding integer</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">absolute value</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">absolute value</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<p>
If the argument is the largest negative integer for the computer, the result is the corresponding positive real number because the corresponding positive integer is too large for representation as an integer.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">abs</span>  l  -2  3.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1 2 3.5 ?A ?A ?error
</pre>

<p>
The operation <a href="#sec-1">1</a> can be used to convert a boolean value to an integer.  Its primary use is in the numeric domains, where it is used to give a positive number measuring the size of a number.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Equations</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">abs</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A
<span style="color: #ffffff; font-weight: bold;">abs</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> <code>ACCUMULATE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="apl">apl</span></span></h2>
<div class="outline-text-2" id="text-2">

<p>
The transformer <i>=ACCUMULATE=</i> is similar to the concept of scan in APL.  It computes the partial reductions of the initial lists of the items of A, using <i>=REDUCE=</i> f (a right-to-left reduction) to compute each partial result.  (A reductive operation is one which when applied to an array having a number of items returns a single result.)
</p>

<p>
In the example below, the initial lists of Z are:
</p>

<pre class="example">
[13, 13 39, 13 39 92, 13 39 92 45];
</pre>

<p>
and the right-to-left reduction of f on Z is equivalent to:
</p>

<pre class="example">
[f 13, 13 f 39, 13 f (39 f 92), 13 f (39 f ( 92 f 45))]
</pre>

<div class="org-src-container">

<pre class="src src-nial">Z <span style="color: #ff00ff;">:=</span> 13 39 92 45 ;
<span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">pass</span> Z
</pre>
</div>
<pre class="example">
+--+-----+----------+---------------+
|13|13 39|+--+-----+|+--+----------+|
|  |     ||13|39 92|||13|+--+-----+||
|  |     |+--+-----+||  ||39|92 45|||
|  |     |          ||  |+--+-----+||
|  |     |          |+--+----------+|
+--+-----+----------+---------------+
</pre>

<p>
The first example shows that accumulate builds the result values with a right-to-left reduction.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">max</span> Z
</pre>
</div>
<pre class="example">
13 39 92 92
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">min</span> Z
</pre>
</div>
<pre class="example">
13 13 13 13
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (<span style="color: #ffffff; font-weight: bold;">count</span> 10)
</pre>
</div>
<pre class="example">
1 3 6 10 15 21 28 36 45 55
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">minus</span> (<span style="color: #ffffff; font-weight: bold;">count</span> 10)
</pre>
</div>
<pre class="example">
1 -1 2 -2 3 -3 4 -4 5 -5
</pre>

<p>
Useful applications of <i>=ACCUMULATE=</i> include the accumulate sum transform used to compute a running sum, and the accumulate minus transform which gives an alternating sum.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">or</span> oollooll
</pre>
</div>
<pre class="example">
oollllll
</pre>

<div class="org-src-container">

<pre class="src src-nial">S <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'  black and white'</span>
</pre>
</div>
<pre class="example">
black and white
</pre>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">not</span> (S <span style="color: #ffffff; font-weight: bold;">match</span> ` )
</pre>
</div>
<pre class="example">
oolllllolllolllll
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #ffffff; font-weight: bold;">or</span> B <span style="color: #ffffff; font-weight: bold;">sublist</span> S
</pre>
</div>
<pre class="example">
black and white
</pre>

<p>
The <i>=ACCUMULATE=</i> <a href="#sec-207">207</a> transform produces a bitstring that can be used with sublist to drop leading items that fail to meet a predicate.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACCUMULATE</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
        heads <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
           <span style="color: #ffffff; font-weight: bold;">count</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">take</span> <span style="color: #ffffff; font-weight: bold;">list</span> A};
        <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">REDUCE</span> f heads A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Equations</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">ACCUMULATE</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffff00;">ACCUMULATE</span> f <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
<span style="color: #ffff00;">ACCUMULATE</span> f <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffff00;">ACCUMULATE</span> f <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffff00;">ACCUMULATE</span> f[A,B,C]<span style="color: #ff00ff; font-weight: bold;">=</span>[A,A f B,A f(B f C)]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> <i>action</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-3">

<p>
An action is the construct that is entered in the interactive loop of the Q'Nial interpreter or accepted as an input unit within the operation loaddefs:
</p>

<pre class="example">
action ::= definition-sequence
   | expression-sequence
   | external-declaration
   | remark
</pre>

<pre class="example">
definition-sequence ::= definition
   { ; definition } [ ; ]
</pre>

<pre class="example">
remark ::= # &lt; any text &gt;
</pre>

<p>
If an action is a definition-sequence, its definitions are installed in the global environment.
</p>

<p>
If an action is an expression-sequence, it is executed and a value is returned.  The value returned by an expression-sequence is displayed on the screen unless it is the fault ?noexpr.
</p>

<p>
An external-declaration assigns a role to a name in the global environment so that the name can be used in other definitions before it is completely specified.
</p>

<p>
A remark is an input to the Q'Nial interpreter that is not processed.  It begins with a line that has the symbol # as the first non-blank character in the line.  In direct input at the top level loop, a remark ends at the end of the line unless a backslash symbol ( \ ) is used to extend the line.  In a definition file, a remark ends at the first blank line.  A remark cannot appear within a definition or expression-sequence.
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> <code>ACROSS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-4">

<p>
<i>=ACROSS=</i> is a general recursion transformer for traversing the length of an array. It has three operation arguments: endf is applied to the end argument before starting to build the result, parta computes the left value from the argument, which is stacked, and joinf combines the left and right values as the recursion unwinds.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACROSS</span> [ 0 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">plus</span> ] 3 4 5 6
</pre>
</div>
<pre class="example">
18
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reshape</span> [ <span style="color: #ffffff; font-weight: bold;">shape</span>, <span style="color: #ffff00;">ACROSS</span>  [<span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffff00;">CONVERSE</span> <span style="color: #ffffff; font-weight: bold;">append</span> ] ] 2 15 12 4
</pre>
</div>
<pre class="example">
4 12 15 2
</pre>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACROSS</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> endf parta joinf <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
        A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A;
        Res <span style="color: #ff00ff;">:=</span> endf <span style="color: #ffffff; font-weight: bold;">void</span> <span style="color: #ffffff; font-weight: bold;">last</span> A;
        <span style="color: #00ffff;">FOR</span> I <span style="color: #00ffff;">WITH</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #00ffff;">DO</span>
                Res <span style="color: #ff00ff;">:=</span> parta A@I joinf Res
        <span style="color: #00ffff;">ENDFOR</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Equations</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ACROSS</span> [endf, parta, joinf] A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">RECUR</span> [<span style="color: #ffffff; font-weight: bold;">empty</span>, endf, parta <span style="color: #ffffff; font-weight: bold;">first</span>, joinf, <span style="color: #ffffff; font-weight: bold;">rest</span> ] <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">sum</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">ACROSS</span> [ 0 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">plus</span> ] A
<span style="color: #ffffff; font-weight: bold;">reverse</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> [ <span style="color: #ffffff; font-weight: bold;">shape</span>, <span style="color: #ffff00;">ACROSS</span>  [<span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffff00;">CONVERSE</span> <span style="color: #ffffff; font-weight: bold;">append</span> ] ] A
<span style="color: #ffff00;">EACH</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> [ <span style="color: #ffffff; font-weight: bold;">shape</span>, <span style="color: #ffff00;">ACROSS</span> [ <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">first</span>, f, <span style="color: #ffffff; font-weight: bold;">hitch</span> ] ] A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> address&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-5">

<p>
An address is an integer or a list of integers describing the location of an item in an array. An address uses 0-origin counting, i.e. the first position in a list is at address 0. All the addresses of an array can be stored in an array of the same rectangular structure as the array itself.  Such an array is called the grid of an array.  Consider the following example:
</p>

<pre class="example">
            GRID OF THE ARRAY                 ARRAY
+-----+-----+-----+-----+-----+-----+ +---+---+---+---+---+---+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+| |499|434|122|770|733|890|
||0|0|||0|1|||0|2|||0|3|||0|4|||0|5|| +---+---+---+---+---+---+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+| |660|160| 32|808|240|584|
+-----+-----+-----+-----+-----+-----+ +---+---+---+---+---+---+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+| |473|235|164|496|808|966|
||1|0|||1|1|||1|2|||1|3|||1|4|||1|5|| +---+---+---+---+---+---+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+| |156|205| 34|576|236|454|
+-----+-----+-----+-----+-----+-----+ +---+---+---+---+---+---+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|
||2|0|||2|1|||2|2|||2|3|||2|4|||2|5||
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|
+-----+-----+-----+-----+-----+-----+
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|
||3|0|||3|1|||3|2|||3|3|||3|4|||3|5||
|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|+-+-+|
+-----+-----+-----+-----+-----+-----+
</pre>

<p>
The array on the right is a 4 by 6 table of numbers.  It has 24 items arranged along two directions of length 4 and 6 respectively.  The address of 496 is [2,3].
</p>

<p>
The addresses of a list are integers: 0, 1, etc.  For convenience, in situations where an address of a list is expected, a solitary integer is treated as an integer.
</p>

<p>
The address of a single is the empty list Null.
</p>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> <code>allbools</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-6">

<p>
The operation allbools tests whether or not A is a nonempty array of boolean items.  It returns <code>true</code> if A is not empty and all the items of A are boolean atoms, <code>false</code> otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allbools</span> lool
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allbools</span> 1 0 1
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allbools</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allbools</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isboolean</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> <code>allchars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-7">

<p>
The operation allchars tests whether or not A is a nonempty array of character items.  It returns true if A is not empty and all the items of A are character atoms, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allchars</span> <span style="color: #00ff00;">'apple pie'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allchars</span> <span style="color: #ffaf00;">"today</span>
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allchars</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allchars</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">ischar</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> <code>allin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-8">

<p>
The operation allin tests whether or not all the items of array A are also items of array B.  The result is true if the test holds and false if it does not.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 5 7 <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">count</span> 10
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'ae'</span> <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #00ff00;">'where are you?'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'where'</span> <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #00ff00;">'hear'</span>
</pre>
</div>
<pre class="example">
o
</pre>

<p>
The items of A and B are compared for exact equality, including type.  The items being compared may be atoms or they may be any other array.
</p>
</div>

<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">and</span> ( A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">in</span> B ) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2"><span class="section-number-3">8.2</span> Equation</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">allin</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">list</span> A) <span style="color: #ffffff; font-weight: bold;">allin</span> (<span style="color: #ffffff; font-weight: bold;">list</span> B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> <code>allints</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-9">

<p>
The operation allints tests whether or not A is a nonempty array of integer items.  It returns true if A is not empty and all the items of A are 
integer atoms, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allints</span> lool
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allints</span> 1 0 25
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allints</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-9-1" class="outline-3">
<h3 id="sec-9-1"><span class="section-number-3">9.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allints</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> <code>allnumeric</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-10">

<p>
The operation allnumeric tests whether or not A is a nonempty array with all atoms of the same numeric type.   It returns true if A is not empty 
and all items are boolean atoms, or all are integer atoms or all are real atoms, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allnumeric</span> 3.5 -2.97
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allnumeric</span> l 45 3.78
</pre>
</div>
<pre class="example">
o
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allnumeric</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1"><span class="section-number-3">10.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-10-1">
<p>
allnumeric IS OPERATION A { allbools A or allints A or allreals A }
</p>
</div>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> <code>allreals</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span></span></h2>
<div class="outline-text-2" id="text-11">

<p>
The operation allreals tests whether or not A is a nonempty array of real items.  It returns true if A is not empty and all the items of A are real atoms, false otherwise.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allreals</span> 2 2.5 47.9
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allreals</span> 2.5 -7.8 27.3
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allreals</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-11-1" class="outline-3">
<h3 id="sec-11-1"><span class="section-number-3">11.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-11-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">allreals</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isreal</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> <code>and</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="bit">bit</span></span></h2>
<div class="outline-text-2" id="text-12">

<p>
The operation and applied to a boolean array A does the boolean product of its items.  If all items of A are true, the result is true; otherwise it is false.  In binary form and implements the and-connective of logic.
</p>

<p>
If A is a simple array and has a non-boolean item, the result is the logical fault ?L.  The operation extends to non-simple arrays by the multi pervasive mechanism.
</p>

<div class="org-src-container">

<pre class="src src-nial">l <span style="color: #ffffff; font-weight: bold;">and</span> l
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">and</span> llllloll
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">lloo <span style="color: #ffffff; font-weight: bold;">and</span> lolo
</pre>
</div>
<pre class="example">
looo
</pre>

<p>
And is a reductive operation in that it reduces an array of booleans to a single boolean.  If its argument is a pair of bitstrings or a list of bitstrings, and is applied to bits in corresponding positions of each item of the argument producing a bitstring of the same length as one of the items of its argument.
</p>
</div>

<div id="outline-container-sec-12-1" class="outline-3">
<h3 id="sec-12-1"><span class="section-number-3">12.1</span> Equations</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">and</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">and</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">and</span> A =f= <span style="color: #ffffff; font-weight: bold;">or</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">not</span> A
<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> <code>append</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="ctor">ctor</span></span></h2>
<div class="outline-text-2" id="text-13">

<p>
The operation append attaches B to the end of the list of items of A.  It returns a list of length one greater than the tally of A.
</p>

<div class="org-src-container">

<pre class="src src-nial">(2 3 4) <span style="color: #ffffff; font-weight: bold;">append</span> (5 6 7)
</pre>
</div>
<pre class="example">
+-+-+-+-----+
|2|3|4|5 6 7|
+-+-+-+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #00ff00;">''</span> <span style="color: #00ff00;">'Wow'</span>
</pre>
</div>
<pre class="example">
+---+
|Wow|
+---+
</pre>

<p>
The first example shows list (5 6 7) appended to list (2 3 4).  The second example shows that if an array is appended to an empty list, the result is the solitary of the second argument.  If append is applied to an array that is not a pair, a fault is returned.
</p>
</div>

<div id="outline-container-sec-13-1" class="outline-3">
<h3 id="sec-13-1"><span class="section-number-3">13.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-13-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { A <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-13-2" class="outline-3">
<h3 id="sec-13-2"><span class="section-number-3">13.2</span> Equations</h3>
<div class="outline-text-3" id="text-13-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">append</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> ( <span style="color: #ffffff; font-weight: bold;">list</span> A ) <span style="color: #ffffff; font-weight: bold;">append</span> B
<span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">append</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
A <span style="color: #ffffff; font-weight: bold;">append</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">append</span> B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> <code>appendfile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-14">

<p>
The operation appendfile writes a list of character arrays A to the end of the file named Filename, using one line of the file for each row in the items of A.  If the file does not exist, it is created by the operation.  The file must not be open.
</p>

<p>
Appendfile is similar to operation putfile except that putfile overwrites an existing file.  Getfile reads a file containing text records.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">putfile</span> <span style="color: #ffaf00;">"Mailing</span> [<span style="color: #00ff00;">'1'</span>,<span style="color: #00ff00;">'2'</span>,<span style="color: #00ff00;">'3'</span>];
<span style="color: #ffffff; font-weight: bold;">appendfile</span> <span style="color: #ffaf00;">"Mailing</span> [<span style="color: #00ff00;">'Mr. Jones'</span>,<span style="color: #00ff00;">'123 Main St'</span>,<span style="color: #00ff00;">'New York NY 12345'</span>];
<span style="color: #ffffff; font-weight: bold;">getfile</span> <span style="color: #ffaf00;">"Mailing</span>
</pre>
</div>
<pre class="example">
+-+-+-+---------+-----------+-----------------+
|1|2|3|Mr. Jones|123 Main St|New York NY 12345|
+-+-+-+---------+-----------+-----------------+
</pre>
</div>

<div id="outline-container-sec-14-1" class="outline-3">
<h3 id="sec-14-1"><span class="section-number-3">14.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-14-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">appendfile</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Filename A {
   Fnum <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> Filename <span style="color: #ffaf00;">"a</span> ;
   <span style="color: #ffff00;">ITERATE</span> (Fnum <span style="color: #ffffff; font-weight: bold;">writefile</span>) (<span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A) ;
   <span style="color: #ffffff; font-weight: bold;">close</span> Fnum ; }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> <code>apply</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="eval">eval</span></span></h2>
<div class="outline-text-2" id="text-15">

<p>
The operation apply carries out the application of the operation represented by the array Op to array A.  Op may be a phrase or string that names a predefined or user-defined operation or it may be the cast of an operation expression.
</p>

<p>
If the operation is represented by a phrase or string giving its name, the name is sought in the environment where apply is being used.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">apply</span> <span style="color: #ffaf00;">"second</span> (3 4 5)
</pre>
</div>
<pre class="example">
4
</pre>

<p>
The operation to be applied may also be represented by the parse tree or cast for the operation expression.  If the cast is a name, it is sought in the environment where the cast appears.  In the following example, !first is the cast of the operation first.
</p>

<div class="org-src-container">

<pre class="src src-nial">(!<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">apply</span> 3 4 5)
</pre>
</div>
<pre class="example">
3
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">apply</span> !(<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span>) (3 4 5)
</pre>
</div>
<pre class="example">
4
</pre>

<p>
As seen in the second example, an operation expression does not have to be named in order to be used with apply.  The entire first example is enclosed in parentheses to avoid conflict with the notation for executing a host command.
</p>
</div>
</div>

<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> <code>arccos</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></h2>
<div class="outline-text-2" id="text-16">

<p>
The operation arccos is the inverse of cos in the numeric domain.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">arccosine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">arccosine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">the angle B in radians such that cos B = A<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup></td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?arccos</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?arccos</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-16-1" class="outline-3">
<h3 id="sec-16-1"><span class="section-number-3">16.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-16-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arccos</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A ( <span style="color: #ffffff; font-weight: bold;">Pi</span> <span style="color: #ff00ff; font-weight: bold;">/</span> 2.0 <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">arcsin</span> A )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-16-2" class="outline-3">
<h3 id="sec-16-2"><span class="section-number-3">16.2</span> Equation</h3>
<div class="outline-text-3" id="text-16-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cos</span> <span style="color: #ffffff; font-weight: bold;">arccos</span> <span style="color: #ffffff; font-weight: bold;">cos</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cos</span> A (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> <code>arcsin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></h2>
<div class="outline-text-2" id="text-17">

<p>
The operation arcsin is the inverse of sin in the numeric domain.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">arcsine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">arcsine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">the angle B in radians such that sin B = A<sup><a id="fnr.1.100" name="fnr.1.100" class="footref" href="#fn.1">1</a></sup></td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?arcsin</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?arcsin</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arcsin</span> `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
?arcsin ?arcsin ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arcsin</span> l 1 .5
</pre>
</div>
<pre class="example">
1.5708 1.5708 0.523599
</pre>
</div>

<div id="outline-container-sec-17-1" class="outline-3">
<h3 id="sec-17-1"><span class="section-number-3">17.1</span> Equation</h3>
<div class="outline-text-3" id="text-17-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sin</span> <span style="color: #ffffff; font-weight: bold;">arcsin</span> <span style="color: #ffffff; font-weight: bold;">sin</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sin</span> A   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> <code>arctan</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="math">math</span>&#xa0;<span class="trig">trig</span></span></h2>
<div class="outline-text-2" id="text-18">

<p>
The operation arctan is the inverse of tan in the numeric domain.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">arctangent of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">arctangent of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">angle B in radians where tan B = A</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?arctan</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?arctan</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arctan</span> l -2 0.35
</pre>
</div>
<pre class="example">
0.785398 -1.10715 0.336675
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arctan</span> `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
?arctan ?arctan ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arctan</span> 2. l 1 .5
</pre>
</div>
<pre class="example">
1.10715 0.785398 0.785398 0.463648
</pre>
</div>

<div id="outline-container-sec-18-1" class="outline-3">
<h3 id="sec-18-1"><span class="section-number-3">18.1</span> Equation</h3>
<div class="outline-text-3" id="text-18-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tan</span> <span style="color: #ffffff; font-weight: bold;">arctan</span> <span style="color: #ffffff; font-weight: bold;">tan</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tan</span> A   <span style="color: #66f;">% within roundoff error;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> argument&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-19">

<p>
An argument is an array value supplied to an operation. All operations in Nial take a single array as the argument, but binary operations expect that argument to be a pair. When an operation is used in infix syntax, then the two array values on the left and right are combined into a pair to be supplied as the argument to the operation.
</p>

<p>
The argument to an operation-form is treated specially. If the operation-form has only one formal parameter then the argument is assigned to the parameter. If it has two or more formal parameters, then the argument is checked to see if it has the same number of items as there are parameters. If so, the items are assigned to the parameters. If not, the result is the fault ?op<sub>parameter</sub>.
</p>
</div>
</div>

<div id="outline-container-sec-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> array&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-20">

<p>
The data objects of Nial are nested rectangular arrays. Atomic data objects such as numbers and characters are included within this description by virtue of an atom being considered as a self-containing array object with no dimensions.
</p>

<p>
<b>Atomic Arrays</b>
</p>

<p>
There are six types of atoms in Nial. They are boolean, integer, real, character, phrase and fault.  The first three are numeric types and are used for arithmetic operations. The last three are literal types and are used for text and symbol manipulation. All six types of atoms are used in comparisons.
</p>

<p>
<b>Rectangularity Structure</b>
</p>

<p>
An array is a collection of data objects having its items held at locations in a rectangular structure. The items are viewed as being at locations that are positioned relative to a set of directions at right angles to each other.  The items may be arranged along zero, one, two or more directions. For example, the following array is a 4 by 6 table of numbers. It has 24 items arranged along two directions of length 4 and 6 respectively.
</p>
<pre class="example">
+---+---+---+---+---+---+
|499|434|122|770|733|890|
+---+---+---+---+---+---+
|660| 32|808| 24|  5|473|
+---+---+---+---+---+---+
|499|434|122|770|733|890|
+---+---+---+---+---+---+
|660| 32|808| 24|  5|473|
+---+---+---+---+---+---+
</pre>

<p>
The items of an array are themselves arrays. Thus, an array can have an arbitrarily deep nesting structure.
</p>
</div>
</div>

<div id="outline-container-sec-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> <code>assign</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="eval">eval</span></span></h2>
<div class="outline-text-2" id="text-21">

<p>
The operation assign assigns the value of A to the variable named by Nm.  Nm may be a phrase or string (e.g.  "X or 'X'), in which case the named variable is sought in the current environment; or it may be the cast of a name (e.g.  !X), in which case it is sought in the environment in which it was cast.  If the variable is found, its value is replaced by the array A.  Otherwise, a variable with that name is created in the global environment and given A as its value.
</p>

<p>
Any phrase may be used as a variable name with the operation assign.  Thus, it is possible to assign a value to names which are invalid identifiers.  The associated value can be retrieved using the operation value.  The result of the operation is A.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">assign</span> <span style="color: #ffaf00;">"X</span> (2 3 4)
</pre>
</div>
<pre class="example">
2 3 4
</pre>


<div class="org-src-container">

<pre class="src src-nial">(!Var <span style="color: #ffffff; font-weight: bold;">assign</span> 2 3 4)
</pre>
</div>
<pre class="example">
2 3 4
</pre>


<p>
In the first example, the variable X is assigned the list 2 3 4.  If this is done in an environment where X is a local variable, the local variable is updated.  If X does not exist, it is created in the global environment.
</p>

<p>
In the second example, a variable Var must exist in the environment where the cast is done.  The cast can be formed in a more global environment and passed into an operation as a parameter (This technique is called by-variable parameter passing).
</p>
</div>
</div>

<div id="outline-container-sec-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> <i>assign expression</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-22">

<pre class="example">
assign-expression ::=
      { variable }+ := expression
      | indexed-variable := expression
</pre>

<p>
An assign-expression assigns an array value to one or more variables at the time of evaluation of the assign expression.  The semantics of an assign expression is interpreted in two stages: when the expression is analyzed (parsed) and when it is executed.
</p>

<p>
During the parse of the assign-expression appearing in a block, each name on the variable list is sought in the local environment.  If the name exists in the local environment, the assignment affects the local association.  If a name does not exist in the local environment and no reference has been made to a nonlocal variable with the same name, a local variable is created in the block.  An assign-expression parsed in the global environment creates a global variable if a variable with that name does not already exist.
</p>

<p>
When an assign expression is executed, the expression on the right of the assignment symbol ( := ) is evaluated.  If the variable list on the left has only one name, the value of the expression is assigned to that variable.  That is, the value is associated with that name.
</p>

<p>
If the variable list has several names, the items of the value are assigned to the variables in the order in which they appear.  If the number of items does not match the number of variables, the fault ?assignment is returned as the value of the assign-expression.  Otherwise, the value of the assign-expression is the value of the expression on the right.
</p>

<p>
When an indexed-variable is used on the left in an assign-expression, the parts of the array associated with the variable at the locations specified by the index are replaced by the values of the expression on the right.
</p>

<p>
If the index expression for an indexed-variable assignment specifies a number of locations (at-all or slice indexing), there are two cases: if the value on the right is a single, the item of the single is placed in each location; otherwise, the value on the right must have the same number of items as the index expression indicates and the corresponding locations are updated with the items of the array value.
</p>
</div>
</div>

<div id="outline-container-sec-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> <code>atlas</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-23">

<pre class="example">
atlas ::= [ operation-expression { , operation-expression } ]
</pre>

<p>
An atlas is an operation made up of a list of component operations.  The result of applying an atlas is a list of the same length as the atlas.  Each operation in the atlas is applied in turn to the argument resulting in an array value that becomes the item of the result list in the corresponding position.  An atlas is used by the transformers <i>=FORK=</i>, <i>=INNER=</i> and <i>=TEAM=</i>.
</p>
</div>
</div>

<div id="outline-container-sec-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> <code>atomic</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="test">test</span>&#xa0;<span class="struct">struct</span></span></h2>
<div class="outline-text-2" id="text-24">

<p>
The operation atomic tests whether or not its argument is an atom.  It returns true if it is and false if it is not.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> 3.5
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> <span style="color: #ffaf00;">"hello</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> <span style="color: #00ff00;">'hello'</span>
</pre>
</div>
<pre class="example">
o
</pre>


<p>
The examples illustrate that a number and a phrase are atoms and that a string is not an atom.
</p>

<p>
An atom is a primitive concept in array theory and Nial.  Atoms are distinguished from other arrays by the property that they are self nesting.  The definition of atomic is based on this property.
</p>
</div>

<div id="outline-container-sec-24-1" class="outline-3">
<h3 id="sec-24-1"><span class="section-number-3">24.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-24-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-24-2" class="outline-3">
<h3 id="sec-24-2"><span class="section-number-3">24.2</span> Equations</h3>
<div class="outline-text-3" id="text-24-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> A &lt;==&gt; <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ffffff; font-weight: bold;">equal</span> A
<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">atomic</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">simple</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> <code>axes</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="metric">metric</span></span></h2>
<div class="outline-text-2" id="text-25">

<p>
The operation axes generates a list of axis numbers for the array A counting from zero.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">axes</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4 5
</pre>
</div>
<pre class="example">
0 1 2
</pre>
</div>

<div id="outline-container-sec-25-1" class="outline-3">
<h3 id="sec-25-1"><span class="section-number-3">25.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-25-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">axes</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-25-2" class="outline-3">
<h3 id="sec-25-2"><span class="section-number-3">25.2</span> Equation</h3>
<div class="outline-text-3" id="text-25-2">
<div class="org-src-container">

<pre class="src src-nial"></pre>
</div>
<p>
tally axes A = tally shape A
</p>
</div>
</div>
</div>

<div id="outline-container-sec-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> <code>binary</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prop">prop</span></span></h2>
<div class="outline-text-2" id="text-26">

<p>
An operation is said to binary if it must have exactly two items in its argument. Many of the built-in operations of Nial are binary. They can be used in both an infix and prefix manner.  If a binary operation f is used in infix syntax then the arguments on each side of f are treated as the two items of its argument.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">reshape</span> 5
</pre>
</div>
<pre class="example">
5 5 5
</pre>

<p>
In prefix usage, f can precede a single array with two items, or an explicit pair formed with strand notation or bracket-comma notation.
</p>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 3 5;
<span style="color: #ffffff; font-weight: bold;">reshape</span> X
</pre>
</div>
<pre class="example">
5 5 5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reshape</span> 3 5
</pre>
</div>
<pre class="example">
5 5 5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reshape</span> [3,5]
</pre>
</div>
<pre class="example">
5 5 5
</pre>
</div>
</div>

<div id="outline-container-sec-27" class="outline-2">
<h2 id="sec-27"><span class="section-number-2">27</span> binary pervasive&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></h2>
<div class="outline-text-2" id="text-27">

<p>
Each operation f in this class maps a pair of atoms to an atom.
</p>

<p>
A binary pervasive operation maps two arrays having identical structure to one with the same structure, mapping each pair of corresponding atoms by the function's behaviour on pairs of atoms.
</p>

<p>
All of the binary operations of arithmetic and logic are binary pervasive.
</p>

<p>
If a binary pervasive operation is applied to a pair of arrays that do not have the same shape, the effect is to build a conformable pair by replicating an atom or solitary item of the pair to the shape of the other item.  If both items are of unequal shape and if both items are made up of more than one item, the fault ?conform is returned.  The replication of an argument with one item provides binary pervasive operations with a scalar extension capability.  For example,
</p>

<div class="org-src-container">

<pre class="src src-nial">3 4 5 6 <span style="color: #ff00ff; font-weight: bold;">-</span> 5 <span style="color: #ff00ff; font-weight: bold;">=</span> (3 4 5 6 <span style="color: #ff00ff; font-weight: bold;">-</span> 5 5 5 5)
</pre>
</div>
<pre class="example">
l
</pre>

<p>
If a binary pervasive operation is applied to an array that is not a pair, a fault is returned.
</p>

<p>
The following table lists the binary pervasive operations.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operation</th>
<th scope="col" class="left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">divide</td>
<td class="left">division of numbers</td>
</tr>

<tr>
<td class="left">gt</td>
<td class="left">greater than comparison</td>
</tr>

<tr>
<td class="left">gte</td>
<td class="left">greater than or equal comparison</td>
</tr>

<tr>
<td class="left">lt</td>
<td class="left">less than comparison</td>
</tr>

<tr>
<td class="left">lte</td>
<td class="left">less than or equal comparison</td>
</tr>

<tr>
<td class="left">match</td>
<td class="left">equality of atoms without type coercion</td>
</tr>

<tr>
<td class="left">mate</td>
<td class="left">equality of atoms with type coercion</td>
</tr>

<tr>
<td class="left">minus</td>
<td class="left">subtraction of numbers</td>
</tr>

<tr>
<td class="left">mod</td>
<td class="left">remainder on division of integers</td>
</tr>

<tr>
<td class="left">plus</td>
<td class="left">addition of numbers</td>
</tr>

<tr>
<td class="left">quotient</td>
<td class="left">quotient on division of integers</td>
</tr>

<tr>
<td class="left">times</td>
<td class="left">multiplication of numbers divide division of numbers</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-27-1" class="outline-3">
<h3 id="sec-27-1"><span class="section-number-3">27.1</span> Equations</h3>
<div class="outline-text-3" id="text-27-1">
<div class="org-src-container">

<pre class="src src-nial">A f B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffff00;">EACHBOTH</span> f B
A f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> f (A <span style="color: #ffffff; font-weight: bold;">pack</span> B)
<span style="color: #ffffff; font-weight: bold;">shape</span> (A f B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-28" class="outline-2">
<h2 id="sec-28"><span class="section-number-2">28</span> <code>blend</code></h2>
<div class="outline-text-2" id="text-28">

<p>
The operation <a href="#sec-28">28</a> combines the top two levels of an array B into a single level blending the axes of the second level of B into the combined level according to the axis numbers given in A.  The items of B must be of the same shape.
</p>

<p>
If the array B is equivalent to A <a href="#sec-304">304</a> C for some array C, the result of A <a href="#sec-28">28</a> B is C.
</p>

<p>
The <a href="#sec-321">321</a> of A is the <a href="#sec-353">353</a> of an item of B.  The items of A indicate where the axes of the items of B are placed in the shape of the result.
</p>

<div class="org-src-container">

<pre class="src src-nial">C <span style="color: #ff00ff;">:=</span> (2 4 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 24) ;
B <span style="color: #ff00ff;">:=</span> 2 0 <span style="color: #ffffff; font-weight: bold;">split</span> C
</pre>
</div>
<pre class="example">
+----+----+----+-----+
|1 13|4 16|7 19|10 22|
|2 14|5 17|8 20|11 23|
|3 15|6 18|9 21|12 24|
+----+----+----+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">C <span style="color: #ff00ff;">:=</span> 2 0 <span style="color: #ffffff; font-weight: bold;">blend</span> B
</pre>
</div>
<pre class="example">
 1  2  3   13 14 15
 4  5  6   16 17 18
 7  8  9   19 20 21
10 11 12   22 23 24
</pre>

<p>
In the example, B is a list of four tables of shape 3 2 created by a 2 0 split.  The result of 2 0 blend B is the array of valence 3 that is the second argument to split.
</p>
</div>

<div id="outline-container-sec-28-1" class="outline-3">
<h3 id="sec-28-1"><span class="section-number-3">28.1</span> Equations</h3>
<div class="outline-text-3" id="text-28-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">SORT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #ffffff; font-weight: bold;">list</span> I <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">blend</span> (I <span style="color: #ffffff; font-weight: bold;">split</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; (<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">axes</span> <span style="color: #ffffff; font-weight: bold;">first</span> A) <span style="color: #ffffff; font-weight: bold;">blend</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">mix</span> A
A <span style="color: #ffffff; font-weight: bold;">blend</span> B =f= [<span style="color: #ffffff; font-weight: bold;">Null</span>,A] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffffff; font-weight: bold;">first</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-29" class="outline-2">
<h2 id="sec-29"><span class="section-number-2">29</span> <i>block</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-29">

<pre class="example">
block ::=
   { [ LOCAL { identifier-sequence }+ ; ]
[ NONLOCAL { identifier-sequence }+ ; ]
[ definition-sequence ; ]
  expression-sequence }
</pre>

<p>
A block is a scope-creating mechanism that permits an expression-sequence to be created so that it has local definitions and variables which are visible only inside the block.  A block may appear as a primary-expression or as the body of an operation-form.
</p>

<p>
A local environment is a collection of associations that are known within a limited section of program text.  These limited sections are formed by blocks, operation-forms and transformer-forms.  A name that has a local association in one of these forms is said to have local scope.
</p>

<p>
If the definition appears within a block, the association is made in the local environment.  Otherwise, the association is made in the global environment and assigns a role to the name as representing that kind of expression.
</p>

<p>
If a block is used as a primary-expression, the local environment created by a block is determined by the block itself.  If it is the body of an operation-form, the local environment includes the formal parameter names of the operation-form as variables.
</p>

<p>
Local and Nonlocal Declaration
</p>

<p>
The identifiers included in the local and nonlocal declarations are declared to be variables.  Both forms of declarations are optional, but if both are given, local declarations must be made first.  If the block is the body of a globally defined operation-form or expression, a nonlocal declaration effectively declares its variables as global ones.
</p>

<p>
A block delimits a local environment.  It allows new uses of names which do not interfere with uses of those names outside the block.  For example, within a block, a predefined operation name can be redefined and used for a different purpose.  Only the reserved words of Q'Nial cannot be reused in this fashion.
</p>

<p>
Definitions that appear within the block have local scope.  That is, the definitions can be referenced only in the body of the block.  Variables assigned within the block may or may not have local scope, depending on the appearance of a local and/or a nonlocal declaration.  If there is no declaration, all assigned variables have local scope.  Declaring some variables as local does not change the effect on undeclared variables that are used on the left of assignment.  They are automatically localized.
</p>

<p>
If a nonlocal declaration is used, an assigned name that is on the nonlocal list is sought in surrounding scopes.  If the name is not found, a variable is created in the global environment.
</p>
</div>
</div>

<div id="outline-container-sec-30" class="outline-2">
<h2 id="sec-30"><span class="section-number-2">30</span> <i>bracket-comma notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-30">

<p>
A list may be constructed directly by using bracket-comma notation.  In this notation, the items of a list are separated by commas and the list is bounded by square brackets.  If an item is omitted before or after a comma, then the fault value ?noexpr is used for the value of the missing item. The notation denotes the Null if their are no items, and a solitary if there is only one item.
</p>

<div class="org-src-container">

<pre class="src src-nial">[2,3 4,5]
</pre>
</div>
<pre class="example">
+-+---+-+
|2|3 4|5|
+-+---+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial">[,4 5]
</pre>
</div>
<pre class="example">
+-------+---+
|?noexpr|4 5|
+-------+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">[] <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">[<span style="color: #00ff00;">'hello world'</span>]
</pre>
</div>
<pre class="example">
+-----------+
|hello world|
+-----------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">[3,[4,5,6],7]
</pre>
</div>
<pre class="example">
+-+-----+-+
|3|4 5 6|7|
+-+-----+-+
</pre>
</div>
</div>

<div id="outline-container-sec-31" class="outline-2">
<h2 id="sec-31"><span class="section-number-2">31</span> <code>break</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></h2>
<div class="outline-text-2" id="text-31">

<p>
The execution of Break causes the interpreter to interrupt normal execution in an expression sequence and to display the current callstack. It then prompts for input with the prompt &#x2013;&gt; followed by the default command in brackets.  The visible environment is that of the expression in which the break occurs.  Thus, it is possible to examine the values of local variables in break mode.
</p>

<p>
At a break you can type any expression to inspect the value of a variable or to see a portion of its value. The operation see can also be used to view any of the definitions in the environment.
</p>

<p>
The debugging capability allows one to step forward in expression sequences using commands step, stepin, next or toend to control whether you step into or over other definitions or to the end of a loop or a definition. The command resume ends the break and normal execution is restarted.
</p>

<p>
In console versions of Q'Nial, break mode can also be entered by typing &lt;Ctrl B&gt; in response to the prompt for a read or readscreen operation or Readchar expression when in windows mode.  In this case, after resume or step is entered, Q'Nial returns to the read or readscreen operation and awaits the user input.  Break mode cannot be entered by typing &lt;Ctrl B&gt; in editwindow or when setinterrupts has been used to inhibit interrupts.
</p>

<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> A { <span style="color: #ffffff; font-weight: bold;">Break</span>; A }
foo 3
</pre>
</div>
<pre class="example">
-------------------------------------------------------------
   Break debug loop: enter debug commands, expressions or
     type: resume    to exit debug loop
     &lt;Return&gt; executes the indicated debug command
   current call stack :
foo
-------------------------------------------------------------
?.. A
--&gt;[stepv]
</pre>

<p>
In the example, the operation foo has a Break which is executed when foo is applied to 3. If Return is pressed at the prompt the expression A is evaluated and 3 is displayed followed by another prompt.
</p>
</div>
</div>

<div id="outline-container-sec-32" class="outline-2">
<h2 id="sec-32"><span class="section-number-2">32</span> <code>breakin</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></h2>
<div class="outline-text-2" id="text-32">

<p>
The operation breakin installs a break point prior to the first executable expression in a definition named by the string or phrase Defname.  The named definition must be an expression or an operation form.  The effect is that when the definition is executed a break interrupt occurs prior to the execution of the first expression in the expression sequence in the body of the definition.
</p>

<p>
The optional argument Mode is provided to set the internal flag explicitly.  If it is omitted, the internal flag value is toggled.  All breakin flags are initially false.  The value of the breakin flag is retained if the definition is replaced by a loaddefs so that editing a definition and reloading it does not change its breakin status.  However, if definitions are reloaded using a restart then the breakin status is set to false.
</p>

<p>
The operation returns the previous setting.  If the result of breakin is assigned to a variable, the previous setting can be restored later.  The names of definitions that have breakin set can be viewed by the expression Breaklist.
</p>
<pre class="example">
library labeltab
</pre>

<pre class="example">
see labeltable
</pre>

<div class="org-src-container">

<pre class="src src-nial">labeltable <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Corner Rowlabel Columnlabel Table {
   <span style="color: #66f;">% Combine the corner label with the column labels for first line;</span>
  Firstrow <span style="color: #ff00ff;">:=</span> Corner <span style="color: #ffffff; font-weight: bold;">hitch</span> Columnlabel;
   <span style="color: #66f;">% Hitch the row labels to the rows of the table;</span>
   Labeledrows <span style="color: #ff00ff;">:=</span> Rowlabel <span style="color: #ffff00;">EACHBOTH</span> <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">rows</span> Table;
   <span style="color: #66f;">% Hitch the first row of labels to the labeled rows and mix them;</span>
   <span style="color: #ffffff; font-weight: bold;">mix</span> (Firstrow <span style="color: #ffffff; font-weight: bold;">hitch</span> Labeledrows) }

X <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">count</span> 3
</pre>
</div>
<pre class="example">
1 2 3
</pre>

<div class="org-src-container">

<pre class="src src-nial">labeltable <span style="color: #ffaf00;">"TIMES</span> X X (X <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">times</span> X)
</pre>
</div>
<pre class="example">
TIMES 1 2 3
    1 1 2 3
    2 2 4 6
    3 3 6 9
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">breakin</span> <span style="color: #ffaf00;">"labeltable</span>
</pre>
</div>
<pre class="example">
o
</pre>



<div class="org-src-container">

<pre class="src src-nial">labeltable <span style="color: #ffaf00;">"TIMES</span> X X (X <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">times</span> X)
</pre>
</div>
<pre class="example">
-------------------------------------------------------------
    Break debug loop: enter debug commands, expressions or
     type: resume    to exit debug loop
     &lt;Return&gt; executes the indicated debug command
    current call stack :
labeltable
-------------------------------------------------------------
?.. Firstrow := Corner hitch Columnlabel
--&gt;[stepv] TIMES 1 2 3
?..   % Hitch the row labels to the rows of the table
--&gt;[stepv] resume
TIMES 1 2 3
    1 1 2 3
    2 2 4 6
    3 3 6 9
</pre>

<p>
To clear all breaks use:
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">breakin</span> <span style="color: #ffffff; font-weight: bold;">Breaklist</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-33" class="outline-2">
<h2 id="sec-33"><span class="section-number-2">33</span> <code>breaklist</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span>&#xa0;<span class="debug">debug</span></span></h2>
<div class="outline-text-2" id="text-33">

<p>
The execution of Breaklist prints out a list of the definition names for which the breakin flag has been set.
</p>

<p>
Its main use is to assist in clearing the breaks as debugging proceeds.
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Breaklist</span>
</pre>
</div>
<pre class="example">
labeltable
</pre>

<p>
To clear all breaks use:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">breakin</span> <span style="color: #ffffff; font-weight: bold;">Breaklist</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-34" class="outline-2">
<h2 id="sec-34"><span class="section-number-2">34</span> <code>BYCOLS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></h2>
<div class="outline-text-2" id="text-34">

<p>
The transformer <i>=BYCOLS=</i> applies an operation f to the columns of a table A, where f is an operation that maps lists to lists.
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%5.3f'</span>;
<span style="color: #ffff00;">BYCOLS</span> (<span style="color: #ffff00;">SORT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span>)(5 6 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">random</span> 30)
</pre>
</div>
<pre class="example">
0.726 0.009 0.210 0.385 0.123 0.119
0.851 0.448 0.384 0.476 0.193 0.384
0.880 0.449 0.536 0.603 0.455 0.498
0.882 0.729 0.631 0.819 0.639 0.521
0.911 0.893 0.810 0.961 0.940 0.672
</pre>

<p>
The example generates a random table and then sorts each column.
</p>
</div>

<div id="outline-container-sec-34-1" class="outline-3">
<h3 id="sec-34-1"><span class="section-number-3">34.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-34-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">BYCOLS</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">transpose</span> (1 <span style="color: #ffff00;">RANK</span> f <span style="color: #ffffff; font-weight: bold;">transpose</span> A) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-34-2" class="outline-3">
<h3 id="sec-34-2"><span class="section-number-3">34.2</span> Equation</h3>
<div class="outline-text-3" id="text-34-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">BYCOLS</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-35" class="outline-2">
<h2 id="sec-35"><span class="section-number-2">35</span> <code>bye</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ex">ex</span>&#xa0;<span class="sys">sys</span></span></h2>
<div class="outline-text-2" id="text-35">

<p>
The expression Bye is used to terminate a session of Q'Nial and to return to the host environment.  The current workspace is not saved.
</p>
</div>
</div>

<div id="outline-container-sec-36" class="outline-2">
<h2 id="sec-36"><span class="section-number-2">36</span> <code>BYKEY</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></h2>
<div class="outline-text-2" id="text-36">

<p>
The transformer <i>=BYKEY=</i> applies an operation f to lists gathered from A, where each list is made up of items of A that have the same value in the corresponding position in K.  The result is a list with as many items as there are unique items in K.
</p>

<div class="org-src-container">

<pre class="src src-nial">Str <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'a stitch in time saves nine'</span>;
</pre>
</div>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cull</span> Str
</pre>
</div>
<pre class="example">
a stichnmev
</pre>


<div class="org-src-container">

<pre class="src src-nial">Str <span style="color: #ffff00;">BYKEY</span> <span style="color: #ffffff; font-weight: bold;">tally</span> Str
</pre>
</div>
<pre class="example">
2 5 3 2 4 1 1 3 1 3 1
</pre>


<div class="org-src-container">

<pre class="src src-nial">Keys <span style="color: #ff00ff;">:=</span> 3 5 3 7 2 5 4 2 1 3 4;
Data <span style="color: #ff00ff;">:=</span> 23.1 14.2 13.5 18.9 22. 98. 3.5 28.7 19.3 16.5 43.2;
Keys <span style="color: #ffff00;">BYKEY</span> <span style="color: #ffffff; font-weight: bold;">sum</span> Data
</pre>
</div>
<pre class="example">
53.1 112.2 18.9 50.7 46.7 19.3
</pre>



<div class="org-src-container">

<pre class="src src-nial">average <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">OP</span> A { <span style="color: #ffffff; font-weight: bold;">sum</span> A <span style="color: #ff00ff; font-weight: bold;">/</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A }
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial">Keys <span style="color: #ffff00;">BYKEY</span> average Data
</pre>
</div>
<pre class="example">
17.7 56.1 18.9 25.35 23.35 19.3
</pre>


<p>
In the first example <i>=BYKEY=</i> tally is used to count the frequency of the letters in the string Str, giving the counts in the order of cull Str. In the remaining examples, the values in Data corresponding to equal items in Keys are added and averaged in the two uses of BYKEY.
</p>
</div>

<div id="outline-container-sec-36-1" class="outline-3">
<h3 id="sec-36-1"><span class="section-number-3">36.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-36-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">BYKEY</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> K A {
   Keys <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">cull</span> A;
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">simple</span> Keys <span style="color: #00ffff;">THEN</span>
      Patterns <span style="color: #ff00ff;">:=</span> Keys <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">match</span> A;
   <span style="color: #00ffff;">ELSE</span>
      Patterns <span style="color: #ff00ff;">:=</span> Keys <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ff00ff; font-weight: bold;">=</span> A;
   <span style="color: #00ffff;">ENDIF</span>;
   <span style="color: #ffff00;">EACH</span> f (Patterns <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">sublist</span> B) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-36-2" class="outline-3">
<h3 id="sec-36-2"><span class="section-number-3">36.2</span> Equations</h3>
<div class="outline-text-3" id="text-36-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffff00;">BYKEY</span> f K A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">cull</span> K
<span style="color: #ffffff; font-weight: bold;">valence</span> <span style="color: #ffff00;">BYKEY</span> f K A <span style="color: #ff00ff; font-weight: bold;">=</span> 1
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-37" class="outline-2">
<h2 id="sec-37"><span class="section-number-2">37</span> <code>BYROWS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span>&#xa0;<span class="ap">ap</span></span></h2>
<div class="outline-text-2" id="text-37">

<p>
The transformer <i>=BYROWS=</i> applies an operation f to the rows of a table A, where f is an operation that maps lists to lists.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">BYROWS</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> (5 6 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 30)
</pre>
</div>
<pre class="example">
 6  5  4  3  2  1
12 11 10  9  8  7
18 17 16 15 14 13
24 23 22 21 20 19
30 29 28 27 26 25
</pre>

<p>
The example reverses the rows of the generated table.
</p>
</div>

<div id="outline-container-sec-37-1" class="outline-3">
<h3 id="sec-37-1"><span class="section-number-3">37.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-37-1">
<div class="org-src-container">

<pre class="src src-nial">:     <span style="color: #ffff00;">BYROWS</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { 1 <span style="color: #ffff00;">RANK</span> f A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-37-2" class="outline-3">
<h3 id="sec-37-2"><span class="section-number-3">37.2</span> Equation</h3>
<div class="outline-text-3" id="text-37-2">
<div class="org-src-container">

<pre class="src src-nial"></pre>
</div>
<p>
shape f A = shape A ==&gt; shape BYROWS f A = shape A
</p>
</div>
</div>
</div>

<div id="outline-container-sec-38" class="outline-2">
<h2 id="sec-38"><span class="section-number-2">38</span> by-variable&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-38">

<p>
One use of the operation assign is to mimic a by-variable form of parameter passing in place of Nial's by-value form.  The result depends on what kind of name is provided, a phrase or a cast.  If the name is provided as a phrase, the variable that is selected is determined by assign when it does the assignment by looking first in the local environment and then in the surrounding ones.  If the name is provided as a cast, the variable selected is the one that exists at the point where the cast is formed.  Thus, by-variable parameter passing is achieved by using the cast of the variable as an argument in the call.  In the body of the operation the formal parameter is assigned using assign and evaluated using value.
</p>

<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> A Nm {
  B <span style="color: #ff00ff;">:=</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">value</span> Nm;
  Nm <span style="color: #ffffff; font-weight: bold;">assign</span> (B <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5); }

X <span style="color: #ff00ff;">:=</span> 100;
foo 1000 <span style="color: #ffaf00;">"X</span>;
X
</pre>
</div>
<pre class="example">
1115
</pre>
</div>
</div>

<div id="outline-container-sec-39" class="outline-2">
<h2 id="sec-39"><span class="section-number-2">39</span> <code>callc</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></h2>
<div class="outline-text-2" id="text-39">

<p>
The operation callc provides an interface to a C-coded operation Op and executes it with arguments A.  The operation is one of several in a package called P.
</p>

<p>
Q'Nial Version 6.2 for Unix provides the CallC capability.  This version of Q'Nial can be extended by adding packages and operations written in C and linked into the interpreter.
</p>
</div>
</div>

<div id="outline-container-sec-40" class="outline-2">
<h2 id="sec-40"><span class="section-number-2">40</span> <code>calldllfun</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></h2>
<div class="outline-text-2" id="text-40">

<p>
A Prototype DLL calling interface has been added to the Windows versions of Q'Nial (Console, GUI and DLL version).  This ability allows NIAL code to call external routines in DLL libraries.  These libraries can be user written, part of the Operating System, or 3rd party DLLs.
</p>

<p>
The DLL interface routines manage an internal table that keeps track of the currently installed DLLs and their argument types and result type.  This table also tracks if the actual library has been loaded (by a call to calldllfun).  The table is preserved as part of the workspace, and once DLL functions have been registered in a workspace,  they are still available if the workspace is saved and subsequently loaded.  The CallDLL facility assures that the DLL files are loaded and unloaded appropriately.
</p>

<p>
Every time a workspace is saved all DLL libraries are unloaded and the internal table is adjusted to reflect that.  When a workspace is loaded, none of the DLL libraries will be loaded until a specific call to calldllfun brings in the DLL.  This process assures that resources are not wasted on registered DLL calls that are never used.
</p>

<p>
The registerdllfun routine must always be called first to enter DLL function into the internal mapping table.  This table keeps track of the name and DLL file for the routine and all of the argument types and function results.  The DLL file is not loaded until the routine is called with the calldllfun routine.  So errors involving paths to the DLL file or other related problems are not reported until the first call to calldllfun.
</p>

<p>
The operation calldllfun provides an interface to an external routine implemented as a DLL for 32-bit Windows. The name Nm is the name associated with the routine when it was registered using registerdllfun. The use of the name with appropriate arguments causes the DLL routine to be executed and its result (if any) returned as a Nial array.
</p>

<p>
The arguments Arg0 &#x2026; ArgN must agree in number and be compatible in type with the declarations made while registering the routine.
</p>

<p>
The details of argument passing and some examples are included in the entry for registerdllfun.
</p>
</div>
</div>

<div id="outline-container-sec-41" class="outline-2">
<h2 id="sec-41"><span class="section-number-2">41</span> <code>callstack</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="sys">sys</span></span></h2>
<div class="outline-text-2" id="text-41">

<p>
The expression <i>=Callstack=</i> displays the sequence of active definition calls at the point it is invoked.  It is usually used in conjunction with <i>=Break=</i>.  <i>=Callstack=</i> can be used to see the execution path by which the computation reached the current state while computation is suspended during a break.
</p>
</div>
</div>

<div id="outline-container-sec-42" class="outline-2">
<h2 id="sec-42"><span class="section-number-2">42</span> canonical&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-42">

<p>
There is a canonical way of displaying program text in Nial. This is done automatically by the routines descan and deparse used by see. The canonical form sets the case of all identifiers used in Nial program text according to their role in order to assist visual parsing of Nial text. The following table summarizes the rules:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Role</th>
<th scope="col" class="left">Case rule</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Variable</td>
<td class="left">first letter upper case, the rest lower case</td>
</tr>

<tr>
<td class="left">Expression</td>
<td class="left">first letter upper case, the rest lower case</td>
</tr>

<tr>
<td class="left">Operation</td>
<td class="left">all lower case</td>
</tr>

<tr>
<td class="left">Transformer</td>
<td class="left">all upper case</td>
</tr>

<tr>
<td class="left">Reserved Word</td>
<td class="left">all upper case</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-42-1" class="outline-3">
<h3 id="sec-42-1"><span class="section-number-3">42.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-42-1">
<div class="org-src-container">

<pre class="src src-nial">canonical <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-43" class="outline-2">
<h2 id="sec-43"><span class="section-number-2">43</span> <code>cart</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="op">op</span>&#xa0;<span class="ctor">ctor</span></span></h2>
<div class="outline-text-2" id="text-43">

<p>
The operation cart corresponds to the cartesian product of set theory.  Its purpose is to form all possible combinations of the items of its argument and return them in a structured result having as many axes as the sum of the number of axes of the items of argument.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 4 <span style="color: #ffffff; font-weight: bold;">cart</span> 5 6
</pre>
</div>
<pre class="example">
+---+---+
|2 5|2 6|
+---+---+
|3 5|3 6|
+---+---+
|4 5|4 6|
+---+---+
</pre>

<p>
In the example above, the cart of a triple with a pair yields a table of shape 3 2 of pairs.
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cart</span> [<span style="color: #00ff00;">'abc'</span>, 4 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 8]
</pre>
</div>
<pre class="example">
+---+---+  +---+---+  +---+---+
|a 1|a 2|  |b 1|b 2|  |c 1|c 2|
+---+---+  +---+---+  +---+---+
|a 3|a 4|  |b 3|b 4|  |c 3|c 4|
+---+---+  +---+---+  +---+---+
|a 5|a 6|  |b 5|b 6|  |c 5|c 6|
+---+---+  +---+---+  +---+---+
|a 7|a 8|  |b 7|b 8|  |c 7|c 8|
+---+---+  +---+---+  +---+---+
</pre>

<p>
In the above example, the shape of the result is 3 4 2, getting an axis of length 3 from the first item and axes of length 4 and 2 from the second.
</p>
</div>

<div id="outline-container-sec-43-1" class="outline-3">
<h3 id="sec-43-1"><span class="section-number-3">43.1</span> Equations</h3>
<div class="outline-text-3" id="text-43-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">valence</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
<span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
A <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">pair</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">cart</span> B
<span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A
<span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">cart</span> A
<span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">simple</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">or</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
isshape A ==&gt; <span style="color: #ffffff; font-weight: bold;">tell</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tell</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-44" class="outline-2">
<h2 id="sec-44"><span class="section-number-2">44</span> <code>case-expr</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ctrl">ctrl</span></span></h2>
<div class="outline-text-2" id="text-44">

<p>
The expression following case is evaluated.  If the result matches one of the constants, C1 &#x2026; Cn, the corresponding expression sequence is executed.  If the result does not match any constant, the expression sequence following else is executed.
</p>

<p>
Example:
</p>
<div class="org-src-container">

<pre class="src src-nial">Month <span style="color: #ff00ff;">:=</span> 3 ;
<span style="color: #00ffff;">CASE</span> Month <span style="color: #00ffff;">FROM</span>
   1:   Mname <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'January'</span>; <span style="color: #00ffff;">END</span>
   2:   Mname <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'February'</span>; <span style="color: #00ffff;">END</span>
   3:   Mname <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'March'</span>; <span style="color: #00ffff;">END</span>
<span style="color: #00ffff;">ELSE</span>   Mname <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'Year End'</span>;
<span style="color: #00ffff;">ENDCASE</span> ;
Mname
</pre>
</div>
<p>
March
</p>
</div>
</div>

<div id="outline-container-sec-45" class="outline-2">
<h2 id="sec-45"><span class="section-number-2">45</span> <i>cast</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span>&#xa0;<span class="table">table</span></span></h2>
<div class="outline-text-2" id="text-45">

<p>
A cast is an array expression that denotes an internal representation of a valid fragment of Q'Nial program text:
</p>
<pre class="example">
cast ::= ! identifier
   | ! ( expression-sequence)
   | ! ( operation-expression )
   | ! ( transformer-expression )
</pre>

<p>
The use of the exclamation symbol ! before an identifier causes Q'Nial to select the internal representation for the identifier rather than the value of the array associated with the identifier.  Its use before a parenthesized program fragment selects the internal representation of the program fragment.
</p>

<p>
The major use of casts is in conjunction with the operations assign and apply.  These operations mimic the Q'Nial constructs for assignment to a variable and application of an operation to an array.  Casts permit passing an argument to an operation by variable name rather than by value.  They also permit evaluation of a program fragment that has been stored in its internal form using the operation eval rather than requiring the use of the operation execute on the corresponding program text stored as a string.
</p>

<div class="org-src-container">

<pre class="src src-nial">Salary <span style="color: #ff00ff;">:=</span> 90000.
A <span style="color: #00ffff;">gets</span> <span style="color: #00ff00;">'Salary &gt; 100000.'</span> ;
Rule1 <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> A
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">Rule1 <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">eval</span> !A
</pre>
</div>
<pre class="example">
o
</pre>

<p>
The details of the internal representation is not specified as part of the Nial language.
</p>

<p>
The cast notation !Name is used to denote the parse tree that represents the name.  At the top level loop, parentheses must be included around the use of the cast notation, e.g.  (!Name), to avoid ambiguity with the use of ! to indicate a host command.
</p>

<p>
The cast, because it is analyzed in the context in which it appears, refers to a variable or definition in a static way.
</p>

<p>
Q'Nial contains operations that mimic the underlying meaning of variables, expressions and operations in Q'Nial.  The operations use strings, phrases or casts to represent the name of the object under consideration (except that see and getdef do not take casts).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Operation</td>
<td class="left">Action</td>
</tr>

<tr>
<td class="left">value A</td>
<td class="left">Return the value of a variable named by string, phrase or cast A.</td>
</tr>

<tr>
<td class="left">A assign B</td>
<td class="left">Assign the array B to the variable named by string, phrase or cast A; return B.</td>
</tr>

<tr>
<td class="left">A apply B</td>
<td class="left">Apply the operation named by string, phrase or cast A to array B; return the result of the operation.</td>
</tr>

<tr>
<td class="left">getdef A</td>
<td class="left">Return the parse tree associated with the definition named by string or phrase A.</td>
</tr>

<tr>
<td class="left">see A</td>
<td class="left">Display the definition named by the string or phrase A.</td>
</tr>

<tr>
<td class="left">update P A B</td>
<td class="left">Put array B at address A in the variable named by the phrase, string or cast P; return the new value of P.</td>
</tr>

<tr>
<td class="left">updateall P A B</td>
<td class="left">Put items of B at addresses A in the variable named by the phrase, string or cast P;</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">return the new value of the variable named by P.</td>
</tr>

<tr>
<td class="left">deepupdate P A B</td>
<td class="left">Put array B at path A in variable named by the string, phrase or cast P; return new value of the variable named by P.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-46" class="outline-2">
<h2 id="sec-46"><span class="section-number-2">46</span> <code>catenate</code></h2>
<div class="outline-text-2" id="text-46">
<p>
:PROPERTY:
:Class:  construction operation
:Usage:  I catenate A   catenate I A
:SeeAlso: link, laminate
:END:
</p>

<p>
The operation catenate joins the items of A along axis I.  The items of A must conform in all other axes.
</p>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">catenate</span> (<span style="color: #ffffff; font-weight: bold;">tell</span> 2 3) (<span style="color: #ffffff; font-weight: bold;">count</span> 2 5)
</pre>
</div>
<pre class="example">
+---+---+---+---+---+---+---+---+
|0 0|0 1|0 2|1 1|1 2|1 3|1 4|1 5|
+---+---+---+---+---+---+---+---+
|1 0|1 1|1 2|2 1|2 2|2 3|2 4|2 5|
+---+---+---+---+---+---+---+---+
</pre>

<p>
The example joins two tables along the rows.  Each table has two rows.
</p>
</div>

<div id="outline-container-sec-46-1" class="outline-3">
<h3 id="sec-46-1"><span class="section-number-3">46.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-46-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">catenate</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> I A {
   <span style="color: #66f;">% "push down" I axis of items of A;</span>
   B <span style="color: #ff00ff;">:=</span> <span style="color: #ffff00;">EACH</span> ( I <span style="color: #ffffff; font-weight: bold;">split</span> ) A ;
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B <span style="color: #00ffff;">THEN</span>
      I <span style="color: #ffffff; font-weight: bold;">blend</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">pack</span> B
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?conform error in catenate'</span>
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-47" class="outline-2">
<h2 id="sec-47"><span class="section-number-2">47</span> <code>ceiling</code></h2>
<div class="outline-text-2" id="text-47">

<p>
The operation ceiling produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">corresponding integer</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">argument</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">next higher integer or the fault ?A, if the result is outside the range of integers</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<p>
Examples
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ceiling</span>  l  -2  3.5
</pre>
</div>
<pre class="example">
1 -2 4
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ceiling</span>  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
?A ?A ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ceiling</span>  3.5  -4.6  7.0  25.3e20
</pre>
</div>
<pre class="example">
4 -4 7 ?A
</pre>
</div>

<div id="outline-container-sec-47-1" class="outline-3">
<h3 id="sec-47-1"><span class="section-number-3">47.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-47-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ceiling</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">floor</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-48" class="outline-2">
<h2 id="sec-48"><span class="section-number-2">48</span> <code>char</code></h2>
<div class="outline-text-2" id="text-48">

<p>
The operation char is used to convert an integer in the range 0 to 255 to the character that has the integer as its internal representation.  The result is system dependent.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">char</span> 66
</pre>
</div>
<pre class="example">
B
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">char</span> 66 67 68 69
</pre>
</div>
<pre class="example">
BCDE
</pre>


<p>
The major purpose of char is to create special characters for a specific system.  For example, the characters that control cursor motion differ from one terminal to another.  Programs using char may not be portable.
</p>
</div>

<div id="outline-container-sec-48-1" class="outline-3">
<h3 id="sec-48-1"><span class="section-number-3">48.1</span> Equations</h3>
<div class="outline-text-3" id="text-48-1">
<div class="org-src-container">

<pre class="src src-nial">N <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 256 ==&gt; <span style="color: #ffffff; font-weight: bold;">charrep</span> <span style="color: #ffffff; font-weight: bold;">char</span> N <span style="color: #ff00ff; font-weight: bold;">=</span> N
<span style="color: #ffffff; font-weight: bold;">ischar</span> C ==&gt; <span style="color: #ffffff; font-weight: bold;">char</span> <span style="color: #ffffff; font-weight: bold;">charrep</span> C <span style="color: #ff00ff; font-weight: bold;">=</span> C
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-49" class="outline-2">
<h2 id="sec-49"><span class="section-number-2">49</span> <code>charrep</code></h2>
<div class="outline-text-2" id="text-49">

<p>
The operation charrep is used to convert a character to its internal representation as an integer.  This operation is system dependent.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">charrep</span> `A
</pre>
</div>
<pre class="example">
65
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">charrep</span> <span style="color: #00ff00;">'hello'</span>
</pre>
</div>
<pre class="example">
104 101 108 108 111
</pre>


<p>
The major purpose of charrep is to permit determination of special characters for a specific system.  For example, the characters that control cursor motion differ from one terminal to another.
</p>

<p>
Programs using charrep may not be portable.
</p>
</div>

<div id="outline-container-sec-49-1" class="outline-3">
<h3 id="sec-49-1"><span class="section-number-3">49.1</span> Equations</h3>
<div class="outline-text-3" id="text-49-1">
<div class="org-src-container">

<pre class="src src-nial">N <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 256 ==&gt; <span style="color: #ffffff; font-weight: bold;">charrep</span> <span style="color: #ffffff; font-weight: bold;">char</span> N <span style="color: #ff00ff; font-weight: bold;">=</span> N
<span style="color: #ffffff; font-weight: bold;">ischar</span> C ==&gt; <span style="color: #ffffff; font-weight: bold;">char</span> <span style="color: #ffffff; font-weight: bold;">charrep</span> C <span style="color: #ff00ff; font-weight: bold;">=</span> C
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-50" class="outline-2">
<h2 id="sec-50"><span class="section-number-2">50</span> <code>checkpoint</code></h2>
<div class="outline-text-2" id="text-50">

<p>
Checkpoint is a user defined expression executed after a save.
</p>

<p>
When a save is executed, the current computation is ended and the Checkpoint is done in the top level environment.
</p>

<p>
If a workspace being saved contains an expression named Checkpoint, the expression is executed following the saving of the workspace and prior to restarting the top level loop.  It can be used to restart a computational loop after an intermediate dump of the workspace.
</p>
</div>
</div>

<div id="outline-container-sec-51" class="outline-2">
<h2 id="sec-51"><span class="section-number-2">51</span> <code>choose</code></h2>
<div class="outline-text-2" id="text-51">

<p>
The operation choose is used to select a subarray from array A specified by the array of addresses I.  The result is an array of the same shape as I with items chosen from A.  If an item of I is not an address of A, the corresponding position in the result is the fault ?address.
</p>

<p>
The operation choose is related to the at all notation V#I, which selects items from the array associated with the variable V.  The differences are that choose may select from an array that has not been assigned to a variable and that it handles out-of-range in a different manner.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 1 0 1 3 4 <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #00ff00;">'range'</span>
</pre>
</div>
<pre class="example">
garage
</pre>

<p>
The following example shows that the valence of the array of addresses can be higher than that of the array from which the selection is made.
</p>

<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #00ffff;">gets</span> (2 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 8)
</pre>
</div>
<pre class="example">
0 1 2 3
4 5 6 7
</pre>

<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #00ff00;">'some words as a string'</span>
</pre>
</div>
<pre class="example">
some
 wor
</pre>
</div>

<div id="outline-container-sec-51-1" class="outline-3">
<h3 id="sec-51-1"><span class="section-number-3">51.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-51-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> I A { I <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">pick</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-51-2" class="outline-3">
<h3 id="sec-51-2"><span class="section-number-3">51.2</span> Equations</h3>
<div class="outline-text-3" id="text-51-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> (I <span style="color: #ffffff; font-weight: bold;">choose</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> I
J <span style="color: #ffffff; font-weight: bold;">choose</span> (I <span style="color: #ffffff; font-weight: bold;">choose</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> (J <span style="color: #ffffff; font-weight: bold;">choose</span> I) <span style="color: #ffffff; font-weight: bold;">choose</span> A
<span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
(<span style="color: #ffffff; font-weight: bold;">list</span> I) <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> (I <span style="color: #ffffff; font-weight: bold;">choose</span> A)
(<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">list</span> I) <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> I <span style="color: #ffffff; font-weight: bold;">choose</span> A
I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; <span style="color: #ffff00;">EACH</span> f (I <span style="color: #ffffff; font-weight: bold;">choose</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> I <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #ffff00;">EACH</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-52" class="outline-2">
<h2 id="sec-52"><span class="section-number-2">52</span> clear workspace&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-52">

<p>
Q'Nial organizes the data and code objects available for use into a logical structure called a workspace. It consists of a symbol table to hold associations between names and the predefined and user defined objects, a heap to store data and parse trees, a stack used to hold values temporarily during execution, and an atom table for uniquely storing phrases and faults.
</p>

<p>
When Q'Nial is invoked it starts the session with a clear workspace unless a specific saved workspace is requested or there is a continue.nws file in the local directory. The clear workspace is either found in the local directory, in the directory pointed at by Nialroot. The name of the clear workspace is clearws.nhs. If it is not found, then Q'Nial creates an internal clear workspace using its initialization process. A message indicates whether a clear workspace was loaded or created.
</p>

<p>
A user can tailor the initial state of Nial for their own purposes by saving a workspace with definitions in place as clearws.nws using save.
</p>
</div>
</div>

<div id="outline-container-sec-53" class="outline-2">
<h2 id="sec-53"><span class="section-number-2">53</span> <code>clearprofile</code></h2>
<div class="outline-text-2" id="text-53">

<p>
The expression <i>=Clearprofile=</i> is used to clear the internal data structures that are used in the gathering of profiling statistics.  It should be called when one profiling session has been completed and profile has been called, before starting another one.
</p>

<p>
A detailed explanation of the profiling mechanism is given in the help entry on profiling.
</p>
</div>

<div id="outline-container-sec-53-1" class="outline-3">
<h3 id="sec-53-1"><span class="section-number-3">53.1</span> Example</h3>
<div class="outline-text-3" id="text-53-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Clearprofile</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-54" class="outline-2">
<h2 id="sec-54"><span class="section-number-2">54</span> <code>clearws</code></h2>
<div class="outline-text-2" id="text-54">

<p>
The expression <i>=Clearws=</i> clears the current workspace, erasing all variables and user definitions.  It can cause loss of valuable information.  The operation save should be used prior to using Clearws if the information in the workspace will be needed again.
</p>

<p>
The expression <i>=Restart=</i> is similar to <i>=Clearws=</i> except <i>=Restart=</i> re-initializes the interpreter according to the initial options given on the command line in a console version or set as defaults in a GUI version.
</p>
</div>
</div>

<div id="outline-container-sec-55" class="outline-2">
<h2 id="sec-55"><span class="section-number-2">55</span> <code>close</code></h2>
<div class="outline-text-2" id="text-55">

<p>
The operation close is used to close a file previously opened with the open operation.  The argument is the file designator, an integer returned previously by open for that file.
</p>

<p>
The result of close is the fault ?noexpr or a fault message indicating an error.
</p>

<div class="org-src-container">

<pre class="src src-nial">Fd <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> <span style="color: #ffaf00;">"foo</span> <span style="color: #ffaf00;">"w</span>
</pre>
</div>
<pre class="example">
3
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">close</span> Fd
<span style="color: #ffffff; font-weight: bold;">close</span> Fd
</pre>
</div>
<pre class="example">
?file is not open
</pre>

<p>
In the examples above, the first use of close was successful.  The second attempt to close the file resulted in the fault message.
</p>
</div>
</div>

<div id="outline-container-sec-56" class="outline-2">
<h2 id="sec-56"><span class="section-number-2">56</span> <code>cols</code></h2>
<div class="outline-text-2" id="text-56">

<p>
The operation cols rearranges the axes of a table of shape M by N to form a list of length N of the columns of length M of the table.  Cols is generalized to arrays of all valences as follows: if A is a list or a single, the result is single A; if A has valence three or higher, the result is an array of valence one less than the valence of A with the second last axis pushed down.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 12
</pre>
</div>
<pre class="example">
1  2  3  4
5  6  7  8
9 10 11 12
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cols</span> A
</pre>
</div>
<pre class="example">
+-----+------+------+------+
|1 5 9|2 6 10|3 7 11|4 8 12|
+-----+------+------+------+
</pre>

<p>
If only column I of a table is needed, it can be selected by I pick cols A or by A|[,I] using the at slice indexing notation.  The second way is more efficient for large arrays because it avoids restructuring the array.  If a table A has no columns, <a href="#sec-56">56</a> A results in the empty list <i>=Null=</i>.
</p>
</div>

<div id="outline-container-sec-56-1" class="outline-3">
<h3 id="sec-56-1"><span class="section-number-3">56.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-56-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cols</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 0 <span style="color: #00ffff;">THEN</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 2 <span style="color: #ffffff; font-weight: bold;">max</span> 0 <span style="color: #ffffff; font-weight: bold;">split</span> A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-56-2" class="outline-3">
<h3 id="sec-56-2"><span class="section-number-3">56.2</span> Equations</h3>
<div class="outline-text-3" id="text-56-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 2 <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">cols</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A
<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 2 <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">cols</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">rows</span> <span style="color: #ffffff; font-weight: bold;">transpose</span> A
<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 2 <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #ffffff; font-weight: bold;">cols</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">transpose</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-57" class="outline-2">
<h2 id="sec-57"><span class="section-number-2">57</span> <i>comment</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-57">

<pre class="example">
comment ::=
   % &lt;any text excluding a semicolon&gt; ;
</pre>

<pre class="example">
remark ::= # &lt; any text &gt;
</pre>

<p>
A comment is a brief section of text included in a program fragment to assist readability.  Comments may be placed anywhere in a block before or after declarations, definitions or expressions.  Their purpose is to provide an explanation of the program fragment for the programmer who may be required to modify the program at a later date.  The value of a comment as an expression is the ?noexpr fault.  Comments are retained when a definition is translated into internal form and they appear in its creation in the canonical form used by the operations see and defedit.
</p>

<p>
A remark is an input to the Q'Nial interpreter that is not processed.  It begins with a line that has the symbol # as the first non-blank character in the line.  In direct input at the top level loop, a remark ends at the end of the line unless a backslash symbol ( \ ) is used to extend the line.  In a definition file, a remark ends at the first blank line.  A remark cannot appear within a definition or expression-sequence.
</p>
</div>
</div>

<div id="outline-container-sec-58" class="outline-2">
<h2 id="sec-58"><span class="section-number-2">58</span> conform</h2>
<div class="outline-text-2" id="text-58">

<p>
The operation <a href="#sec-210">210</a> is used in evaluating binary pervasive and multi pervasive operations. Its task is to interchange the top two levels of the argument to such operations if the items of the argument conform. For the binary case there are two items; they conform if the items have the same shape, or if one or both items have only one item. In the latter case, the item with only one item is replicated to the shape of the other item.
</p>

<p>
For the multi pervasive case, all the items that do not have only one item must be of the same shape and all the items with one item are replicated to that shape.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> [2 3 4,10 11 12]
</pre>
</div>
<pre class="example">
+----+----+----+
|2 10|3 11|4 12|
+----+----+----+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> [2 3,10 11 12]
</pre>
</div>
<pre class="example">
?conform
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> [3 4 5,3,10 11 12,[4]]
</pre>
</div>
<pre class="example">
+--------+--------+--------+
|3 3 10 4|4 3 11 4|5 3 12 4|
+--------+--------+--------+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> [<span style="color: #ffffff; font-weight: bold;">tell</span> 4 5,<span style="color: #ffffff; font-weight: bold;">count</span> 4 5]
</pre>
</div>
<pre class="example">
+---------+---------+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
||0 0|1 1|||0 1|1 2|||0 2|1 3|||0 3|1 4|||0 4|1 5||
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
||1 0|2 1|||1 1|2 2|||1 2|2 3|||1 3|2 4|||1 4|2 5||
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
||2 0|3 1|||2 1|3 2|||2 2|3 3|||2 3|3 4|||2 4|3 5||
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
||3 0|4 1|||3 1|4 2|||3 2|4 3|||3 3|4 4|||3 4|4 5||
|+---+---+|+---+---+|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+---------+---------+
</pre>
</div>

<div id="outline-container-sec-58-1" class="outline-3">
<h3 id="sec-58-1"><span class="section-number-3">58.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-58-1">
<div class="org-src-container">

<pre class="src src-nial">conform <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">OP</span> A {
    <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span>
      (<span style="color: #ffffff; font-weight: bold;">not</span> (<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">match</span> 1) <span style="color: #ffffff; font-weight: bold;">sublist</span> A) }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-59" class="outline-2">
<h2 id="sec-59"><span class="section-number-2">59</span> <code>content</code></h2>
<div class="outline-text-2" id="text-59">

<p>
The operation <a href="#sec-59">59</a> returns the list of atoms of A.  The effect of content is to remove all structure from an array, returning a list of the atoms in a depth first, row-major order.  The effect on an atom is to produce the solitary of the atom.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> (2 3) (4 5 (6 7))
</pre>
</div>
<pre class="example">
+---+---------+
|2 3|+-+-+---+|
|   ||4|5|6 7||
|   |+-+-+---+|
+---+---------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">content</span> A
</pre>
</div>
<pre class="example">
2 3 4 5 6 7
</pre>
</div>

<div id="outline-container-sec-59-1" class="outline-3">
<h3 id="sec-59-1"><span class="section-number-3">59.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-59-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">content</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">atomic</span> A <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">list</span> A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">content</span> A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-59-2" class="outline-3">
<h3 id="sec-59-2"><span class="section-number-3">59.2</span> Equations</h3>
<div class="outline-text-3" id="text-59-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">content</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">content</span> A
<span style="color: #ffffff; font-weight: bold;">content</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">content</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">content</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">content</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-60" class="outline-2">
<h2 id="sec-60"><span class="section-number-2">60</span> <code>continue</code></h2>
<div class="outline-text-2" id="text-60">

<p>
The expression Continue terminates a session of Q'Nial and returns control to the host environment.  The workspace is saved in file continue.nws and is reloaded when Q'Nial is invoked at a later session using the same current directory.
</p>

<p>
If a Restart is executed in a session that began with a continue workspace, the current workspace will be reset to the continue workspace.  If a session that began with a continue is terminated with Continue, the file continue.nws is updated with the current workspace.  If it is terminated with Bye, the file continue.nws is deleted.
</p>
</div>
</div>

<div id="outline-container-sec-61" class="outline-2">
<h2 id="sec-61"><span class="section-number-2">61</span> continue workspace&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-61">

<p>
The file continue.nws is a workspace file that is created when a session is ended with the expression Continue.  When QNial is invoked from the same directory, it will use continue.nws rather than clearws.nws as the initial workspace.  If the QNial invocation names a workspace, that workspace will take precedence over the continue workspace.
</p>
</div>
</div>

<div id="outline-container-sec-62" class="outline-2">
<h2 id="sec-62"><span class="section-number-2">62</span> control tuples</h2>
<div class="outline-text-2" id="text-62">

<p>
Many of the screen related operations require a display attribute, termed a control tuple, as one of the arguments.  The display attribute specifies the color or style of the characters displayed by the operation.  It is display screen dependent.
</p>

<p>
Various displays are available for IBMPC systems and they can run in different modes.  For a monochrome display, Q'Nial can specify normal, bold, underlined, reverse video and blinking characters.  If the terminal has a color display, Q'Nial can specify foreground and background colors.  Each color combination can have blinking characters.
</p>

<p>
For a Unix system, the display screen is driven by the terminfo capability table which provides the following styles: normal, standout, underlined, bold and blinking, where either standout or bold is mapped to reverse video.  Not all terminals support all these capabilities.  No specific allowance for color is made in the Unix version of Q'Nial.
</p>

<p>
To accommodate all these varieties, the display attribute is encoded as a triple of integers on IBMPC versions and as a single integer on Unix with the following interpretations:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Display</th>
<th scope="col" class="left">first</th>
<th scope="col" class="left">second</th>
<th scope="col" class="left">third</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">IBMPC Mono</td>
<td class="left">style</td>
<td class="left">reversed or not</td>
<td class="left">blinking</td>
</tr>

<tr>
<td class="left">IBMPC Color</td>
<td class="left">foregrd</td>
<td class="left">backgrd color</td>
<td class="left">blinking</td>
</tr>

<tr>
<td class="left">Unix terminal</td>
<td class="left">style</td>
<td class="left">unused</td>
<td class="left">unused</td>
</tr>
</tbody>
</table>

<p>
The following tables fill in the detailed codes for the three forms of display attributes.
</p>

<p>
IBMPC Monochrome Display Attributes
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Code</th>
<th scope="col" class="left">Ch Style</th>
<th scope="col" class="left">Rev. Video</th>
<th scope="col" class="left">Blink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="left">Normal</td>
<td class="left">No</td>
<td class="left">No</td>
</tr>

<tr>
<td class="right">1</td>
<td class="left">Underlined</td>
<td class="left">Yes</td>
<td class="left">Yes</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">Bold</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">3</td>
<td class="left">Underlined and bold</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>



<p>
IBMPC CGA Color Display Attributes
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Code</th>
<th scope="col" class="left">Foregrd</th>
<th scope="col" class="left">Backgrd</th>
<th scope="col" class="left">Blink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="left">black</td>
<td class="left">black</td>
<td class="left">No</td>
</tr>

<tr>
<td class="right">1</td>
<td class="left">blue</td>
<td class="left">blue</td>
<td class="left">Yes</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">red</td>
<td class="left">red</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">3</td>
<td class="left">yellow</td>
<td class="left">yellow</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">4</td>
<td class="left">white</td>
<td class="left">white</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">5</td>
<td class="left">light blue</td>
<td class="left">light blue</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">6</td>
<td class="left">purple</td>
<td class="left">purple</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="right">7</td>
<td class="left">green</td>
<td class="left">green</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Color codes 8 through 15 result in high intensity display of the color.
</p>

<p>
Unix Terminal Display Attributes
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Code</th>
<th scope="col" class="left">Ch Style</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="left">Normal</td>
</tr>

<tr>
<td class="right">1</td>
<td class="left">Standout</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">Bold</td>
</tr>

<tr>
<td class="right">3</td>
<td class="left">Underlined</td>
</tr>

<tr>
<td class="right">4</td>
<td class="left">Blinking</td>
</tr>
</tbody>
</table>

<p>
With this variety of attributes, it is impossible to make programs work identically when they are ported from one system to another.  To retain portability attributes should be set up in terms of variables such as Normalattribute, Highattribute, Borderattribute etc.  and given values according to the system in use.
</p>
</div>
</div>

<div id="outline-container-sec-63" class="outline-2">
<h2 id="sec-63"><span class="section-number-2">63</span> <code>CONVERSE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-63">

<p>
The transformer <i>=CONVERSE=</i> is used with a binary operation f and applies f to the pair formed by reversing the arguments of <i>=CONVERSE=</i> f.
</p>

<div class="org-src-container">

<pre class="src src-nial">at <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">CONVERSE</span> <span style="color: #ffffff; font-weight: bold;">pick</span>
<span style="color: #00ff00;">'abcde'</span> at 2
</pre>
</div>
<pre class="example">
c
</pre>

<div class="org-src-container">

<pre class="src src-nial">holds <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">CONVERSE</span> <span style="color: #ffffff; font-weight: bold;">in</span>
<span style="color: #ffffff; font-weight: bold;">count</span> 20 holds 5
</pre>
</div>
<pre class="example">
l
</pre>

<p>
In the above examples, at and holds are defined in terms of pick and in, respectively.  The first example shows that 'abcde' at 2 gives the result expected for 2 pick 'abcde'.  The second example shows that count 20 holds 5 gives the same result as 5 in (count 20).  Thus, at and holds do the same work as pick and in; the former operations simply use their arguments in the reverse order.
</p>
</div>

<div id="outline-container-sec-63-1" class="outline-3">
<h3 id="sec-63-1"><span class="section-number-3">63.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-63-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">CONVERSE</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B {
   B f A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-63-2" class="outline-3">
<h3 id="sec-63-2"><span class="section-number-3">63.2</span> Equations</h3>
<div class="outline-text-3" id="text-63-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffff00;">CONVERSE</span> <span style="color: #ffff00;">CONVERSE</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> A f B
A <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ffff00;">CONVERSE</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-64" class="outline-2">
<h2 id="sec-64"><span class="section-number-2">64</span> <code>copyright</code></h2>
<div class="outline-text-2" id="text-64">

<p>
The expression Copyright returns a message specifying ownership of the rights to Q'Nial by Queen's University at Kingston, Canada (K7L 3N6).
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Copyright</span>
</pre>
</div>
<pre class="example">
Copyright (c) Queen's University 1983-97
</pre>
</div>
</div>

<div id="outline-container-sec-65" class="outline-2">
<h2 id="sec-65"><span class="section-number-2">65</span> <code>cos</code></h2>
<div class="outline-text-2" id="text-65">

<p>
The operation <a href="#sec-65">65</a> implements the cosine function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">cosine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">cosine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">cosine of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?cos</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?cos</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cos</span>  l  -1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0.54030 0.54030 0.87758 ?cos ?cos ?error
</pre>
</div>

<div id="outline-container-sec-65-1" class="outline-3">
<h3 id="sec-65-1"><span class="section-number-3">65.1</span> Equation</h3>
<div class="outline-text-3" id="text-65-1">
<div class="org-src-container">

<pre class="src src-nial">s <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cos</span> A
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-66" class="outline-2">
<h2 id="sec-66"><span class="section-number-2">66</span> <code>cosh</code></h2>
<div class="outline-text-2" id="text-66">

<p>
The operation cosh implements the hyperbolic cosine function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">hyperbolic cosine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">hyperbolic cosine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">hyperbolic cosine of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?cosh</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?cosh</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cosh</span>  l  -1  0.5
</pre>
</div>
<pre class="example">
1.54308 1.54308 1.12763
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cosh</span> `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
?cosh ?cosh ?error
</pre>
</div>

<div id="outline-container-sec-66-1" class="outline-3">
<h3 id="sec-66-1"><span class="section-number-3">66.1</span> Equation</h3>
<div class="outline-text-3" id="text-66-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cosh</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cosh</span> A
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-67" class="outline-2">
<h2 id="sec-67"><span class="section-number-2">67</span> <code>count</code></h2>
<div class="outline-text-2" id="text-67">

<p>
The operation <a href="#sec-67">67</a> generates a list of integers starting at 1 and going up to and including N.  It differs from tell by counting from 1 instead of from 0.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">count</span> 5
</pre>
</div>
<pre class="example">
1 2 3 4 5
</pre>



<div class="org-src-container">

<pre class="src src-nial">.1 <span style="color: #ffffff; font-weight: bold;">times</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5
</pre>
</div>
<pre class="example">
0.1 0.2 0.3 0.4 0.5
</pre>


<p>
The first example shows count generating the sequence of integers from 1 to 5.  The second example shows how count can be used to generate a sequence of five real numbers with an interval of .1 between each number.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">count</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+
|1 1|1 2|1 3|
+---+---+---+
|2 1|2 2|2 3|
+---+---+---+
</pre>

<p>
The third example shows how count generalizes to other arguments in the same manner as the operation tell.
</p>
</div>

<div id="outline-container-sec-67-1" class="outline-3">
<h3 id="sec-67-1"><span class="section-number-3">67.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-67-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">count</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { 1 <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">tell</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-67-2" class="outline-3">
<h3 id="sec-67-2"><span class="section-number-3">67.2</span> Equations</h3>
<div class="outline-text-3" id="text-67-2">
<div class="org-src-container">

<pre class="src src-nial">isshape A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">count</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
isshape A ==&gt; <span style="color: #ffffff; font-weight: bold;">count</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">count</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-68" class="outline-2">
<h2 id="sec-68"><span class="section-number-2">68</span> <code>cull</code></h2>
<div class="outline-text-2" id="text-68">

<p>
The operation cull returns a list whose items are those of A with duplicates removed.  The order of the items is maintained.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cull</span> 3 5 4 3 5 2 4
</pre>
</div>
<pre class="example">
3 5 4 2
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cull</span> <span style="color: #00ff00;">'a few letters with duplicates'</span>
</pre>
</div>
<pre class="example">
a fewltrsihdupc
</pre>
</div>

<div id="outline-container-sec-68-1" class="outline-3">
<h3 id="sec-68-1"><span class="section-number-3">68.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-68-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cull</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">in</span> (A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">find</span> A) <span style="color: #ffffff; font-weight: bold;">sublist</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-68-2" class="outline-3">
<h3 id="sec-68-2"><span class="section-number-3">68.2</span> Equations</h3>
<div class="outline-text-3" id="text-68-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cull</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">cull</span> A
<span style="color: #ffffff; font-weight: bold;">diverse</span> A &lt;==&gt; <span style="color: #ffffff; font-weight: bold;">cull</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">sortup</span> <span style="color: #ffffff; font-weight: bold;">cull</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cull</span> <span style="color: #ffffff; font-weight: bold;">sortup</span> A
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-68-3" class="outline-3">
<h3 id="sec-68-3"><span class="section-number-3">68.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-68-3">
<p>
The operation <code>cull</code> executes faster when a large array has been sorted, hence if the ordering of the result is unimportant it is better to use <code>sortup</code> to order the array prior to applying <code>cull</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-69" class="outline-2">
<h2 id="sec-69"><span class="section-number-2">69</span> curried operation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-69">

<p>
A curried-operation is an operation in which the left item of a two-item argument is combined with a given operation to form an operation expression.  Examples are: 1+ and 3 reshape.
</p>

<p>
A curried operation can be named or grouped in parentheses as an argument to a transformer.
</p>

<div class="org-src-container">

<pre class="src src-nial">incr <span style="color: #00ffff;">IS</span> 1+
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> (5 <span style="color: #ffffff; font-weight: bold;">take</span>) Lines
</pre>
</div>
<pre class="example">
</pre>

<p>
In general, the syntax of a curried operation is:
</p>

<pre class="example">
curried-operation ::= simple-expression simple-operation
</pre>

<p>
The result of applying a curried-operation is determined by applying the simple-operation to the pair formed from the simple-expression and the argument to the curried-operation.  Thus,
</p>

<div class="org-src-container">

<pre class="src src-nial">(1+) 5
</pre>
</div>
<pre class="example">
6
</pre>


<p>
is interpreted as
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ff00ff; font-weight: bold;">+</span> (1 5)
</pre>
</div>
<pre class="example">
6
</pre>
</div>
</div>

<div id="outline-container-sec-70" class="outline-2">
<h2 id="sec-70"><span class="section-number-2">70</span> <code>cut</code></h2>
<div class="outline-text-2" id="text-70">

<p>
The operation <a href="#sec-70">70</a> converts an array A into a list of items formed from the items of A according to the bitstring B.  The list of items is divided where true values occur in the corresponding positions in the bitstring B.  The items of A where the divisions occur are not included in the items of the result and any empty segments are not included.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'The boy stood   on the burning deck'</span> ;
`  <span style="color: #ffffff; font-weight: bold;">match</span> A <span style="color: #ffffff; font-weight: bold;">cut</span> A
</pre>
</div>
<pre class="example">
+---+---+-----+--+---+-------+----+
|The|boy|stood|on|the|burning|deck|
+---+---+-----+--+---+-------+----+
</pre>


<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'Formula 1: 3,5,7,,,9'</span>;
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial">`, <span style="color: #ffffff; font-weight: bold;">match</span> B <span style="color: #ffffff; font-weight: bold;">cut</span> B
</pre>
</div>
<pre class="example">
+------------+-+-+-+
|Formula 1: 3|5|7|9|
+------------+-+-+-+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 4 4 <span style="color: #ffffff; font-weight: bold;">cut</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 4 4
</pre>
</div>
<pre class="example">
+-----------------+-----------------+-----------------+
|+---+---+---+---+|+---+---+---+---+|+---+---+---+---+|
||0 1|0 2|0 3|1 0|||1 2|1 3|2 0|2 1|||2 3|3 0|3 1|3 2||
|+---+---+---+---+|+---+---+---+---+|+---+---+---+---+|
+-----------------+-----------------+-----------------+
</pre>

<p>
Cut can be used to cut a string into a list of substrings.  In the first example, the string is cut at blank characters.  Several adjacent blanks are treated as one blank character.  In the second example, the cut is done where commas occur.  The third example shows that the items of A do not have to be atoms.
</p>
</div>

<div id="outline-container-sec-70-1" class="outline-3">
<h3 id="sec-70-1"><span class="section-number-3">70.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-70-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">cut</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> B A {
   C <span style="color: #ff00ff;">:=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">rest</span> (B <span style="color: #ffffff; font-weight: bold;">cutall</span> A);
   <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">empty</span> C <span style="color: #ffffff; font-weight: bold;">sublist</span> C }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-70-2" class="outline-3">
<h3 id="sec-70-2"><span class="section-number-3">70.2</span> Equations</h3>
<div class="outline-text-3" id="text-70-2">
<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ffffff; font-weight: bold;">cut</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ffffff; font-weight: bold;">cut</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> (B <span style="color: #ffffff; font-weight: bold;">cut</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">cut</span> A
B <span style="color: #ffffff; font-weight: bold;">cut</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">cut</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-71" class="outline-2">
<h2 id="sec-71"><span class="section-number-2">71</span> <code>cutall</code></h2>
<div class="outline-text-2" id="text-71">

<p>
The operation <a href="#sec-71">71</a> converts an array A into a list of items formed from the items of A according to the bitstring B.  The list of items is divided where true values occur in the corresponding positions in the bitstring B.  The items where the divisions occur are kept as the first item of each group.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'The boy stood on the deck'</span> ;
`  <span style="color: #ffffff; font-weight: bold;">match</span> A <span style="color: #ffffff; font-weight: bold;">cutall</span> A
</pre>
</div>
<pre class="example">
+---+----+------+---+----+-----+
|The| boy| stood| on| the| deck|
+---+----+------+---+----+-----+
</pre>


<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'Formula 1: 3,5,7,,,9'</span>;
`, <span style="color: #ffffff; font-weight: bold;">match</span> B <span style="color: #ffffff; font-weight: bold;">cutall</span> B
</pre>
</div>
<pre class="example">
+------------+--+--+-+-+--+
|Formula 1: 3|,5|,7|,|,|,9|
+------------+--+--+-+-+--+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 4 4 <span style="color: #ffffff; font-weight: bold;">cutall</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 4 4
</pre>
</div>
<pre class="example">
+---------------------+---------------------+---------------------+-----+
|+---+---+---+---+---+|+---+---+---+---+---+|+---+---+---+---+---+|+---+|
||0 0|0 1|0 2|0 3|1 0|||1 1|1 2|1 3|2 0|2 1|||2 2|2 3|3 0|3 1|3 2|||3 3||
|+---+---+---+---+---+|+---+---+---+---+---+|+---+---+---+---+---+|+---+|
+---------------------+---------------------+---------------------+-----+
</pre>
</div>

<div id="outline-container-sec-71-1" class="outline-3">
<h3 id="sec-71-1"><span class="section-number-3">71.1</span> Equations</h3>
<div class="outline-text-3" id="text-71-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> (B <span style="color: #ffffff; font-weight: bold;">cutall</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> B)
B <span style="color: #ffffff; font-weight: bold;">cutall</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ffffff; font-weight: bold;">cutall</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> (B <span style="color: #ffffff; font-weight: bold;">cutall</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">cutall</span> A
B <span style="color: #ffffff; font-weight: bold;">cutall</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">cutall</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-72" class="outline-2">
<h2 id="sec-72"><span class="section-number-2">72</span> debugging&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-72">
</div>

<div id="outline-container-sec-72-1" class="outline-3">
<h3 id="sec-72-1"><span class="section-number-3">72.1</span> Debugging Definitions</h3>
<div class="outline-text-3" id="text-72-1">
<p>
The Q'Nial system provides an optional debugging facility that aids interactive debugging of definitions.  It is active by default, but can be turned off for running production applications.  See the detailed documentation for the various versions on how to turn off debugging.
</p>

<p>
The debugging system is based on the idea of placing breaks in the code and stepping through the program code in a number of different ways.  Due to constraints in the way Q'Nial is implemented, debugging is always done in the context of an expression sequence.  A break point occurs either before the execution of the expression sequence in a definition, or at an explicit break expression within an expression sequence.  There is also a watch mechanism that executes a defined action whenever the value of a variable changes, and an ability monitor all use of user defined objects and of the predefined operations.
</p>
</div>
</div>

<div id="outline-container-sec-72-2" class="outline-3">
<h3 id="sec-72-2"><span class="section-number-3">72.2</span> Defining a Break Point</h3>
<div class="outline-text-3" id="text-72-2">
<p>
There are two ways to cause a break in a Nial definition: by using the expression Break in an expression sequence, or by using the operation <a href="#sec-32">32</a> to set a break on entry to the operation.  The following table summarizes the break related primitives:
</p>

<dl class="org-dl">
<dt> Expression </dt><dd>Action
</dd>
<dt> Break </dt><dd>Suspend evaluation of the expression and pass control to an evaluation loop in the environment at the point of the break. Variables accessible at that point can be displayed. This loop recognizes a number of commands described below.
</dd>
<dt> breakin Nm [M] </dt><dd>Set or rest an internal break flag for the definition of Nm. If the boolean value M is omitted, the flag is toggled. If set, a break occurs before the execution of the expression sequence of the definition.  The Nm must be the name of a defined expression or a defined operation using the operation form style of operation expression.
</dd>
<dt> Breaklist </dt><dd>Display the list of names of definitions with break flag set.
</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-sec-73" class="outline-2">
<h2 id="sec-73"><span class="section-number-2">73</span> <code>deepplace</code></h2>
<div class="outline-text-2" id="text-73">

<p>
The operation <a href="#sec-73">73</a> returns an array the same as A except that the array at path P is replaced by B.  It is the insertion operation corresponding to the selection operation reach and generalizes the operation <a href="#sec-221">221</a> from addresses to paths.
</p>

<pre class="example">
    A1 := 1 2 (3 4 (5 6 (7 (8 9))))
+-+-+-------------------+
|1|2|+-+-+-------------+|
| | ||3|4|+-+-+-------+||
| | || | ||5|6|+-+---+|||
| | || | || | ||7|8 9||||
| | || | || | |+-+---+|||
| | || | |+-+-+-------+||
| | |+-+-+-------------+|
+-+-+-------------------+
    A1 := "M (2 2 2 0) deepplace A1
+-+-+-------------------+
|1|2|+-+-+-------------+|
| | ||3|4|+-+-+-------+||
| | || | ||5|6|+-+---+|||
| | || | || | ||M|8 9||||
| | || | || | |+-+---+|||
| | || | |+-+-+-------+||
| | |+-+-+-------------+|
+-+-+-------------------+
</pre>

<p>
The array 7 is replaced with
</p>
</div>

<div id="outline-container-sec-73-1" class="outline-3">
<h3 id="sec-73-1"><span class="section-number-3">73.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-73-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">deepplace</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> C A {
   B Path <span style="color: #ff00ff;">:=</span> C ;
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> Path <span style="color: #00ffff;">THEN</span>
      B
   <span style="color: #00ffff;">ELSE</span>
      I <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">first</span> Path ;
      ((B (<span style="color: #ffffff; font-weight: bold;">rest</span> Path)) <span style="color: #ffffff; font-weight: bold;">deepplace</span> (I <span style="color: #ffffff; font-weight: bold;">pick</span> A)) I <span style="color: #ffffff; font-weight: bold;">place</span> A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-73-2" class="outline-3">
<h3 id="sec-73-2"><span class="section-number-3">73.2</span> Equations</h3>
<div class="outline-text-3" id="text-73-2">
<div class="org-src-container">

<pre class="src src-nial">Path a valid path into A ==&gt; ( Path <span style="color: #ffffff; font-weight: bold;">reach</span> A ) Path <span style="color: #ffffff; font-weight: bold;">deepplace</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
B <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">deepplace</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> B, I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; B
<span style="color: #ffffff; font-weight: bold;">deepplace</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> B I <span style="color: #ffffff; font-weight: bold;">place</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-74" class="outline-2">
<h2 id="sec-74"><span class="section-number-2">74</span> <code>deepupdate</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="eval">eval</span></span></h2>
<div class="outline-text-2" id="text-74">

<p>
The operation <a href="#sec-74">74</a> provides the semantics of the Nm@@P := A form of assignment expression.  Nm must be an existing variable represented by a string, phrase or a cast; P is the path of addresses to the location to be updated; and A is the array to be placed in the variable.
</p>

<div class="org-src-container">

<pre class="src src-nial">Array1 <span style="color: #ff00ff;">:=</span> (1 2(3 4 (5 6 (7 (8 9)))))
</pre>
</div>
<pre class="example">
+-+-+-------------------+
|1|2|+-+-+-------------+|
| | ||3|4|+-+-+-------+||
| | || | ||5|6|+-+---+|||
| | || | || | ||7|8 9||||
| | || | || | |+-+---+|||
| | || | |+-+-+-------+||
| | |+-+-+-------------+|
+-+-+-------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">deepupdate</span> <span style="color: #ffaf00;">"Array1</span> (2 2 2 1 0) <span style="color: #ffaf00;">"Tom</span>
</pre>
</div>
<pre class="example">
+-+-+---------------------+
|1|2|+-+-+---------------+|
| | ||3|4|+-+-+---------+||
| | || | ||5|6|+-+-----+|||
| | || | || | ||7|Tom 9||||
| | || | || | |+-+-----+|||
| | || | |+-+-+---------+||
| | |+-+-+---------------+|
+-+-+---------------------+
</pre>

<p>
The major purpose of deepupdate is to allow a selective update with a path on a global variable without forcing a copy.  By passing the name of the variable to the operation that is doing the update, rather than its value, no sharing of the internal data is made and hence the update can be made "in place".
</p>
</div>
</div>

<div id="outline-container-sec-75" class="outline-2">
<h2 id="sec-75"><span class="section-number-2">75</span> definition</h2>
<div class="outline-text-2" id="text-75">

<p>
A definition in Nial is a syntactic construct that names a program fragment. The syntax is one of the three forms:
</p>
<pre class="example">
&lt;name&gt;  IS  &lt;array expression&gt;
&lt;name&gt;  IS  &lt;operation expression&gt;
&lt;name&gt;  IS  &lt;transformer expression&gt;
</pre>

<p>
A definition is used to associate a name (identifier) with a program fragment that is an array expression, an operation expression or a transformer expression. If the definition appears within a block, the association is made in the local environment.  Otherwise, the association is made in the global environment and assigns a role to the name as representing that kind of expression.
</p>

<p>
If the program fragment is syntactically correct, the name is associated with the program fragment in the environment and no result is given.  If a syntax error is detected in the analysis of the program fragment, an explanatory fault message is returned and the name association is not made.
</p>

<p>
If the name being associated in a definition is already in use, the new definition must be for a construct of the same role and the earlier definition is replaced.  The use of a defined name always refers to its most recent definition.
</p>
</div>
</div>

<div id="outline-container-sec-76" class="outline-2">
<h2 id="sec-76"><span class="section-number-2">76</span> <code>deparse</code></h2>
<div class="outline-text-2" id="text-76">

<p>
The operation <a href="#sec-76">76</a> is used to convert a parse tree representation of a Nial definition or program fragment into a token stream which can be converted into text corresponding to the Nial definition.  The argument to deparse must be either a cast or the result of parse or getdef.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">deparse</span> !(<span style="color: #ffffff; font-weight: bold;">Pi</span> <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">cos</span> 0.5)
</pre>
</div>
<pre class="example">
99 1 ( 2 Pi 2 * 2 cos 18 0.5 1 )
</pre>

<p>
The principal use of deparse is in displaying Nial definitions.  It is used in the definition of defedit and see.
</p>

<p>
The token stream returned by deparse also includes indicators to identify where new lines are to begin and to control indentation.  The tokens corresponding to identifiers are given in the canonical form, indicating what role each token plays.
</p>

<p>
The result of deparse is implementation dependent and should be viewed as an internal representation provided as an interface to editing.  It is subject to change as Q'Nial evolves.
</p>
</div>

<div id="outline-container-sec-76-1" class="outline-3">
<h3 id="sec-76-1"><span class="section-number-3">76.1</span> Equations</h3>
<div class="outline-text-3" id="text-76-1">
<div class="org-src-container">

<pre class="src src-nial">Pt a <span style="color: #ffffff; font-weight: bold;">parse</span> tree ==&gt; <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> Pt <span style="color: #ff00ff; font-weight: bold;">=</span> Pt
Ts a token stream ==&gt; <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> <span style="color: #ffffff; font-weight: bold;">parse</span> Ts <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">parse</span> Ts
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-77" class="outline-2">
<h2 id="sec-77"><span class="section-number-2">77</span> <code>depth</code></h2>
<div class="outline-text-2" id="text-77">

<p>
The operation <a href="#sec-77">77</a> returns an integer indicating the number of levels of nesting of the array.  This is called the depth of the array.  The depth of an atom is 0.  The depth of a simple nonempty  is 1. In general, the depth of an array is 1 plus the maximum of the depths of the items.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
0
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> 3 4 5
</pre>
</div>
<pre class="example">
1
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> 1 (2 3) (4 5 6)
</pre>
</div>
<pre class="example">
2
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> [2, [3, 4, [5],8],24]
</pre>
</div>
<pre class="example">
3
</pre>
</div>

<div id="outline-container-sec-77-1" class="outline-3">
<h3 id="sec-77-1"><span class="section-number-3">77.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-77-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
  <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">atomic</span> A <span style="color: #00ffff;">THEN</span>
     0
  <span style="color: #00ffff;">ELSE</span>
     1 <span style="color: #ff00ff; font-weight: bold;">+</span> (<span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">depth</span> A)
  <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-77-2" class="outline-3">
<h3 id="sec-77-2"><span class="section-number-3">77.2</span> Equations</h3>
<div class="outline-text-3" id="text-77-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">depth</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">depth</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 1
<span style="color: #ffffff; font-weight: bold;">depth</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">FORK</span> [<span style="color: #ffffff; font-weight: bold;">atomic</span>, 0 <span style="color: #ffffff; font-weight: bold;">first</span>, 1 <span style="color: #ffffff; font-weight: bold;">plus</span> <span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">depth</span>] A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-78" class="outline-2">
<h2 id="sec-78"><span class="section-number-2">78</span> <code>descan</code></h2>
<div class="outline-text-2" id="text-78">

<p>
The operation <a href="#sec-78">78</a> converts a token stream to a list of strings that represents the program fragment given by the token stream.  The input to descan must be a token stream produced by scan or deparse or an equivalent list of tokens.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'A + 32'</span>
</pre>
</div>
<pre class="example">
+-------+
|A + 32 |
+-------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> !(<span style="color: #ffffff; font-weight: bold;">Pi</span> <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">cos</span> 0.5)
</pre>
</div>
<pre class="example">
+-----------------+
|( Pi * cos 0.5 ) |
+-----------------+
</pre>

<p>
The principal use of descan is in displaying Nial definitions.  It is used to define defedit and see.  The argument to descan may also include tokens indicating the beginning of new lines and controlling indentation used to display a structured definition.
</p>
</div>

<div id="outline-container-sec-78-1" class="outline-3">
<h3 id="sec-78-1"><span class="section-number-3">78.1</span> Equations</h3>
<div class="outline-text-3" id="text-78-1">
<div class="org-src-container">

<pre class="src src-nial">S a <span style="color: #ffffff; font-weight: bold;">string</span> of Nial text ==&gt; <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">scan</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">scan</span> S
S a <span style="color: #ffffff; font-weight: bold;">string</span> of Nial text ==&gt; canonical canonical S <span style="color: #ff00ff; font-weight: bold;">=</span> canonical S
S a <span style="color: #ffffff; font-weight: bold;">string</span> of Nial text ==&gt; <span style="color: #ffffff; font-weight: bold;">execute</span> canonical S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> S
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-79" class="outline-2">
<h2 id="sec-79"><span class="section-number-2">79</span> <code>diagram</code></h2>
<div class="outline-text-2" id="text-79">

<p>
The operation <a href="#sec-79">79</a> computes a character table that gives the fully boxed picture of A with the decoration of the atoms determined by the current setting of the decor switch.  An array is displayed as a frame with cells for each item.  It is arranged in two dimensions, using groupings of table frames to picture arrays of higher dimension.  Each cell is large enough to hold the diagram of the corresponding item of A.
</p>

<p>
The diagram of an atom is a picture that indicates its value.  The diagram of a non-atomic single has an "o" in its upper left corner.
</p>

<p>
Diagram returns the display given by the operation <a href="#sec-220">220</a> when in diagram mode of display.
</p>

<p>
The decor or nodecor mode switch controls the display of atoms.  With decor set, it gives a picture that distinguishes all atoms.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>;
A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">diagram</span> (2 3 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> 3 <span style="color: #00ff00;">'abc'</span> (2 1 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 3) <span style="color: #ffaf00;">"apple</span> 8.5
     (3 4));
<span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"nodecor</span>; A
</pre>
</div>
<pre class="example">
+---+----------+  +---+----------+
|  3|+--+--+--+|  |  3|+--+--+--+|
|   ||`a|`b|`c||  |   ||`a|`b|`c||
|   |+--+--+--+|  |   |+--+--+--+|
+---+----------+  +---+----------+
|+-+|"apple    |  |+-+|"apple    |
||1||          |  ||1||          |
|+-+|          |  |+-+|          |
||2||          |  ||2||          |
|+-+|          |  |+-+|          |
+---+----------+  +---+----------+
|8.5|+-+-+     |  |8.5|+-+-+     |
|   ||3|4|     |  |   ||3|4|     |
|   |+-+-+     |  |   |+-+-+     |
+---+----------+  +---+----------+
</pre>

<p>
The display of the result of a picture operation, such as diagram, makes sense when it itself is pictured in sketch-nodecor mode.  In other modes, the characters making up the table would be boxed and/or decorated.
</p>
</div>

<div id="outline-container-sec-79-1" class="outline-3">
<h3 id="sec-79-1"><span class="section-number-3">79.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-79-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">diagram</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   Old_setting <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ;
   Result <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">picture</span> A ;
   <span style="color: #ffffff; font-weight: bold;">set</span> Old_setting ;
   Result }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-80" class="outline-2">
<h2 id="sec-80"><span class="section-number-2">80</span> dimensions&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-80">

<p>
The number of axes of an array is referred to as its dimensionality.  In array theory terminology the dimensionality is called the valence of the array.  The following terms describe arrays by their valence:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Valence</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="left">single</td>
</tr>

<tr>
<td class="right">1</td>
<td class="left">list, vector</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">table, matrix</td>
</tr>

<tr>
<td class="right">2 or more</td>
<td class="left">multivalent</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-81" class="outline-2">
<h2 id="sec-81"><span class="section-number-2">81</span> <code>display</code></h2>
<div class="outline-text-2" id="text-81">

<p>
The operation <a href="#sec-81">81</a> returns a string which, when executed, returns the value A.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>; <span style="color: #ffffff; font-weight: bold;">display</span> 23.5
</pre>
</div>
<pre class="example">
'23.5'
</pre>

<p>
Display inserts the operation to construct values that cannot be described directly by constants.  In the example below, since the phrase containing a blank character cannot be specified simply using the phrase mark, display inserts the operation phrase and the string that will create the desired phrase An answer.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">display</span> <span style="color: #ffaf00;">"Nm</span> (<span style="color: #ffffff; font-weight: bold;">phrase</span> <span style="color: #00ff00;">'An answer'</span>) <span style="color: #00ff00;">'Nm'</span>
</pre>
</div>
<pre class="example">
'["Nm,(phrase 'An answer'),'Nm']'
</pre>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> <span style="color: #ffaf00;">"Name</span> (2 3 (4 5) <span style="color: #00ff00;">'Queen''s'</span> (3 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 6))
</pre>
</div>
<pre class="example">
+-----+-----------------------+
|"Name|+-+-+---+---------+---+|
|     ||2|3|4 5|'Queen's'|1 2||
|     || | |   |         |3 4||
|     || | |   |         |5 6||
|     |+-+-+---+---------+---+|
+-----+-----------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">display</span> X
</pre>
</div>
<pre class="example">
'["Name,[2,3,4 5,'Queen''s',3 2 reshape 1 2 3 4 5 6]]'
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #ffffff; font-weight: bold;">display</span> X <span style="color: #ff00ff; font-weight: bold;">=</span> X
</pre>
</div>
<pre class="example">
l
</pre>

<p>
In the definition of X, strand notation was used.  In the display of X, brackets notation is created to represent X.  The display is seen to be correct by the last example that shows that the execute of the display of X is X.
</p>
</div>

<div id="outline-container-sec-81-1" class="outline-3">
<h3 id="sec-81-1"><span class="section-number-3">81.1</span> Equation</h3>
<div class="outline-text-3" id="text-81-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #ffffff; font-weight: bold;">display</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-82" class="outline-2">
<h2 id="sec-82"><span class="section-number-2">82</span> <code>diverse</code></h2>
<div class="outline-text-2" id="text-82">

<p>
The operation <a href="#sec-82">82</a> tests whether or not the items of A are all different.  It returns true if they are and false if they are not.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">diverse</span> 2 3 5
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">diverse</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">diverse</span> 2 3 (2 3)
</pre>
</div>
<pre class="example">
l
</pre>


<p>
In the last example, the items are all different because the last item is a pair of items (2 3) which is not the same as 2 or 3.
</p>
</div>

<div id="outline-container-sec-82-1" class="outline-3">
<h3 id="sec-82-1"><span class="section-number-3">82.1</span> Definition</h3>
<div class="outline-text-3" id="text-82-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">diverse</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">cull</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-82-2" class="outline-3">
<h3 id="sec-82-2"><span class="section-number-3">82.2</span> Pragmatics</h3>
<div class="outline-text-3" id="text-82-2">
<p>
The operation <a href="#sec-82">82</a> executes faster when a large array has been sorted, hence it is better to use sortup to order a large array prior to applying diverse.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-83" class="outline-2">
<h2 id="sec-83"><span class="section-number-2">83</span> <code>divide</code></h2>
<div class="outline-text-2" id="text-83">

<p>
The operation <a href="#sec-83">83</a> returns the result of dividing two numeric atoms.  It coerces the type of the atoms to be real and gives a real number result.  If B is a numeric zero, the result is the fault ?div.
</p>

<p>
If one argument is numeric and the other is a fault or if both arguments are the same fault, the answer is the fault.  In all other cases when one or more of the arguments is not numeric, the result is the arithmetic fault ?A.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> 1 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1 2 2.5 `a "abc ??error
</pre>



<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">outer</span> <span style="color: #ffffff; font-weight: bold;">divide</span> R
</pre>
</div>
<pre class="example">
    1.    0.5    0.4 ?A     ?A     ?error
    2.     1.    0.8 ?A     ?A     ?error
   2.5   1.25     1. ?A     ?A     ?error
?A     ?A     ?A     ?A     ?A     ?error
?A     ?A     ?A     ?A     ?A     ?error
?error ?error ?error ?error ?error ?error
</pre>

<p>
The above example illustrates all combinations of atom types for the two arguments to divide.
</p>
</div>

<div id="outline-container-sec-83-1" class="outline-3">
<h3 id="sec-83-1"><span class="section-number-3">83.1</span> Equations</h3>
<div class="outline-text-3" id="text-83-1">
<div class="org-src-container">

<pre class="src src-nial">1.0 <span style="color: #ffffff; font-weight: bold;">divide</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> A
A <span style="color: #ffffff; font-weight: bold;">divide</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">times</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> B (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-84" class="outline-2">
<h2 id="sec-84"><span class="section-number-2">84</span> <code>dlllist</code></h2>
<div class="outline-text-2" id="text-84">

<p>
The expression Dlllist provides a list of the current routines that have been registered.
</p>
</div>
</div>

<div id="outline-container-sec-85" class="outline-2">
<h2 id="sec-85"><span class="section-number-2">85</span> <code>DOWN</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-85">

<p>
<i>=DOWN=</i> is a general transformer that recurs over the depth of an array to some arbitrary level.  DOWN has four operation arguments: test tests when the recursion has gone as deep as necessary, endf is applied to the argument that satisfies test, structf rearranges the argument before recurring on each item, and joinf combines the results of the recursion on the items.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">atomic</span>, 0 <span style="color: #ffffff; font-weight: bold;">minus</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>]  3 -4 (5 6)
</pre>
</div>
<pre class="example">
+--+-+-----+
|-3|4|-5 -6|
+--+-+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">simple</span>, dosum, <span style="color: #ffffff; font-weight: bold;">pack</span>, <span style="color: #ffffff; font-weight: bold;">pass</span> ] 3 4 5 6
</pre>
</div>
<pre class="example">
18
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">atomic</span>, 0 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, 1 <span style="color: #ffffff; font-weight: bold;">plus</span> <span style="color: #ffffff; font-weight: bold;">max</span> ] [2, [3, 4, [5],8],24]
</pre>
</div>
<pre class="example">
3
</pre>
</div>

<div id="outline-container-sec-85-1" class="outline-3">
<h3 id="sec-85-1"><span class="section-number-3">85.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-85-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">DOWN</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> test endf structf joinf <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   Candidates <span style="color: #ff00ff;">:=</span> [A];
   Results <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>;
   <span style="color: #00ffff;">WHILE</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> Candidates <span style="color: #00ffff;">DO</span>
      Candidates B <span style="color: #ff00ff;">:=</span> [<span style="color: #ffffff; font-weight: bold;">front</span>, <span style="color: #ffffff; font-weight: bold;">last</span>] Candidates;
      <span style="color: #00ffff;">IF</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffaf00;">"Start</span> <span style="color: #00ffff;">THEN</span>
         Candidates Shp <span style="color: #ff00ff;">:=</span> [<span style="color: #ffffff; font-weight: bold;">front</span>, <span style="color: #ffffff; font-weight: bold;">last</span>] Candidates;
         N <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">prod</span> Shp;
         <span style="color: #00ffff;">IF</span> N <span style="color: #ff00ff; font-weight: bold;">=</span> 0 <span style="color: #00ffff;">THEN</span> N <span style="color: #ff00ff;">:=</span> N <span style="color: #ff00ff; font-weight: bold;">+</span> 1; <span style="color: #00ffff;">ENDIF</span>;
         Results Items <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> N [<span style="color: #ffffff; font-weight: bold;">drop</span>, <span style="color: #ffffff; font-weight: bold;">take</span>] Results;
         Results <span style="color: #ff00ff;">:=</span> Results <span style="color: #ffffff; font-weight: bold;">append</span> joinf (Shp <span style="color: #ffffff; font-weight: bold;">reshape</span> Items);
      <span style="color: #00ffff;">ELSEIF</span> test B <span style="color: #00ffff;">THEN</span>
         Results <span style="color: #ff00ff;">:=</span> results <span style="color: #ffffff; font-weight: bold;">append</span> endf B;
      <span style="color: #00ffff;">ELSE</span>
         B <span style="color: #ff00ff;">:=</span> structf B;
         Candidates <span style="color: #ff00ff;">:=</span> Candidates <span style="color: #ffffff; font-weight: bold;">link</span> [<span style="color: #ffffff; font-weight: bold;">shape</span> B, <span style="color: #ffaf00;">"Start</span>] <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">list</span> B;
         <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> B <span style="color: #00ffff;">THEN</span> Candidates <span style="color: #ff00ff;">:=</span> Candidates <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #ffffff; font-weight: bold;">first</span> B; <span style="color: #00ffff;">ENDIF</span>;
      <span style="color: #00ffff;">ENDIF</span>;
   <span style="color: #00ffff;">ENDWHILE</span>;
   <span style="color: #ffffff; font-weight: bold;">first</span> Results }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-85-2" class="outline-3">
<h3 id="sec-85-2"><span class="section-number-3">85.2</span> Equations</h3>
<div class="outline-text-3" id="text-85-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">DOWN</span> [test, endf, structf, joinf ] A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">FORK</span> [test, endf, joinf <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">DOWN</span> [test, endf, structf, joinf] structf ] A
<span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">atomic</span>, 0 <span style="color: #ffffff; font-weight: bold;">minus</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>] A
<span style="color: #ffffff; font-weight: bold;">sum</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">simple</span>, dosum, <span style="color: #ffffff; font-weight: bold;">pack</span>, <span style="color: #ffffff; font-weight: bold;">pass</span> ] A
<span style="color: #ffffff; font-weight: bold;">depth</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">DOWN</span> [ <span style="color: #ffffff; font-weight: bold;">atomic</span>, 0 <span style="color: #ffffff; font-weight: bold;">minus</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>] A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-86" class="outline-2">
<h2 id="sec-86"><span class="section-number-2">86</span> <code>drop</code></h2>
<div class="outline-text-2" id="text-86">

<p>
The operation <a href="#sec-86">86</a> selects the items of an array after a specified number of items have been dropped.  If B is a list and A is a non-negative integer, the result is the list formed from dropping A items from the front of B.  If A is a negative integer, the result is formed by dropping abs A items from the right end of B.
</p>

<p>
If B is a table and A is a pair of non-negative integers, the result is lower right corner of B that remains after dropping the number of rows and columns indicated by A from the upper left corner of B.  If one or both items of A are negative, the dropping occurs from the other end of the extent of the corresponding axis.
</p>

<p>
For a higher dimensional array B, tally A must equal valence B; and the result is obtained by dropping from the front or back of the extents along each axis.  If B is a single and product A is zero, the result is B; otherwise the result is an empty array with valence of tally A.
</p>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffaf00;">"Able</span> <span style="color: #ffaf00;">"Baker</span> <span style="color: #ffaf00;">"Charlie</span> <span style="color: #ffaf00;">"Dog</span>
</pre>
</div>
<pre class="example">
Charlie Dog
</pre>



<div class="org-src-container">

<pre class="src src-nial">T1 <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 4
</pre>
</div>
<pre class="example">
+---+---+---+---+
|0 0|0 1|0 2|0 3|
+---+---+---+---+
|1 0|1 1|1 2|1 3|
+---+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">1 2 <span style="color: #ffffff; font-weight: bold;">drop</span> T1
</pre>
</div>
<pre class="example">
+---+---+
|1 2|1 3|
+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">1 -2 <span style="color: #ffffff; font-weight: bold;">drop</span> T1
</pre>
</div>
<pre class="example">
+---+---+
|1 0|1 1|
+---+---+
</pre>
</div>

<div id="outline-container-sec-86-1" class="outline-3">
<h3 id="sec-86-1"><span class="section-number-3">86.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-86-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> A <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?left arg of drop must be integers'</span>
   <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">valence</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> 0 <span style="color: #00ffff;">THEN</span>
      <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">product</span> A <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 0 <span style="color: #00ffff;">THEN</span>
         (<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> 0) <span style="color: #ffffff; font-weight: bold;">reshape</span> B
      <span style="color: #00ffff;">ELSE</span>
         B
      <span style="color: #00ffff;">ENDIF</span>
   <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">~=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> B <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?valence error in drop'</span>
   <span style="color: #00ffff;">ELSE</span>
      ((A <span style="color: #ff00ff; font-weight: bold;">&lt;</span> 0) <span style="color: #ff00ff; font-weight: bold;">+</span> (-1 <span style="color: #ff00ff; font-weight: bold;">*</span> (A <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> 0) )) <span style="color: #ff00ff; font-weight: bold;">*</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> B <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ffffff; font-weight: bold;">max</span> 0) <span style="color: #ffffff; font-weight: bold;">take</span> B
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-86-2" class="outline-3">
<h3 id="sec-86-2"><span class="section-number-3">86.2</span> Equations</h3>
<div class="outline-text-3" id="text-86-2">
<div class="org-src-container">

<pre class="src src-nial">0 <span style="color: #ffffff; font-weight: bold;">times</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B <span style="color: #ffffff; font-weight: bold;">drop</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B
<span style="color: #ffffff; font-weight: bold;">tally</span> B <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-87" class="outline-2">
<h2 id="sec-87"><span class="section-number-2">87</span> <del>dropright</del></h2>
<div class="outline-text-2" id="text-87">

<p>
The operation <i>=dropright=</i> is an obsolete operation that drops items from the ends of extents. It is provided to retain compatibility with earlier versions of Q'Nial.
</p>
</div>

<div id="outline-container-sec-87-1" class="outline-3">
<h3 id="sec-87-1"><span class="section-number-3">87.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-87-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">dropright</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ffffff; font-weight: bold;">drop</span> B }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-88" class="outline-2">
<h2 id="sec-88"><span class="section-number-2">88</span> <code>EACH</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-88">

<p>
The transformer <i>=EACH=</i> forms an operation, called the <i>=EACH=</i> transform of f, that applies f to every item of the argument A.  The shape of the result of the application of <i>=EACH=</i> f to A is the same shape as A.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> (<span style="color: #00ff00;">'abc'</span> <span style="color: #00ff00;">'def'</span> <span style="color: #00ff00;">'ghi'</span>)
</pre>
</div>
<pre class="example">
+---+---+---+
|cba|fed|ihg|
+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
0 0 0 0
1 1 1 1
2 2 2 2
</pre>

<p>
<i>=EACH=</i> is used to distribute an operation f across an entire array A. Its use avoids the need to explicitly allocate space for the result and to write an explicit loop to apply f to each item of A individually.
</p>
</div>

<div id="outline-container-sec-88-1" class="outline-3">
<h3 id="sec-88-1"><span class="section-number-3">88.1</span> Equations</h3>
<div class="outline-text-3" id="text-88-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">EACH</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (<span style="color: #ffff00;">EACH</span> f A) <span style="color: #ff00ff; font-weight: bold;">=</span> f (I <span style="color: #ffffff; font-weight: bold;">pick</span> A)
(<span style="color: #ffff00;">EACH</span> f) (<span style="color: #ffff00;">EACH</span> g) A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> (f g) A
<span style="color: #ffff00;">EACH</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (f <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">rest</span> A)
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> f A
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> f A
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffff00;">EACH</span> f A
isshape A ==&gt; <span style="color: #ffff00;">EACH</span> f (A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffff00;">EACH</span> f B
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f A
<span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-89" class="outline-2">
<h2 id="sec-89"><span class="section-number-2">89</span> <code>EACHALL</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-89">

<p>
The transformer <i>=EACHALL=</i> forms an operation which applies f to arrays formed by selecting the items of the items of A in corresponding positions, assuming that the items of A are all of the same shape.
</p>

<p>
When the items of A are not all the same shape, A is examined to see if all the items with tally greater than one have the same shape.  If so, all the items of tally 1 are replicated to that shape.  If not, the fault ?conform is returned.  <i>=EACHALL=</i> is implicitly applied in multi pervasive operations.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 9 [2] (4 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> (5+tell 16))
</pre>
</div>
<pre class="example">
+-+-+-----------+
|9|2| 5  6  7  8|
| | | 9 10 11 12|
| | |13 14 15 16|
| | |17 18 19 20|
+-+-+-----------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> A
</pre>
</div>
<pre class="example">
+------+------+------+------+
|9 2 5 |9 2 6 |9 2 7 |9 2 8 |
+------+------+------+------+
|9 2 9 |9 2 10|9 2 11|9 2 12|
+------+------+------+------+
|9 2 13|9 2 14|9 2 15|9 2 16|
+------+------+------+------+
|9 2 17|9 2 18|9 2 19|9 2 20|
+------+------+------+------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">sum</span>) <span style="color: #ffffff; font-weight: bold;">pack</span> A
</pre>
</div>
<pre class="example">
16 17 18 19
20 21 22 23
24 25 26 27
28 29 30 31
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACHALL</span> <span style="color: #ffffff; font-weight: bold;">sum</span> A
</pre>
</div>
<pre class="example">
16 17 18 19
20 21 22 23
24 25 26 27
28 29 30 31
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> A
</pre>
</div>
<pre class="example">
16 17 18 19
20 21 22 23
24 25 26 27
28 29 30 31
</pre>

<p>
The example shows that <i>=EACHALL=</i> is defined in terms of pack and is implicitly used in the multi pervasive operation <a href="#sec-315">315</a>.
</p>
</div>

<div id="outline-container-sec-89-1" class="outline-3">
<h3 id="sec-89-1"><span class="section-number-3">89.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-89-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACHALL</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">pack</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-89-2" class="outline-3">
<h3 id="sec-89-2"><span class="section-number-3">89.2</span> Equations</h3>
<div class="outline-text-3" id="text-89-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">EACHALL</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (<span style="color: #ffff00;">EACHALL</span> f A) <span style="color: #ff00ff; font-weight: bold;">=</span> f (I <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-90" class="outline-2">
<h2 id="sec-90"><span class="section-number-2">90</span> <code>EACHBOTH</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-90">

<p>
The transformer <i>=EACHBOTH=</i> forms an operation which applies f to pairs formed by selecting the items of A and B in corresponding positions, assuming that A and B have the same shape.
</p>

<p>
When A and B do not have the same shape, if either A or B has only one item, that item is replicated to the shape of the other argument; otherwise, the fault ?conform is returned.
</p>

<p>
<i>=EACHBOTH=</i> is used implicitly in all binary pervasive operations.
</p>

<div class="org-src-container">

<pre class="src src-nial">7 2 1 <span style="color: #ffff00;">EACHBOTH</span> <span style="color: #ffffff; font-weight: bold;">post</span> 4 5 3
</pre>
</div>
<pre class="example">
+-+-+-+
|7|2|1|
|4|5|3|
+-+-+-+
</pre>
</div>

<div id="outline-container-sec-90-1" class="outline-3">
<h3 id="sec-90-1"><span class="section-number-3">90.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-90-1">
<div class="org-src-container">

<pre class="src src-nial">:     <span style="color: #ffff00;">EACHBOTH</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffff00;">EACHALL</span> f A B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-90-2" class="outline-3">
<h3 id="sec-90-2"><span class="section-number-3">90.2</span> Equations</h3>
<div class="outline-text-3" id="text-90-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffff00;">EACHBOTH</span> f B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffffff; font-weight: bold;">pack</span> B)
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A B ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (A <span style="color: #ffff00;">EACHBOTH</span> f B) <span style="color: #ff00ff; font-weight: bold;">=</span> f (I <span style="color: #ffffff; font-weight: bold;">pick</span> (A <span style="color: #ffffff; font-weight: bold;">pack</span> B))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-91" class="outline-2">
<h2 id="sec-91"><span class="section-number-2">91</span> <code>EACHLEFT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-91">

<p>
The transformer <i>=EACHLEFT=</i> forms an operation which applies f to pairs formed by pairing the items of A with B.  The shape of the result is the shape of A.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 4 <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> 5
</pre>
</div>
<pre class="example">
+---+-----+-------+
|5 5|5 5 5|5 5 5 5|
+---+-----+-------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">(2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'abcdef'</span>) <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #00ff00;">'123'</span>
</pre>
</div>

<pre class="example">
+----+----+----+
|a123|b123|c123|
+----+----+----+
|d123|e123|f123|
+----+----+----+
</pre>
</div>

<div id="outline-container-sec-91-1" class="outline-3">
<h3 id="sec-91-1"><span class="section-number-3">91.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-91-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACHLEFT</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffff00;">EACH</span> (B <span style="color: #ffff00;">CONVERSE</span> f) A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-91-2" class="outline-3">
<h3 id="sec-91-2"><span class="section-number-3">91.2</span> Equations</h3>
<div class="outline-text-3" id="text-91-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> ( A <span style="color: #ffff00;">EACHLEFT</span> f B ) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (A <span style="color: #ffff00;">EACHLEFT</span> f B) <span style="color: #ff00ff; font-weight: bold;">=</span> f (I <span style="color: #ffffff; font-weight: bold;">pick</span> A) B
A <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffff00;">EACHBOTH</span> f <span style="color: #ffffff; font-weight: bold;">single</span> B
<span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> (A f B)
<span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> (A f B)
<span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ffff00;">EACHLEFT</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffff00;">EACHLEFT</span> f B)
isshape S ==&gt; (S <span style="color: #ffffff; font-weight: bold;">reshape</span> A) <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> S <span style="color: #ffffff; font-weight: bold;">reshape</span> (A <span style="color: #ffff00;">EACHLEFT</span> f B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-92" class="outline-2">
<h2 id="sec-92"><span class="section-number-2">92</span> <code>EACHRIGHT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-92">

<p>
The transformer <i>=EACHRIGHT=</i> forms an operation which applies f to pairs formed by pairing A with the items of B.  The shape of the result is the shape of B.
</p>
<pre class="example">
    2 EACHRIGHT reshape 3 4 5
+---+---+---+
|3 3|4 4|5 5|
+---+---+---+
</pre>

<pre class="example">
    `X EACHRIGHT hitch (2 3 reshape 'ab' 'cd')
+---+---+---+
|Xab|Xcd|Xab|
+---+---+---+
|Xcd|Xab|Xcd|
+---+---+---+
</pre>
</div>

<div id="outline-container-sec-92-1" class="outline-3">
<h3 id="sec-92-1"><span class="section-number-3">92.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-92-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffff00;">EACH</span> ( A f ) B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-92-2" class="outline-3">
<h3 id="sec-92-2"><span class="section-number-3">92.2</span> Equations</h3>
<div class="outline-text-3" id="text-92-2">
<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> B ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (A <span style="color: #ffff00;">EACHRIGHT</span> f B) <span style="color: #ff00ff; font-weight: bold;">=</span> f A (I <span style="color: #ffffff; font-weight: bold;">pick</span> B)
<span style="color: #ffffff; font-weight: bold;">shape</span> ( A <span style="color: #ffff00;">EACHRIGHT</span> f B ) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B
A <span style="color: #ffff00;">EACHRIGHT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ffff00;">EACHBOTH</span> f B
A <span style="color: #ffff00;">EACHRIGHT</span> f <span style="color: #ffffff; font-weight: bold;">single</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> (A f B)
A <span style="color: #ffff00;">EACHRIGHT</span> f <span style="color: #ffffff; font-weight: bold;">solitary</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> (A f B)
A <span style="color: #ffff00;">EACHRIGHT</span> f <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span>(A <span style="color: #ffff00;">EACHRIGHT</span> fB)
isshape S ==&gt; A <span style="color: #ffff00;">EACHRIGHT</span> f (S <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> S <span style="color: #ffffff; font-weight: bold;">reshape</span> (A <span style="color: #ffff00;">EACHRIGHT</span> f B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-93" class="outline-2">
<h2 id="sec-93"><span class="section-number-2">93</span> <code>edit</code></h2>
<div class="outline-text-2" id="text-93">

<p>
The operation <a href="#sec-93">93</a> passes control to the standard editor, requesting it to edit the file named by the string or phrase Filename.  The editor used is determined by the environment variable EDITOR or by a default chosen for each version.  When the editing task is completed, the editor returns control to Q'Nial.  The result is the fault ?noexpr.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">edit</span> <span style="color: #ffaf00;">"test</span>.ndf
<span style="color: #ffffff; font-weight: bold;">edit</span> <span style="color: #00ff00;">'data_records'</span>
</pre>
</div>

<p>
If edit is used to edit a file of Nial definitions, the operation <a href="#sec-174">174</a> must be executed on return from the editor to load the definitions.
</p>
</div>
</div>

<div id="outline-container-sec-94" class="outline-2">
<h2 id="sec-94"><span class="section-number-2">94</span> <code>empty</code></h2>
<div class="outline-text-2" id="text-94">

<p>
The operation <a href="#sec-94">94</a> tests whether or not an array A has any items.  If A has no items, it returns true; otherwise, false.  The predefined expression Null is empty as is any array with a zero in its shape.
</p>

<p>
Since there are empty arrays with more than one dimension, it is better to test for an empty array by using empty rather than by direct comparison with <i>=Null=</i>.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">empty</span> (0 3 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> 5)
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> 5
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
o
</pre>


<p>
The last two examples show that a solitary is not empty even if the item it contains is empty.
</p>
</div>

<div id="outline-container-sec-94-1" class="outline-3">
<h3 id="sec-94-1"><span class="section-number-3">94.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-94-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 0 }
</pre>
</div>

<p>
Equation
   empty A = 0 in shape A
</p>
</div>
</div>
</div>

<div id="outline-container-sec-95" class="outline-2">
<h2 id="sec-95"><span class="section-number-2">95</span> <code>equal</code></h2>
<div class="outline-text-2" id="text-95">

<p>
The operation <a href="#sec-95">95</a> is normally used to compare two arrays A and B to see whether or not they are identical.  It returns true if they are equal; false otherwise.  (Two nonempty arrays are identical if they have identical shapes and hold identical items at each location.  Two empty arrays are identical if they have identical shapes.) Empty is extended to arbitrary arrays by returning true if all items of an array are identical.
</p>

<p>
The symbol = is a synonym for <a href="#sec-95">95</a> and can be used in both infix and prefix application.  In the Equations sections of the dictionary entries,
&lt;snial the symbol = is used to separate two sides of an equation.  To test such an equation, it may be necessary to replace the expression following = with the same expression in parentheses in order to force correct parsing of the equation as a Nial expression.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 4 <span style="color: #ff00ff; font-weight: bold;">=</span> [2,3,4]
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 (3 4) <span style="color: #ff00ff; font-weight: bold;">=</span> (2 3) 4
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3 4
</pre>
</div>
<pre class="example">
l
</pre>


<p>
The first example shows that a triple formed using strand notation is identical to that formed using brackets notation.  The second shows that <i>=Null=</i> is equal to the empty string.  The third shows that grouping items of a list in different ways creates different arrays.  The last shows the convenience of the more general form of <a href="#sec-95">95</a>.
</p>
</div>

<div id="outline-container-sec-95-1" class="outline-3">
<h3 id="sec-95-1"><span class="section-number-3">95.1</span> Equations</h3>
<div class="outline-text-3" id="text-95-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">equal</span> B &lt;==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B
A <span style="color: #ffffff; font-weight: bold;">equal</span> B <span style="color: #ffffff; font-weight: bold;">and</span> (I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A) ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> I <span style="color: #ffffff; font-weight: bold;">pick</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-96" class="outline-2">
<h2 id="sec-96"><span class="section-number-2">96</span> equations</h2>
<div class="outline-text-2" id="text-96">

<p>
The equations in the Nial Dictionary and in the on-line help provide an abbreviated way of stating properties of the term or object being described.  They could be expanded into an explanation in English but that would lengthen the manual considerably.
</p>

<p>
The equations use variables such as A, B and C that take on array values; and variables such as f, g and h that denote operations that map arrays to arrays.  An equation holds for all arrays and for all computable operations without side effects, unless a specific qualification is made.  Thus, the equation:
</p>

<p>
(EACH f) (EACH g) A = EACH (f g) A
</p>

<p>
says that for all operations f and g and all arrays A, the use of the EACH transform of f on the result of the use of the EACH transform of g on A has the same value as the use of the EACH transform of the composition of f and g on A.  In mathematical terms, the EACH transformer distributes over operation composition.
</p>

<p>
The symbol = is used in its mathematical sense in equations and separates two Nial expressions.  The symbol = has higher precedence than the two expressions it is separating.  Where the Nial equivalent to = is needed to state the equation, the term equal is used.
</p>

<p>
To test an equation using Q'Nial, in order to force the correct parsing of the equation as a Nial expression, it may be necessary to replace
</p>

<div class="org-src-container">

<pre class="src src-nial">Expr1 <span style="color: #ff00ff; font-weight: bold;">=</span> Expr2
</pre>
</div>
<pre class="example">
</pre>

<p>
with
</p>

<div class="org-src-container">

<pre class="src src-nial">Expr1 <span style="color: #ff00ff; font-weight: bold;">=</span> ( Expr2 )
</pre>
</div>
<pre class="example">
</pre>

<p>
The equality used in equations assumes that both sides of the equations compute without triggering a fault and produce equal arrays; or both produce the same fault value if fault triggering is off.  In some cases, the equality is inexact due to roundoff errors.
</p>

<p>
The symbol <code>f</code> is used to denote an equality where both sides produce the same non-fault value; but in some cases one or both of the sides may fault and the equality is no longer valid.
</p>

<p>
Some of the equations are qualified by a constraint on the variables.  The constraint is written in English or as a conditional expression in Nial that must hold for the equation to be true.  In a statement of the form
</p>

<div class="org-src-container">

<pre class="src src-nial">Expr ==&gt; Eqn
</pre>
</div>
<pre class="example">
</pre>

<p>
Expr is the qualification written as a Nial boolean expression, the symbol ==&gt; is used for "implies", and Eqn is the equation that holds under the qualification.
</p>

<p>
The symbol &lt;==&gt; denotes an if and only if implication.  Thus a statement of the form
</p>

<div class="org-src-container">

<pre class="src src-nial">Expr1 &lt;==&gt; Expr2
</pre>
</div>
<pre class="example">
</pre>

<p>
states that both expressions have the same truth value; either both are true or both are false.
</p>

<p>
Reading the Equations
</p>

<p>
The equations related to <a href="#sec-1">1</a>, the operation that finds the absolute value of a number, are:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">abs</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A
</pre>
</div>

<p>
The first two come from the property that abs is unary pervasive.  The first one says that applying abs to an array A is the same as applying abs to the items of array A.  It also implies that the shape of the result of abs A is the same as shape of A since EACH transforms always preserve shape.  The second equation says that the shape of the result of abs A is the same as the shape of A.  The third equation indicates that subsequent applications of abs after the first do not change the result.
</p>

<p>
The equations related to minus, denoted by -, are:
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff; font-weight: bold;">-</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A B
<span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ff00ff; font-weight: bold;">-</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A B
A <span style="color: #ff00ff; font-weight: bold;">-</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> B
</pre>
</div>

<p>
The first equation says that pair of arrays A and B are packed at each level of nesting to bring corresponding items together.  Then, the items are subtracted.
</p>

<p>
The second equation states that the shape of the result of subtracting A from B is the shape formed by packing A and B.  The third equation states that subtracting A from B is equivalent to adding the opposite of B to A.
</p>

<p>
The equations related to hitch are as follows:
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">hitch</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">list</span> B
<span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">hitch</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> B
</pre>
</div>

<p>
The first says that hitch treats its right argument as though it were a list, and the second states that the result of hitch is a list.
</p>

<p>
The following equations illustrate the use of qualifications:
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">diverse</span> A &lt;==&gt; <span style="color: #ffffff; font-weight: bold;">cull</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
</pre>
</div>

<p>
The first equation says that if A is atomic, the single of A is equal to A.  That is, the single of an atom is the atom.  The second equation says that if A is not empty, forming the rows of A and applying mix to recombine them, results in the original array.  The third equation says that if A is diverse, the cull of A is equal to the list of A; and that if A is not diverse, the cull of A is not equal to the list of A.
</p>

<p>
There are many identities that hold for all arrays in Nial.  The equations are shown in the on-line help for each topic.  Three general equations are the following:
</p>

<p>
A <a href="#sec-346">346</a> operation f satisfies the equation:
</p>
<div class="org-src-container">

<pre class="src src-nial">f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> f A
</pre>
</div>


<p>
A <a href="#sec-27">27</a> operation f satisfies the equation:
</p>
<div class="org-src-container">

<pre class="src src-nial">A f B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffff00;">EACHBOTH</span> f B
</pre>
</div>

<p>
A <a href="#sec-189">189</a> operation f satisfies the equations:
</p>
<div class="org-src-container">

<pre class="src src-nial">f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACHALL</span> f A
f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">REDUCE</span> f A
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-97" class="outline-2">
<h2 id="sec-97"><span class="section-number-2">97</span> <span class="todo TODO">TODO</span> <code>erase</code></h2>
<div class="outline-text-2" id="text-97">
<p>
:Class:  system operation
:Usage:  erase Nm
:SeeAlso: symbols
:END:
</p>

<p>
The operation erase is used to remove unwanted global definitions and variables from the workspace.  The argument Nm must be a phrase or string giving the object to be removed.  Predefined names and names in local scopes cannot be removed.
</p>

<p>
When a name has been erased, it remains in the symbol table with its original role.  It can be redefined in the same role or, if a variable, reassigned a value by a subsequent action.  A name cannot change its role once established.
</p>

<div class="org-src-container">

<pre class="src src-nial">average <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">divide</span>[<span style="color: #ffffff; font-weight: bold;">sum</span>,<span style="color: #ffffff; font-weight: bold;">tally</span>];
calc <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">EACH</span> average;
Var3 <span style="color: #ff00ff;">:=</span> calc (2 3 4) (5 6 7)
</pre>
</div>
<pre class="example">
3. 6.
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">erase</span> <span style="color: #ffaf00;">"average</span> <span style="color: #00ff00;">'Var3'</span> <span style="color: #ffaf00;">"sum</span>
</pre>
</div>
<pre class="example">
: ?noexpr ?noexpr ?system name
</pre>


<p>
In the example above, the operation sum cannot be erased as it is a predefined operation.  In the next three examples below, faults are returned because of missing variables or operations that were erased.  The effect of erasing an object is not propagated to other definitions referring to the erased name.
</p>

<div class="org-src-container">

<pre class="src src-nial">Var3
</pre>
</div>
<pre class="example">
?no_value
</pre>



<div class="org-src-container">

<pre class="src src-nial">average <span style="color: #ffffff; font-weight: bold;">count</span> 10
</pre>
</div>
<pre class="example">
?missing_op
</pre>



<div class="org-src-container">

<pre class="src src-nial">calc (2 3 4) (5 6 7)
</pre>
</div>
<pre class="example">
?missing_op ?missing_op
</pre>



<div class="org-src-container">

<pre class="src src-nial">average <span style="color: #ff00ff;">:=</span> 5 6 7
</pre>
</div>
<pre class="example">
?invalid assignment: AVERAGE :=  &lt;***&gt; 5 6
</pre>


<p>
In the last example, an attempt is made to redefine the role of average and Q'Nial indicated that average is not a suitable name for such an assignment.
</p>
</div>
</div>

<div id="outline-container-sec-98" class="outline-2">
<h2 id="sec-98"><span class="section-number-2">98</span> <code>eraserecord</code></h2>
<div class="outline-text-2" id="text-98">

<p>
The operation eraserecord is used to erase component N of direct access file designated by the number Filenum.  In a file with record components, eraserecord replaces the erased component with an empty string.  In a file with array components, it replaces the erased component with the fault <code>?missing</code>.
</p>

<p>
N may be a single record number or a list of record numbers.
</p>

<p>
If the last component in a file is erased, any immediately preceding components that are empty in a record component file or contain the fault ?missing in an array component file are also removed.  The file tally, which records the number of records in the file, is adjusted accordingly.
</p>

<p>
The operation returns the fault ?noexpr or a fault indicating improper use of the operation.
</p>

<div class="org-src-container">

<pre class="src src-nial">File_num <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> <span style="color: #ffaf00;">"Names</span> <span style="color: #ffaf00;">"d</span> ;
<span style="color: #ffffff; font-weight: bold;">eraserecord</span> File_num 23 ;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-99" class="outline-2">
<h2 id="sec-99"><span class="section-number-2">99</span> <code>eval</code></h2>
<div class="outline-text-2" id="text-99">

<p>
The operation eval provides access to the underlying expression evaluator of Q'Nial.  The argument to eval must be a parse tree returned by parse or getdef, a named expression or a cast which represents a Nial expression.  The effect is to evaluate the expression and return the resulting value.  As seen below, the parse tree can be one formed by using the cast mechanism or one built explicitly using parse.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'23 + 45'</span>
</pre>
</div>
<pre class="example">
68
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">eval</span> !(23 <span style="color: #ff00ff; font-weight: bold;">+</span> 45)
</pre>
</div>
<pre class="example">
68
</pre>


<p>
The next example shows that eval can be used to evaluate a named expression using either the cast or the phrase of its name.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 100 ;
Addone <span style="color: #00ffff;">IS</span> (A <span style="color: #ff00ff;">:=</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> 1);
(<span style="color: #ffffff; font-weight: bold;">eval</span> !Addone)(<span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffaf00;">"Addone</span>)
</pre>
</div>
<pre class="example">
101 102
</pre>

<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffffff; font-weight: bold;">eval</span> !A)(<span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffaf00;">"A</span>)(<span style="color: #ffffff; font-weight: bold;">value</span> <span style="color: #ffaf00;">"A</span>)
</pre>
</div>
<pre class="example">
102 ?not an expression 102
</pre>


<p>
The last example shows that eval can be used to evaluate the cast of a variable but not a phrase naming the variable.  The operation value should be used instead.
</p>
</div>

<div id="outline-container-sec-99-1" class="outline-3">
<h3 id="sec-99-1"><span class="section-number-3">99.1</span> Equations</h3>
<div class="outline-text-3" id="text-99-1">
<div class="org-src-container">

<pre class="src src-nial">S a <span style="color: #ffffff; font-weight: bold;">string</span> holding a Nial <span style="color: #ffffff; font-weight: bold;">expression</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> S
Pt a <span style="color: #ffffff; font-weight: bold;">parse</span> tree ==&gt; <span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> Pt <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">eval</span> P
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-100" class="outline-2">
<h2 id="sec-100"><span class="section-number-2">100</span> <code>except</code></h2>
<div class="outline-text-2" id="text-100">

<p>
The operation except returns the list of items of A that are not in B.  It corresponds to set difference if A and B are viewed as set representations.  The result is a list with items in the same order as in A.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">count</span> 10 <span style="color: #ffffff; font-weight: bold;">except</span> 3 5 7
</pre>
</div>
<pre class="example">
1 2 4 6 8 9 10
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'a list of words'</span> <span style="color: #ffffff; font-weight: bold;">except</span> <span style="color: #00ff00;">'aeiou'</span>
</pre>
</div>
<pre class="example">
lst f wrds
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> 2 3 <span style="color: #ffffff; font-weight: bold;">except</span> [0 0]
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|0 1|0 2|1 0|1 1|1 2|
+---+---+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> 2 3 <span style="color: #ffffff; font-weight: bold;">except</span> (0 0)
</pre>
</div>
<pre class="example">
+---+---+---+---+---+---+
|0 0|0 1|0 2|1 0|1 1|1 2|
+---+---+---+---+---+---+
</pre>

<p>
The last two examples show that if the left argument has nonatomic items, to remove a single non-atomic array, the right argument must be made into a solitary list.  Otherwise the items of the right argument are used.
</p>
</div>

<div id="outline-container-sec-100-1" class="outline-3">
<h3 id="sec-100-1"><span class="section-number-3">100.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-100-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">except</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">notin</span> B <span style="color: #ffffff; font-weight: bold;">sublist</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-100-2" class="outline-3">
<h3 id="sec-100-2"><span class="section-number-3">100.2</span> Equations</h3>
<div class="outline-text-3" id="text-100-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">except</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">except</span> B
<span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ffffff; font-weight: bold;">except</span> <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">except</span> B
(A <span style="color: #ffffff; font-weight: bold;">except</span> B) <span style="color: #ffffff; font-weight: bold;">except</span> C <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">except</span> (B <span style="color: #ffffff; font-weight: bold;">link</span> C)
A <span style="color: #ffffff; font-weight: bold;">except</span> <span style="color: #ffffff; font-weight: bold;">cull</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">except</span> B
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-100-3" class="outline-3">
<h3 id="sec-100-3"><span class="section-number-3">100.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-100-3">
<p>
The operation except uses an internal sort on its arguments to reduce the algorithmic complexity of the above definition.  It executes considerably faster if its arguments have already been sorted.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-101" class="outline-2">
<h2 id="sec-101"><span class="section-number-2">101</span> <code>execute</code></h2>
<div class="outline-text-2" id="text-101">

<p>
The operation execute evaluates a Nial expression given as a string S.  The result of the evaluation is returned.  The execution of the string takes place in the environment where execute is applied.
</p>

<p>
If the string contains a name, the local meaning of that name will be used if a local meaning exists.  If execution of the string results in the creation of a new variable or defined name, the new object is placed in the global environment.
</p>

<p>
If a string being executed contains an integer representation that would be converted to an integer outside the range for the computer, the result is converted to the corresponding real number.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #00ff00;">'23 + 40045'</span>
</pre>
</div>
<pre class="example">
40068.
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5; opname <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'product'</span>;
<span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #ffffff; font-weight: bold;">link</span> opname <span style="color: #00ff00;">' A'</span>
</pre>
</div>
<pre class="example">
120
</pre>

<p>
The last example shows that Nial program text can be constructed under program control and then executed.  This feature is useful in applications where responses are generated by combining text elements based on the user input and the current state of the computation.  The technique is useful for applications involving computer assisted instruction and knowledge based systems.
</p>

<p>
It is more efficient to use eval to evaluate the cast of an expression than to use execute to evaluate the corresponding string.  In the former approach the scan and parse is done once, whereas in the latter it is repeated on each execution.
</p>
</div>

<div id="outline-container-sec-101-1" class="outline-3">
<h3 id="sec-101-1"><span class="section-number-3">101.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-101-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-101-2" class="outline-3">
<h3 id="sec-101-2"><span class="section-number-3">101.2</span> Equations</h3>
<div class="outline-text-3" id="text-101-2">
<div class="org-src-container">

<pre class="src src-nial"> <span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #ffffff; font-weight: bold;">readscreen</span> Prompt <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">read</span> Prompt
 Txt, a Nial <span style="color: #ffffff; font-weight: bold;">expression</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">eval</span> !(Txt) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #00ff00;">'Txt'</span>
 S a <span style="color: #ffffff; font-weight: bold;">string</span> holding a Nial <span style="color: #ffffff; font-weight: bold;">expression</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">execute</span> canonical S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> S

<span style="color: #66f;">% where; </span>
canonical <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-102" class="outline-2">
<h2 id="sec-102"><span class="section-number-2">102</span> <code>exp</code></h2>
<div class="outline-text-2" id="text-102">

<p>
The operation exp implements the exponential function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">exponential of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">exponential of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">exponential of A</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?exp</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?exp</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">exp</span>  o  1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1. 2.71828 1.64872 ?exp ?exp ?error
</pre>
</div>

<div id="outline-container-sec-102-1" class="outline-3">
<h3 id="sec-102-1"><span class="section-number-3">102.1</span> Equations</h3>
<div class="outline-text-3" id="text-102-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">exp</span> <span style="color: #ffffff; font-weight: bold;">ln</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A   (within roundoff error)
<span style="color: #ffffff; font-weight: bold;">exp</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">exp</span> 1.0 <span style="color: #ffffff; font-weight: bold;">power</span> A   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-103" class="outline-2">
<h2 id="sec-103"><span class="section-number-2">103</span> expression&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-103">

<p>
The term expression is used in its most general sense to describe a program fragment that denotes one of the three primary objects of Nial: an array, an operation, or a transformer. However, in most contexts we use the term as an abbreviation of an array expression.
</p>

<p>
An array expression denotes an array value. That is, it is a program fragment that when evaluated in the proper context will produce an array. The predefined expressions of Q'Nial either produce a constant value, or they carry out some system action and return the fault value ?noexpr.
</p>

<p>
The control constructs of Nial are array expressions made up of keywords, simple-expressions and expression-sequences.
</p>

<p>
A named expression is either a predefined expression or an expression that has been given an explicit name using the IS definition mechanism.
</p>
</div>
</div>

<div id="outline-container-sec-104" class="outline-2">
<h2 id="sec-104"><span class="section-number-2">104</span> <i>expression sequence</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-104">

<p>
An expression-sequence is the main construct used for program text that produces a value. It consists of one or more expressions separated by semi-colons and possible followed by a semi-colon.
</p>

<pre class="example">
expression-sequence ::= expression
   { ; expression } [ ; ]
</pre>

<p>
The expressions in an expression-sequence are evaluated in left-to-right order.  If the sequence does not terminate with a semicolon, the array returned is the result of the last expression.  If the sequence does end with a semicolon, the array returned is the fault ?noexpr.  At the top level loop, if the array returned is the fault ?noexpr, it is not displayed.
</p>
</div>
</div>

<div id="outline-container-sec-105" class="outline-2">
<h2 id="sec-105"><span class="section-number-2">105</span> <code>exprs</code></h2>
<div class="outline-text-2" id="text-105">

<p>
The expression Exprs returns a list of phrases giving the names of all user defined expressions in the workspace.
</p>
</div>

<div id="outline-container-sec-105-1" class="outline-3">
<h3 id="sec-105-1"><span class="section-number-3">105.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-105-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Exprs</span> <span style="color: #00ffff;">IS</span> {
   Names Roles <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">symbols</span> 0;
   <span style="color: #ffaf00;">"expr</span> <span style="color: #ffffff; font-weight: bold;">match</span> Roles <span style="color: #ffffff; font-weight: bold;">sublist</span> Names }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-106" class="outline-2">
<h2 id="sec-106"><span class="section-number-2">106</span> extent</h2>
<div class="outline-text-2" id="text-106">

<p>
The term extent is used to describe the length of an axis of an array in a particular dimension.  Thus a 4 by 6 table is said to have extent 4 in the first dimension and extent 6 in the second dimension.
</p>
</div>
</div>

<div id="outline-container-sec-107" class="outline-2">
<h2 id="sec-107"><span class="section-number-2">107</span> <i>external declaration</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-107">

<p>
external-declaration ::= identifier IS
      EXTERNAL ( EXPRESSION
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">OPERATION</td>
</tr>

<tr>
<td class="left">TRANSFORMER</td>
</tr>

<tr>
<td class="left">VARIABLE )</td>
</tr>
</tbody>
</table>

<p>
An external declaration assigns a role to a name, allowing it to be used in a definition before its own definition is given.  This mechanism is useful for creating mutually recursive definitions.  An external declaration is made only in the global environment.
</p>

<p>
If the name is already defined with the same role, the declaration has no effect.  If the name has another role, a fault is reported.  If the name is not currently defined, a default object is associated with it.
</p>
</div>
</div>

<div id="outline-container-sec-108" class="outline-2">
<h2 id="sec-108"><span class="section-number-2">108</span> <code>false</code></h2>
<div class="outline-text-2" id="text-108">

<p>
The constant expression False denotes the boolean atom for false, which Nial also denotes by o.  It is the result of comparing two arrays that are not identical for equality.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">False</span> (<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">False</span>)
</pre>
</div>
<pre class="example">
ol
</pre>
</div>

<div id="outline-container-sec-108-1" class="outline-3">
<h3 id="sec-108-1"><span class="section-number-3">108.1</span> Equations</h3>
<div class="outline-text-3" id="text-108-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">False</span> <span style="color: #ff00ff; font-weight: bold;">=</span> 1
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">False</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">single</span> <span style="color: #ffffff; font-weight: bold;">False</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">False</span>
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">False</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-109" class="outline-2">
<h2 id="sec-109"><span class="section-number-2">109</span> <code>fault</code></h2>
<div class="outline-text-2" id="text-109">

<p>
The operation fault converts a string or phrase into the fault value with the string as its message.  If the argument is not a string, phrase or a fault, the result is the fault ?type error.
</p>

<p>
Fault is used to construct faults that contain blanks or other characters than cannot appear in a literal fault or ones constructed from a message provided from the host system.
</p>

<p>
By default, fault triggering is on when the interpreter is initialized. This causes the creation of a fault to interrupt the flow of execution. The operation quiet<sub>fault</sub> can be used to create a fault value without triggering an interrupt.
</p>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">settrigger</span> o;
<span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?missing data'</span>
</pre>
</div>
<pre class="example">
?missing data
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #ffaf00;">"Notastring</span>
</pre>
</div>
<pre class="example">
Notastring
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">fault</span> 3.4
</pre>
</div>
<pre class="example">
?type error
</pre>

<p>
The convention is that all faults generated by Q'Nial internally begin with the character ?.  The second example shows that this is not a requirement.
</p>
</div>

<div id="outline-container-sec-109-1" class="outline-3">
<h3 id="sec-109-1"><span class="section-number-3">109.1</span> Equations</h3>
<div class="outline-text-3" id="text-109-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isfault</span> F ==&gt; <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #ffffff; font-weight: bold;">string</span> F <span style="color: #ff00ff; font-weight: bold;">=</span> F
<span style="color: #ffffff; font-weight: bold;">isstring</span> S ==&gt; <span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #ffffff; font-weight: bold;">fault</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> S
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-110" class="outline-2">
<h2 id="sec-110"><span class="section-number-2">110</span> fault triggering</h2>
<div class="outline-text-2" id="text-110">

<p>
Nial assumes that every computation that terminates results in an array value. However, there are many cases where a computation does not have a sensible answer. If division by zero occurs, for example, there is no suitable number to return.  Nial uses special atomic arrays called faults to indicate such results. For division by zero it is ?div.
</p>

<p>
Q'Nial has two ways of handling a fault: either a trigger mechanism is executed that causes an interruption when a fault is created, or during execution of a defined operation, expression or transformer the fault is treated as a normal atomic array.
</p>

<p>
When Q'Nial is invoked, the fault triggering mechanism is turned on by default. (This effect can be suppressed by using an option in the setup for each version). During execution, the state of the triggering mechanism can be turned on or off using the operation settrigger. The operation quiet<sub>fault</sub> can be used to create a fault without causing fault triggering.
</p>

<p>
If fault triggering is set and a fault is generated during execution of a defined operation, execution is interrupted. On an interruption caused by a fault, a display message appears giving the call stack of definitions currently executing and the line of text that caused the fault. For example, the definition:
</p>

<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> A B { A <span style="color: #ff00ff; font-weight: bold;">/</span> B <span style="color: #ff00ff; font-weight: bold;">+</span> 1 }
</pre>
</div>

<p>
followed by the evaluation of the expression
</p>


<div class="org-src-container">

<pre class="src src-nial">foo 3 0
</pre>
</div>

<p>
results in the output:
</p>
<pre class="example">
-------------------------------------------------------------
    Fault interruption loop:  enter expressions or
     type: &lt;Return&gt;   to jump to top level
    current call stack :
foo
     ?div triggered in : ... A / B
-------------------------------------------------------------
&gt;&gt;&gt;
</pre>

<p>
where the string '&gt;&gt;&gt;' is a special prompt indicating that a fault has occurred and execution has been interrupted. The prompt permits you to query the value of variables in the expression and its surrounding computation or to view the operation that has triggered the fault. The above session might continue as:
</p>

<pre class="example">
&gt;&gt;&gt; see "foo
foo IS OPERATION A B {
    A / B + 1 }
&gt;&gt;&gt; A
3
&gt;&gt;&gt; B
0
&gt;&gt;&gt;
</pre>

<p>
A variable in a definition that called the current one can be referenced by preceding the variables name by the definition name and a colon, e.g. G:X denotes variable X in definition G. You can execute any expressions you want at the prompt. A useful thing to do is to see the definition that has interrupted. When you are ready to resume, reply to the prompt with a Return and control returns to the interactive loop.
</p>
</div>
</div>

<div id="outline-container-sec-111" class="outline-2">
<h2 id="sec-111"><span class="section-number-2">111</span> fault values&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></h2>
<div class="outline-text-2" id="text-111">

<p>
The Role of Faults
</p>

<p>
A fault is a special kind of atomic value used by Q'Nial to signal special values or to indicate that an operation has been given an argument it cannot handle in a normal way.  The special value faults are:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Fault</th>
<th scope="col" class="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">?noexpr</td>
<td class="left">indicates that no answer is expected</td>
</tr>

<tr>
<td class="left">?eof</td>
<td class="left">end of file indication</td>
</tr>

<tr>
<td class="left">?I</td>
<td class="left">Zenith which is greater than all atoms</td>
</tr>

<tr>
<td class="left">?O</td>
<td class="left">Nadir which is less than all atoms</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-112" class="outline-2">
<h2 id="sec-112"><span class="section-number-2">112</span> <code>filelength</code></h2>
<div class="outline-text-2" id="text-112">
<p>
:Class:  host direct access file operation
:Usage:  filelength Filename
:SeeAlso: readfield, writefield
:END:
</p>

<p>
The operation filelength returns the length in bytes of the host file named by string or phrase Filename.  It is used in conjunction with readfield and writefield in processing host files.
</p>
<div class="org-src-container">

<pre class="src src-nial">Len <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">filelength</span> <span style="color: #ffaf00;">"Myfile</span>;
Data <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfield</span> <span style="color: #ffaf00;">"Myfile</span> 0 Len;
</pre>
</div>

<p>
In the example, filelength is used to determine the size of the file and readfield is used to read it in as raw byte data. If the file corresponds to a text file, the data will include end of line indications appropriate for the host system.
</p>
</div>
</div>

<div id="outline-container-sec-113" class="outline-2">
<h2 id="sec-113"><span class="section-number-2">113</span> <code>filepath</code></h2>
<div class="outline-text-2" id="text-113">

<p>
The operation filepath converts a list of phrases or strings giving the names of directories and a filename into the system dependent string that access the specific file.  This operation is useful in writing system independent programs that will work with either UNIX or DOS (and WINDOWS) path name conventions.
</p>

<p>
Example:
</p>
<pre class="example">
filepath ".. "aitools "newfnfl "frames
</pre>
<p>
returns the string
</p>
<pre class="example">
../aitools/newnfl/frames
</pre>
<p>
on a UNIX version of Q'Nial, and returns
</p>
<pre class="example">
..\aitools\newnfl\frames
</pre>
<p>
on a PCDOS version.
</p>
</div>

<div id="outline-container-sec-113-1" class="outline-3">
<h3 id="sec-113-1"><span class="section-number-3">113.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-113-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">filepath</span> <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> Nms {
  <span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">link</span> (<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">string</span> Nms <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #ffffff; font-weight: bold;">Separator</span> ) }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-114" class="outline-2">
<h2 id="sec-114"><span class="section-number-2">114</span> <code>filestatus</code></h2>
<div class="outline-text-2" id="text-114">

<p>
The expression Filestatus gives information on the files currently open in a Q'Nial session.  It returns a list of triples, one for each open file, giving the file number as an integer, the filename as a phrase and the mode as a character.
</p>

<p>
The modes are r, w, a, d, pr, pw and c, standing for read, write, append, direct, pipe<sub>read</sub>, pipe<sub>write</sub> and communications respectively.
</p>

<p>
The files for standard input, standard output and standard error are opened with modes of r, w and w respectively using file numbers 0, 1 and 2.
</p>

<div class="org-src-container">

<pre class="src src-nial">Fnum <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> <span style="color: #ffaf00;">"F</span> <span style="color: #ffaf00;">"a</span>;
<span style="color: #ffffff; font-weight: bold;">Filestatus</span>
</pre>
</div>
<pre class="example">
+---------+----------+----------+-----+
|0 stdin r|1 stdout w|2 stderr w|3 F a|
+---------+----------+----------+-----+
</pre>
</div>
</div>

<div id="outline-container-sec-115" class="outline-2">
<h2 id="sec-115"><span class="section-number-2">115</span> <code>filetally</code></h2>
<div class="outline-text-2" id="text-115">

<p>
The operation filetally returns the number of records in the file designated by Filenum, an integer returned by an earlier call to open.  The filetally is one higher than the highest component number of a record or array that is written but not erased.
</p>

<div class="org-src-container">

<pre class="src src-nial">Fn <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> <span style="color: #ffaf00;">"newfile</span> `d;
<span style="color: #ffffff; font-weight: bold;">writearray</span> Fn (9 99) (<span style="color: #00ff00;">'The'</span> <span style="color: #00ff00;">'End'</span>);
<span style="color: #ffffff; font-weight: bold;">filetally</span> Fn
</pre>
</div>
<pre class="example">
100
</pre>
</div>
</div>

<div id="outline-container-sec-116" class="outline-2">
<h2 id="sec-116"><span class="section-number-2">116</span> <code>FILTER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-116">

<p>
The transformer <i>=FILTER=</i> is given a predicate operation f that is used to select items from A.  The result of applying <i>=FILTER=</i> f is to produce a list of the items of A that satisfy the predicate f.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FILTER</span> (0&lt;) (4 -2 3 -5)
</pre>
</div>
<pre class="example">
4 3
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FILTER</span> (<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">isphrase</span>) (37 4.5 <span style="color: #ffaf00;">"cat</span>)
</pre>
</div>
<pre class="example">
37 4.5
</pre>
</div>

<div id="outline-container-sec-116-1" class="outline-3">
<h3 id="sec-116-1"><span class="section-number-3">116.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-116-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FILTER</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffff00;">EACH</span> f A <span style="color: #ffffff; font-weight: bold;">sublist</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-116-2" class="outline-3">
<h3 id="sec-116-2"><span class="section-number-3">116.2</span> Equations</h3>
<div class="outline-text-3" id="text-116-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffff00;">FILTER</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-117" class="outline-2">
<h2 id="sec-117"><span class="section-number-2">117</span> <code>find</code></h2>
<div class="outline-text-2" id="text-117">

<p>
The operation find returns the address of the first occurrence of A as an item of B, searching B in row major order.  If A does not occur in B, the result is the gage of shape B.  The result of find is an integer if B is a list; and a list of integers of tally equal to valence B otherwise.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ;
3 <span style="color: #ffffff; font-weight: bold;">find</span> 56 34 3 23 3 57 3
</pre>
</div>
<pre class="example">
2
</pre>


<p>
The result of find is 2.
</p>

<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">find</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
11
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">find</span> <span style="color: #ffffff; font-weight: bold;">count</span> 3 4
</pre>
</div>
<pre class="example">
+-+-+
|1|2|
+-+-+
</pre>

<p>
In the second example, the character a is not in the string 'hello world' and the result is the tally of 'hello world'.  In the last example, the result is a list of two integers because the valence of count 3 4 is 2.
</p>
</div>

<div id="outline-container-sec-117-1" class="outline-3">
<h3 id="sec-117-1"><span class="section-number-3">117.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-117-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">find</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">gage</span> <span style="color: #ffffff; font-weight: bold;">first</span> ( A <span style="color: #ffffff; font-weight: bold;">findall</span> B <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B ) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-117-2" class="outline-3">
<h3 id="sec-117-2"><span class="section-number-3">117.2</span> Equations</h3>
<div class="outline-text-3" id="text-117-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">seek</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A [<span style="color: #ffffff; font-weight: bold;">in</span>,<span style="color: #ffffff; font-weight: bold;">find</span>] B
A <span style="color: #ffffff; font-weight: bold;">in</span> B ==&gt; A <span style="color: #ffffff; font-weight: bold;">find</span> B <span style="color: #ffffff; font-weight: bold;">pick</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">diverse</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> A <span style="color: #ffffff; font-weight: bold;">find</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> I
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-117-3" class="outline-3">
<h3 id="sec-117-3"><span class="section-number-3">117.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-117-3">
<p>
The operation find uses a linear search on the items of B if the array has not been sorted, or uses a binary search algorithm if it has. The latter fact suggests that an array that is searched frequently should be kept in lexicographical order by applying sortup to it when it is created or changed.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-118" class="outline-2">
<h2 id="sec-118"><span class="section-number-2">118</span> <code>findall</code></h2>
<div class="outline-text-2" id="text-118">

<p>
The operation findall returns a list of the addresses of all occurrences of A as an item of B, searching B in row major order.  If A does not occur in B, the result is the empty list Null.  The result of findall is a list of integers if B is a list and a list of pairs if B is a table.
</p>


<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">findall</span> 56 34 3 23 3 57 3
</pre>
</div>
<pre class="example">
2 4 6
</pre>



<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> 1 7 3 2 3 4 3 2 6 3
</pre>
</div>
<pre class="example">
1 7 3 2
3 4 3 2
6 3 1 7
</pre>


<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">findall</span> X
</pre>
</div>
<pre class="example">
+---+---+---+---+
|0 2|1 0|1 2|2 1|
+---+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">findall</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 1 <span style="color: #ffffff; font-weight: bold;">findall</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
+---+
|1 1|
+---+
</pre>

<p>
In the first example findall returns the list of integers where 3 is found in the list; in the second a list of pairs is returned. The last example shows that if only one occurrence is found the result is a solitary list.
</p>
</div>

<div id="outline-container-sec-118-1" class="outline-3">
<h3 id="sec-118-1"><span class="section-number-3">118.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-118-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">findall</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { A <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ffffff; font-weight: bold;">equal</span> B <span style="color: #ffffff; font-weight: bold;">sublist</span> <span style="color: #ffffff; font-weight: bold;">grid</span> B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-118-2" class="outline-3">
<h3 id="sec-118-2"><span class="section-number-3">118.2</span> Equations</h3>
<div class="outline-text-3" id="text-118-2">
<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffffff; font-weight: bold;">list</span> A) <span style="color: #ffffff; font-weight: bold;">findall</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">findall</span> B
<span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">findall</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">findall</span> B
A <span style="color: #ffffff; font-weight: bold;">in</span> B ==&gt; A <span style="color: #ffffff; font-weight: bold;">find</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> (A <span style="color: #ffffff; font-weight: bold;">findall</span> B)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-118-3" class="outline-3">
<h3 id="sec-118-3"><span class="section-number-3">118.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-118-3">
<p>
The operation findall uses a linear search on the items of B if the array has not been sorted, or uses a binary search algorithm if it has. The latter fact suggests that an array that is searched frequently should be kept in lexicographical order by applying sortup to it when it is created or changed.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-119" class="outline-2">
<h2 id="sec-119"><span class="section-number-2">119</span> <code>first</code></h2>
<div class="outline-text-2" id="text-119">

<p>
The operation first returns the first of the items of A.  If A is empty, it returns the fault ?address.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> 4 5 6
</pre>
</div>
<pre class="example">
4
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">count</span> 3 4 5
</pre>
</div>
<pre class="example">
1 1 1
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
?address
</pre>
</div>

<div id="outline-container-sec-119-1" class="outline-3">
<h3 id="sec-119-1"><span class="section-number-3">119.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-119-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { 0 <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">list</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-119-2" class="outline-3">
<h3 id="sec-119-2"><span class="section-number-3">119.2</span> Equations</h3>
<div class="outline-text-3" id="text-119-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
<span style="color: #ffffff; font-weight: bold;">first</span> (S <span style="color: #ffffff; font-weight: bold;">reshape</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
(<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> 0) <span style="color: #ffffff; font-weight: bold;">pick</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-120" class="outline-2">
<h2 id="sec-120"><span class="section-number-2">120</span> <del>flip</del></h2>
<div class="outline-text-2" id="text-120">

<p>
The operation flip is a synonym for pack. It has been retained for compatibility with earlier versions.
</p>
</div>
</div>

<div id="outline-container-sec-121" class="outline-2">
<h2 id="sec-121"><span class="section-number-2">121</span> <code>floor</code></h2>
<div class="outline-text-2" id="text-121">

<p>
The operation floor produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">corresponding integer</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">argument A</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">next lower integer, or the fault ?A if the result is outside the range of integers</td>
</tr>

<tr>
<td class="left">char</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">floor</span>  l  -2  3.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1 -2 3 ?A ?A ?error
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">floor</span>  3.5  -4.6  7.0  25.3e20
</pre>
</div>
<pre class="example">
3 -5 7 ?A
</pre>
</div>

<div id="outline-container-sec-121-1" class="outline-3">
<h3 id="sec-121-1"><span class="section-number-3">121.1</span> Equation</h3>
<div class="outline-text-3" id="text-121-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">floor</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">ceiling</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-122" class="outline-2">
<h2 id="sec-122"><span class="section-number-2">122</span> <code>FOLD</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-122">

<p>
The transformer <i>=FOLD=</i> modifies an operation f to one that takes a pair of arguments consisting of an integer N and an arbitrary array A.  The result of applying <code>N FOLD A</code> is to apply f, N times, applying it first to A and subsequently to the result of the previous application.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffff00;">FOLD</span> <span style="color: #ffffff; font-weight: bold;">rest</span> 4 5 6 7 8 9
</pre>
</div>
<pre class="example">
7 8 9
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffff00;">FOLD</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (2 3 4) (5 6 7)
</pre>
</div>
<pre class="example">
27
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (2 3 4) (5 6 7)
</pre>
</div>
<pre class="example">
27
</pre>
</div>

<div id="outline-container-sec-122-1" class="outline-3">
<h3 id="sec-122-1"><span class="section-number-3">122.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-122-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FOLD</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> N A {
   <span style="color: #00ffff;">IF</span> N <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 0 <span style="color: #00ffff;">THEN</span>
      N <span style="color: #ff00ff; font-weight: bold;">-</span> 1 <span style="color: #ffff00;">FOLD</span> f ( f A )
   <span style="color: #00ffff;">ELSE</span>
      A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-122-2" class="outline-3">
<h3 id="sec-122-2"><span class="section-number-3">122.2</span> Equations</h3>
<div class="outline-text-3" id="text-122-2">
<div class="org-src-container">

<pre class="src src-nial">0 <span style="color: #ffff00;">FOLD</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> A
1 <span style="color: #ffff00;">FOLD</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> f A
2 <span style="color: #ffff00;">FOLD</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> f f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-123" class="outline-2">
<h2 id="sec-123"><span class="section-number-2">123</span> <code>FORK</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-123">

<p>
The transformer FORK implements a conditional functional mechanism corresponding to the if-expression.  The argument to FORK must be an atlas of length two or more.  The operation in the first position is a predicate.  If there are exactly three items in the atlas, the first is a predicate; the second is applied to A if the predicate returns true; and the third is applied to A if the predicate returns false.  That is, if f A is true, the result is g A; otherwise it is h A.
</p>

<p>
If there are more than three operations in the atlas, they are taken in pairs from left to right.  The first of each pair must be a predicate and is applied to A in turn until a result is true.  The result of the transform is the result of applying the second of that pair to A.  If no application results in true and the number of operations in the atlas is an odd number, the last operation is evaluated.  Otherwise the result is the fault ?noexpr.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FORK</span> [<span style="color: #ffffff; font-weight: bold;">atomic</span>, <span style="color: #ffffff; font-weight: bold;">opposite</span>, 1 <span style="color: #ff00ff; font-weight: bold;">+</span>] (3 -4 (5 6 7))
</pre>
</div>
<pre class="example">
+-+--+-----+
|4|-3|6 7 8|
+-+--+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FORK</span> [<span style="color: #ffffff; font-weight: bold;">isreal</span>,<span style="color: #ffffff; font-weight: bold;">floor</span>,<span style="color: #ffffff; font-weight: bold;">simple</span>,<span style="color: #ffffff; font-weight: bold;">sum</span>,5+] 2 4 6
</pre>
</div>
<pre class="example">
12
</pre>
</div>

<div id="outline-container-sec-123-1" class="outline-3">
<h3 id="sec-123-1"><span class="section-number-3">123.1</span> Equation</h3>
<div class="outline-text-3" id="text-123-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">FORK</span> [A <span style="color: #ffffff; font-weight: bold;">first</span>, B <span style="color: #ffffff; font-weight: bold;">first</span>, C <span style="color: #ffffff; font-weight: bold;">first</span>, D <span style="color: #ffffff; font-weight: bold;">first</span>, E <span style="color: #ffffff; font-weight: bold;">first</span>] <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #00ffff;">IF</span> A <span style="color: #00ffff;">THEN</span> B <span style="color: #00ffff;">ELSEIF</span> C <span style="color: #00ffff;">THEN</span> D <span style="color: #00ffff;">ELSE</span> E <span style="color: #00ffff;">ENDIF</span>
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-124" class="outline-2">
<h2 id="sec-124"><span class="section-number-2">124</span> <code>for</code>-loop</h2>
<div class="outline-text-2" id="text-124">

<p>
The FOR-loop control structure is used to execute the expression sequence ExpSeq repeatedly while variable Var takes on the values specified as items in the simple expression Exp.
</p>
<pre class="example">
FOR X WITH 1. 2. 3. DO
   write (X) (X*X) (X power X) ;
ENDFOR
</pre>
<ol class="org-ol">
<li>1. 1.
</li>
<li>4. 4.
</li>
<li>9. 27.
</li>
</ol>

<p>
In the example, X takes on the values 1., 2.  and 3.  in successive loops and the values of X, X squared and X to the power X are displayed.
</p>
</div>
</div>

<div id="outline-container-sec-125" class="outline-2">
<h2 id="sec-125"><span class="section-number-2">125</span> <code>fromraw</code></h2>
<div class="outline-text-2" id="text-125">

<p>
The operation <a href="#sec-125">125</a> converts the boolean array A to a simple array of the same type as atom B.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>;
<span style="color: #ffffff; font-weight: bold;">fromraw</span> oooooooooollololoolloloo `a
</pre>
</div>
<pre class="example">
'345'
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">fromraw</span> ooooooooooooooooooooooololollool 0
</pre>
</div>
<pre class="example">
345
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">fromraw</span> ooooooooooooooooooooooooooooooooolooooooolooooololoooooooooooooo 0.0
</pre>
</div>
<pre class="example">
34.5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">fromraw</span> lollo l
</pre>
</div>
<pre class="example">
lollo
</pre>
</div>

<div id="outline-container-sec-125-1" class="outline-3">
<h3 id="sec-125-1"><span class="section-number-3">125.1</span> Equations</h3>
<div class="outline-text-3" id="text-125-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">simple</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">and</span> (<span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ffffff; font-weight: bold;">match</span> <span style="color: #ffffff; font-weight: bold;">type</span> <span style="color: #ffffff; font-weight: bold;">first</span> A) =&gt; A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">fromraw</span> (<span style="color: #ffffff; font-weight: bold;">toraw</span> A) (<span style="color: #ffffff; font-weight: bold;">first</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-125-2" class="outline-3">
<h3 id="sec-125-2"><span class="section-number-3">125.2</span> Pragmatics</h3>
<div class="outline-text-3" id="text-125-2">
<p>
<i>=Fromraw=</i> is used to convert raw bit data into atomic data that can be manipulated by Nial. If the data was created from Nial data using toraw then it will work in a system independent way. However, if raw byte data is obtained using readfile and then converted using toraw the host system byte ordering may need to be allowed for.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-126" class="outline-2">
<h2 id="sec-126"><span class="section-number-2">126</span> <code>front</code></h2>
<div class="outline-text-2" id="text-126">

<p>
The operation front returns a list of all items but the last of A.  If A is a solitary or is empty, the result is the empty list Null.
</p>

<pre class="example">
front 3 4 5 6
</pre>
<p>
3 4 5
</p>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|0 0|0 1|0 2|1 0|1 1|
+---+---+---+---+---+
</pre>
</div>

<div id="outline-container-sec-126-1" class="outline-3">
<h3 id="sec-126-1"><span class="section-number-3">126.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-126-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 1 <span style="color: #ffffff; font-weight: bold;">max</span> 0 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">list</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-126-2" class="outline-3">
<h3 id="sec-126-2"><span class="section-number-3">126.2</span> Equations</h3>
<div class="outline-text-3" id="text-126-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">front</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">front</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">front</span> A
<span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">front</span> A <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #ffffff; font-weight: bold;">last</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (<span style="color: #ffffff; font-weight: bold;">front</span> A <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #ffffff; font-weight: bold;">last</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-127" class="outline-2">
<h2 id="sec-127"><span class="section-number-2">127</span> functions in nial</h2>
<div class="outline-text-2" id="text-127">

<p>
A function is a mathematical name for an object that maps an argument in a given domain to a result in a given range.  In Nial, an operation is an object in the set of functions from the domain of Nial arrays to the range of Nial arrays.  Thus, an operation always applies to an array and returns an array.
</p>

<p>
A transformer in Nial is also a function.  It domain is Nial operations and its range is also Nial operations.  Since its argument is itself a function, a transformer is said to be a second order function.  A transformer always applies to an operation and results in an operation.
</p>

<p>
Definition in which the associated object is a simple-expression are used to name program fragments that return an array value but which do not need parameters.  The resulting named-expression behaves like a function having no parameters.
</p>

<p>
Nial is considered to be a functional language, but it is not purely functional in that it has assignments, loops and other non-functional concepts.
</p>
</div>
</div>

<div id="outline-container-sec-128" class="outline-2">
<h2 id="sec-128"><span class="section-number-2">128</span> <code>fuse</code></h2>
<div class="outline-text-2" id="text-128">

<p>
The operation fuse is used for two distinct purposes.  If I is simple and contains all the axes of A without repetition, the result is an array formed by a permutation of the axes of A by I.  The shape of the result is I choose shape A.  If I is not simple but link I is simple and contains all of the axes of A without repetition, the result is obtained by diagonalizing along axes that are grouped together, ordering them according to the ordering in I.
</p>

<p>
If link I does not contain all the axes or if there are repetitions of the axes in link I, the fault ?invalid fuse is returned.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 24
</pre>
</div>
<pre class="example">
1  2  3  4   13 14 15 16
5  6  7  8   17 18 19 20
9 10 11 12   21 22 23 24
</pre>


<div class="org-src-container">

<pre class="src src-nial">1 2 0 <span style="color: #ffffff; font-weight: bold;">fuse</span> A
</pre>
</div>
<pre class="example">
1 13   5 17    9 21
2 14   6 18   10 22
3 15   7 19   11 23
4 16   8 20   12 24
</pre>


<div class="org-src-container">

<pre class="src src-nial">0 (1 2) <span style="color: #ffffff; font-weight: bold;">fuse</span> A
</pre>
</div>
<pre class="example">
 1  6 11
13 18 23
</pre>


<div class="org-src-container">

<pre class="src src-nial">[0 1 2] <span style="color: #ffffff; font-weight: bold;">fuse</span> A
</pre>
</div>
<pre class="example">
1 18
</pre>


<p>
The first example is an axis permutation; the last two are diagonalizations.
</p>
</div>

<div id="outline-container-sec-128-1" class="outline-3">
<h3 id="sec-128-1"><span class="section-number-3">128.1</span> Equations</h3>
<div class="outline-text-3" id="text-128-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">fuse</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">transpose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> ( <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">fuse</span> A )
<span style="color: #ffffff; font-weight: bold;">sortup</span> I <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> ( I <span style="color: #ffffff; font-weight: bold;">fuse</span> A ) <span style="color: #ff00ff; font-weight: bold;">=</span> I <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-129" class="outline-2">
<h2 id="sec-129"><span class="section-number-2">129</span> <code>gage</code></h2>
<div class="outline-text-2" id="text-129">

<p>
The operation gage is used to convert an array of integers into an atomic integer if there is only one item or a list if there is more than one.  The integers must be non-negative otherwise the fault ?gage is produced.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gage</span> 4 5 6
</pre>
</div>
<pre class="example">
4 5 6
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gage</span> <span style="color: #ffffff; font-weight: bold;">find</span> 5 (<span style="color: #ffffff; font-weight: bold;">tell</span> 10)
</pre>
</div>
<pre class="example">
6
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gage</span> 3 -4 5
</pre>
</div>
<pre class="example">
?gage
</pre>

<p>
The main purpose of gage is to express an list of non-negative integers in the form an address takes, i.e. it converts a solitary integer to the integer itself and leaves all other lists alone.
</p>
</div>

<div id="outline-container-sec-129-1" class="outline-3">
<h3 id="sec-129-1"><span class="section-number-3">129.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-129-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gage</span> <span style="color: #00ffff;">is</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> A <span style="color: #00ffff;">THEN</span>
      <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 1 <span style="color: #00ffff;">THEN</span>
         <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> 0 <span style="color: #00ffff;">THEN</span> <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #00ffff;">ELSE</span> ?<span style="color: brightred;">?gage</span> <span style="color: #00ffff;">ENDIF</span>
      <span style="color: #00ffff;">ELSE</span>
         <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> (0&lt;=) A <span style="color: #00ffff;">THEN</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #00ffff;">ELSE</span> ?<span style="color: brightred;">?gage</span> <span style="color: #00ffff;">ENDIF</span>
      <span style="color: #00ffff;">ENDIF</span>
   <span style="color: #00ffff;">ELSE</span> ?<span style="color: brightred;">?gage</span> <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-130" class="outline-2">
<h2 id="sec-130"><span class="section-number-2">130</span> <code>getdef</code></h2>
<div class="outline-text-2" id="text-130">

<p>
The operation getdef retrieves the parse tree associated with the global definition named Nm.  Nm may be a phrase or a string.  Only the parse trees associated with global user definitions can be retrieved.
</p>


<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">first</span> ; <span style="color: #ffffff; font-weight: bold;">getdef</span> <span style="color: #ffaf00;">"foo</span>
</pre>
</div>
<pre class="example">
+---+-----------------------------+
|100|+--+---------------+------+-+|
|   ||11|+--+----------+|3 47 3|1||
|   ||  ||22|2 160 7459||      | ||
|   ||  |+--+----------+|      | ||
|   |+--+---------------+------+-+|
+---+-----------------------------+
</pre>

<p>
The example shows a parse tree for a simple definition.  For definitions of any reasonable size the diagram of the parse tree becomes too large to examine easily.
</p>

<p>
The primary use of getdef is to provide an interface between internal representations and the editing facilities.  It is used in see and defedit.  The detailed form of the parse tree is implementation specific and may change in future releases.
</p>
</div>
</div>

<div id="outline-container-sec-131" class="outline-2">
<h2 id="sec-131"><span class="section-number-2">131</span> <code>getfile</code></h2>
<div class="outline-text-2" id="text-131">

<p>
The operation getfile returns the records of the text file named by the string or phrase Filename as a list of strings.  The file must not be open.
</p>

<div class="org-src-container">

<pre class="src src-nial">Recs <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">getfile</span> <span style="color: #ffaf00;">"Myfile</span>;
</pre>
</div>
<pre class="example">
</pre>
</div>

<div id="outline-container-sec-131-1" class="outline-3">
<h3 id="sec-131-1"><span class="section-number-3">131.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-131-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">getfile</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Filename {
   Fnum <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> Filename `r;
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">isfault</span> Fnum <span style="color: #00ffff;">THEN</span>
      Fnum
   <span style="color: #00ffff;">ELSE</span>
      Lines <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">''</span>;
      Line <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> Fnum;
      <span style="color: #00ffff;">WHILE</span> Line <span style="color: #ff00ff; font-weight: bold;">~=</span> ?<span style="color: brightred;">?eof</span> <span style="color: #00ffff;">DO</span>
         Lines <span style="color: #ff00ff;">:=</span> Lines <span style="color: #ffffff; font-weight: bold;">append</span> Line;
         Line <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> Fnum;
      <span style="color: #00ffff;">ENDWHILE</span>;
      Lines
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-132" class="outline-2">
<h2 id="sec-132"><span class="section-number-2">132</span> <code>getname</code></h2>
<div class="outline-text-2" id="text-132">

<p>
The operation getname retrieves the variable or definition name associated with a name reference triple within a parse tree.  The argument must be a triple with first item 2 that has been produced by the Q'Nial parser.  The operation is useful when analyzing the structure of a parse tree representation.  This is a specialized task and getname is used only with considerable knowledge of the internal workings of Q'Nial.
</p>
</div>
</div>

<div id="outline-container-sec-133" class="outline-2">
<h2 id="sec-133"><span class="section-number-2">133</span> <code>getsyms</code></h2>
<div class="outline-text-2" id="text-133">

<p>
The operation getsyms retrieves the parameters and local variables of a defined operation or expression named by Nm.  The operation is useful when analyzing the name usage of a definition in the context of analyzing the name interaction among a set of definitions.  This is a specialized task and getsyms is used only with considerable knowledge of the semantics of Q'Nial.
</p>
</div>
</div>

<div id="outline-container-sec-134" class="outline-2">
<h2 id="sec-134"><span class="section-number-2">134</span> global environment</h2>
<div class="outline-text-2" id="text-134">

<p>
The global environment is the set of associations between names and objects formed in the workspace that are either predefined in Nial or have been created by actions that have taken place during a session.
</p>
</div>
</div>

<div id="outline-container-sec-135" class="outline-2">
<h2 id="sec-135"><span class="section-number-2">135</span> <code>GRADE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-135">

<p>
The transformer <i>=GRADE=</i> modifies a comparator f to produce an operation that, when applied to A, returns an array of addresses of the same shape as A that orders A according to the comparator.  The addresses can be used to select the items of A (using choose) so that the items are in order according to f.
</p>

<p>
A comparator is an operation that compares two arrays and returns true if they are in the desired ordering or false otherwise.  Operations lte (&lt;=) and gte (&gt;=) are the most commonly used comparators.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #00ffff;">gets</span> 3 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> 65 77 4 19 22 11
</pre>
</div>
<pre class="example">
65 77
 4 19
22 11
</pre>


<div class="org-src-container">

<pre class="src src-nial">Addrs <span style="color: #ff00ff;">:=</span> <span style="color: #ffff00;">GRADE</span> <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> A
</pre>
</div>
<pre class="example">
+---+---+
|0 1|0 0|
+---+---+
|2 0|1 1|
+---+---+
|2 1|1 0|
+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">Addrs <span style="color: #ffffff; font-weight: bold;">choose</span> A
</pre>
</div>
<pre class="example">
77 65
22 19
11  4
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">GRADE</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> (<span style="color: #ffaf00;">"some</span> <span style="color: #ffaf00;">"not</span> <span style="color: #ffaf00;">"in</span> <span style="color: #ffaf00;">"order</span>)
</pre>
</div>
<pre class="example">
3 1 0 2
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">GRADE</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> [<span style="color: #00ff00;">'xyz'</span>,<span style="color: #00ff00;">'abc'</span>,<span style="color: #00ff00;">'mno'</span>,<span style="color: #00ff00;">'cat'</span>]
</pre>
</div>
<pre class="example">
?invalid comparison in GRADE
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">GRADE</span> <span style="color: #ffffff; font-weight: bold;">up</span> [<span style="color: #00ff00;">'xyz'</span>,<span style="color: #00ff00;">'abc'</span>,<span style="color: #00ff00;">'mno'</span>,<span style="color: #00ff00;">'cat'</span>]
</pre>
</div>
<pre class="example">
1 3 2 0
</pre>


<p>
The first three expressions illustrate that GRADE returns the addresses that re-order the items of table A in descending order.  The next expression shows that the GRADE transform of &lt;= can be applied to a list of phrases.  The second last expression shows that GRADE &lt;= cannot be applied to a list of strings.  This is because &lt;= is used itemwise on the characters of the strings and hence the comparator yields a bitstring rather than an atomic boolean result.  The last expression shows that the comparator up can be used with strings.
</p>
</div>

<div id="outline-container-sec-135-1" class="outline-3">
<h3 id="sec-135-1"><span class="section-number-3">135.1</span> Equations</h3>
<div class="outline-text-3" id="text-135-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">SORT</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">GRADE</span> f A <span style="color: #ffffff; font-weight: bold;">choose</span> A
f a comparator ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">GRADE</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-136" class="outline-2">
<h2 id="sec-136"><span class="section-number-2">136</span> <code>gradeup</code></h2>
<div class="outline-text-2" id="text-136">

<p>
The operation
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gradeup</span> 3 7 5 4 9 8 2 1 6 10
</pre>
</div>
<pre class="example">
7 6 0 3 2 8 1 5 4 9
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gradeup</span> (<span style="color: #ffaf00;">"some</span> <span style="color: #ffaf00;">"words</span> <span style="color: #ffaf00;">"not</span> <span style="color: #ffaf00;">"in</span> <span style="color: #ffaf00;">"order</span>)
</pre>
</div>
<pre class="example">
3 2 4 0 1
</pre>
</div>

<div id="outline-container-sec-136-1" class="outline-3">
<h3 id="sec-136-1"><span class="section-number-3">136.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-136-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gradeup</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">GRADE</span> <span style="color: #ffffff; font-weight: bold;">up</span>
</pre>
</div>

<p>
Equation
   gradeup A choose A = sortup A
</p>
</div>
</div>
</div>

<div id="outline-container-sec-137" class="outline-2">
<h2 id="sec-137"><span class="section-number-2">137</span> <code>grid</code></h2>
<div class="outline-text-2" id="text-137">

<p>
The operation grid returns the array of addresses of the array A.  The result has the same shape as A.  Each item of the result is the address of the corresponding item in A.  The grid of a list is a list of integers.  The grid of a table is a table of pairs of integers.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">grid</span> 3 6 4 7 4
</pre>
</div>
<pre class="example">
0 1 2 3 4
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span>  2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 6; A (<span style="color: #ffffff; font-weight: bold;">grid</span> A)
</pre>
</div>
<pre class="example">
+-----+-------------+
|1 2 3|+---+---+---+|
|4 5 6||0 0|0 1|0 2||
|     |+---+---+---+|
|     ||1 0|1 1|1 2||
|     |+---+---+---+|
+-----+-------------+
</pre>
</div>

<div id="outline-container-sec-137-1" class="outline-3">
<h3 id="sec-137-1"><span class="section-number-3">137.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-137-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">grid</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">gage</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-137-2" class="outline-3">
<h3 id="sec-137-2"><span class="section-number-3">137.2</span> Equations</h3>
<div class="outline-text-3" id="text-137-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-138" class="outline-2">
<h2 id="sec-138"><span class="section-number-2">138</span> <code>gt</code></h2>
<div class="outline-text-2" id="text-138">

<p>
The operation gt compares two atoms A and B with the greater than relation, returning true if A is greater than B and false otherwise.  The symbol &gt; is a synonym for gt.
</p>

<p>
The atoms in Nial are organized as a lattice using &lt;= for the ordering.  The numeric atoms are comparable across types but numeric and literal atoms are incomparable.  The literal types are not comparable across types.  A comparison between incomparable objects results in false.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ff00ff;">:=</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">&gt;</span> R
</pre>
</div>
<pre class="example">
oooooo
looooo
lloooo
oooooo
oooooo
oooooo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'apple'</span> <span style="color: #ff00ff; font-weight: bold;">&gt;</span> <span style="color: #00ff00;">'above'</span>
</pre>
</div>
<pre class="example">
olloo
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"apple</span> <span style="color: #ff00ff; font-weight: bold;">&gt;</span> <span style="color: #ffaf00;">"above</span>
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The use of OUTER &gt; shows the comparisons between various atom types.  The last two examples show the difference between comparing two strings, where the operation is distributed by its pervasive property; and comparing the corresponding phrases.
</p>
</div>

<div id="outline-container-sec-138-1" class="outline-3">
<h3 id="sec-138-1"><span class="section-number-3">138.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-138-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gt</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { (A <span style="color: #ffffff; font-weight: bold;">gte</span> B) <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> (A <span style="color: #ffffff; font-weight: bold;">mate</span> B) }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-139" class="outline-2">
<h2 id="sec-139"><span class="section-number-2">139</span> <code>gte</code></h2>
<div class="outline-text-2" id="text-139">

<p>
The operation gte compares two atoms A and B with the greater than or equal relation, returning true if A is greater than or equal to B and false otherwise.  The symbol &gt;= is a synonym for gte.
</p>

<p>
The atoms in Nial are organized as a lattice using &lt;= for the ordering.  The numeric atoms are comparable across types but numeric and literal atoms are incomparable.  The literal types are not comparable across types.  A comparison between incomparable objects results in false.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ff00ff;">:=</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> R
</pre>
</div>
<pre class="example">
looooo
lloooo
lllooo
oooloo
oooolo
oooool
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'apple'</span> <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> <span style="color: #00ff00;">'above'</span>
</pre>
</div>
<pre class="example">
lllol
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"apple</span> <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> <span style="color: #ffaf00;">"above</span>
</pre>
</div>
<pre class="example">
l
</pre>


<p>
The use of OUTER &gt;= shows the comparisons between various atom types.  The last two examples show the difference between comparing two strings, where the operation is distributed by its pervasive property; and comparing the corresponding phrases.
</p>
</div>

<div id="outline-container-sec-139-1" class="outline-3">
<h3 id="sec-139-1"><span class="section-number-3">139.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-139-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gte</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { B <span style="color: #ffffff; font-weight: bold;">lte</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-140" class="outline-2">
<h2 id="sec-140"><span class="section-number-2">140</span> <code>help</code></h2>
<div class="outline-text-2" id="text-140">

<p>
The Q'Nial Help Facility is integrated with the Windows Help mechanism in the Q'Nial for Windows version. If the cursor is over a word for which there is a help entry, then pressing F1 will bring up the help screen for that topic.
</p>

<p>
The expression Help starts up the Q'Nial Help Facility in console versions. It reads text from the help file stored in directory  nialhelp  and displays the information in an edit window.  The explanation on using the help facility is given in the initial screen.
</p>
</div>
</div>

<div id="outline-container-sec-141" class="outline-2">
<h2 id="sec-141"><span class="section-number-2">141</span> <code>hitch</code></h2>
<div class="outline-text-2" id="text-141">

<p>
The operation hitch attaches A to the front of the list of items of B.  It returns a list of length one greater than the tally of B.
</p>

<div class="org-src-container">

<pre class="src src-nial">(2 3 4) <span style="color: #ffffff; font-weight: bold;">hitch</span> (5 6 7)
</pre>
</div>
<pre class="example">
+-----+-+-+-+
|2 3 4|5|6|7|
+-----+-+-+-+
</pre>


<div class="org-src-container">

<pre class="src src-nial">7 <span style="color: #ffffff; font-weight: bold;">hitch</span> 3
</pre>
</div>
<pre class="example">
7 3
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #00ff00;">'Wow'</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
+---+
|Wow|
+---+
</pre>

<p>
The first example shows that the list 2 3 4 becomes an item on the front of the list 5 6 7.  In the next example, the right argument of hitch is treated as a list.  The last example shows that if the right argument is an empty list, the result is the left argument as a solitary.
</p>
</div>

<div id="outline-container-sec-141-1" class="outline-3">
<h3 id="sec-141-1"><span class="section-number-3">141.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-141-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ffffff; font-weight: bold;">link</span> B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-141-2" class="outline-3">
<h3 id="sec-141-2"><span class="section-number-3">141.2</span> Equations</h3>
<div class="outline-text-3" id="text-141-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">hitch</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> (<span style="color: #ffffff; font-weight: bold;">list</span> B)
A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">hitch</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> B
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (<span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-142" class="outline-2">
<h2 id="sec-142"><span class="section-number-2">142</span> <code>host</code></h2>
<div class="outline-text-2" id="text-142">

<p>
The operation host executes S as a host command language instruction.  The argument S is a string or a phrase.  If the action carried out by the host system produces output, the output is displayed on the screen.  In window mode, Q'Nial is unable to capture this output and hence it may scramble the screen output.  The screen is restored by executing Refresh.
</p>

<p>
The result of host is the fault ?noexpr if the command has returned normally; or a fault generated from a system dependent error message supplied by the host operating system.   At the top level loop, a line beginning with !, the exclamation mark, is interpreted as a host command.
</p>
</div>
</div>

<div id="outline-container-sec-143" class="outline-2">
<h2 id="sec-143"><span class="section-number-2">143</span> <code>if</code>-expr</h2>
<div class="outline-text-2" id="text-143">

<p>
The IF-expr construct is a notation for executing one of a number of possible expression sequences Es1, Es2, &#x2026; Esn.  The sequence selected depends on the result of the conditional expressions C1, C2, &#x2026; Cn.  In the general case, whichever condition is first found to return true specifies the expression sequence to be performed.  If all the conditional expressions return false, expression sequence Esx is selected.  The ELSEIF and ELSE clauses are optional.
</p>

<p>
In the following example, the result is one of phrase Adult, Minor or Juvenile, depending on the value of Age.
</p>

<div class="org-src-container">

<pre class="src src-nial">Age <span style="color: #ff00ff;">:=</span> 17;
<span style="color: #00ffff;">IF</span> Age <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 18 <span style="color: #00ffff;">THEN</span>
   <span style="color: #ffaf00;">"Adult</span>
<span style="color: #00ffff;">ELSEIF</span> Age <span style="color: #ff00ff; font-weight: bold;">&lt;</span> 16 <span style="color: #00ffff;">THEN</span>
   <span style="color: #ffaf00;">"Minor</span>
<span style="color: #00ffff;">ELSE</span>
   <span style="color: #ffaf00;">"Juvenile</span>
<span style="color: #00ffff;">ENDIF</span>
</pre>
</div>
<pre class="example">
Juvenile
</pre>
</div>
</div>

<div id="outline-container-sec-144" class="outline-2">
<h2 id="sec-144"><span class="section-number-2">144</span> <code>in</code></h2>
<div class="outline-text-2" id="text-144">

<p>
The operation in returns true if A is an item of B and returns false if it is not.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">in</span> 56 34 23 3 57 3
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial">1 1 <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffaf00;">"apple</span>
</pre>
</div>
<pre class="example">
o
</pre>

<pre class="example">
</pre>
<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #ffaf00;">"apple</span>
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The fourth and fifth examples show that a letter is not an item of a phrase but is an item of the corresponding string.
</p>
</div>

<div id="outline-container-sec-144-1" class="outline-3">
<h3 id="sec-144-1"><span class="section-number-3">144.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-144-1">
<div class="org-src-container">

<pre class="src src-nial">:     <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">or</span> (A <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ffffff; font-weight: bold;">equal</span> B }
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-144-2" class="outline-3">
<h3 id="sec-144-2"><span class="section-number-3">144.2</span> Equations</h3>
<div class="outline-text-3" id="text-144-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">in</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">in</span> (<span style="color: #ffffff; font-weight: bold;">list</span> B)
A <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">False</span>
A <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
A <span style="color: #ffffff; font-weight: bold;">in</span> (A <span style="color: #ffffff; font-weight: bold;">hitch</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
A <span style="color: #ffffff; font-weight: bold;">in</span> (B <span style="color: #ffffff; font-weight: bold;">append</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
A <span style="color: #ffffff; font-weight: bold;">in</span> (A <span style="color: #ffffff; font-weight: bold;">pair</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-144-3" class="outline-3">
<h3 id="sec-144-3"><span class="section-number-3">144.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-144-3">
<p>
The operation in uses a linear search on the items of B if the array has not been sorted, or uses a binary search algorithm if it has. The latter fact suggests that an array that is searched frequently should be kept in lexicographical order by applying sortup to it when it is created.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-145" class="outline-2">
<h2 id="sec-145"><span class="section-number-2">145</span> indexing&#xa0;&#xa0;&#xa0;<span class="tag"><span class="table">table</span></span></h2>
<div class="outline-text-2" id="text-145">

<p>
The term indexing is used to describe notations that can be used to select from  or insert into a variable.
</p>

<p>
There are four indexing methods in Nial: at, at all, at path and slice represented by <code>@</code>, <code>#</code>, <code>@@</code> and <code>|</code> respectively.  The different indexing methods return different subsets of the array.  The following is a summary of the indexing methods:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Method</th>
<th scope="col" class="left">Name</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><code>@</code></td>
<td class="left">at</td>
<td class="left">indexes one item</td>
</tr>

<tr>
<td class="left"><code>#</code></td>
<td class="left">at all</td>
<td class="left">indexes several items</td>
</tr>

<tr>
<td class="left"><code>@@</code></td>
<td class="left">at path</td>
<td class="left">indexes a part at depth</td>
</tr>

<tr>
<td class="left">&vert;</td>
<td class="left">slice</td>
<td class="left">indexes cross-section of items</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial">Cities <span style="color: #ff00ff;">:=</span> <span style="color: #ffaf00;">"London</span> <span style="color: #ffaf00;">"Washington</span> <span style="color: #ffaf00;">"Ottawa</span> <span style="color: #ffaf00;">"Moscow</span> <span style="color: #ffaf00;">"Paris</span> ; Cities@0
</pre>
</div>
<pre class="example">
London
</pre>

<div class="org-src-container">

<pre class="src src-nial">Cities<span style="color: #66f;">#[2,3]</span>
</pre>
</div>
<pre class="example">
Ottawa Moscow
</pre>


<div class="org-src-container">

<pre class="src src-nial">Alpha <span style="color: #ff00ff;">:=</span> 5 5 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'ABCDEFGHIJKLMNOPQRSTUVWXY'</span>
</pre>
</div>
<p>
ABCDE
FGHIJ
KLMNO
PQRST
UVWXY
</p>

<div class="org-src-container">

<pre class="src src-nial">Alpha@[0,2]
</pre>
</div>
<pre class="example">
C
</pre>

<div class="org-src-container">

<pre class="src src-nial">Alpha|[1,]
</pre>
</div>
<pre class="example">
FGHIJ
</pre>


<div class="org-src-container">

<pre class="src src-nial">Alpha|[,1]
</pre>
</div>
<pre class="example">
BGLQV
</pre>

<div class="org-src-container">

<pre class="src src-nial">Alpha|[,[1,3]]
</pre>
</div>
<pre class="example">
BD
GI
LN
QS
VX
</pre>

<p>
The following example shows the slightly different structure which occurs when a comma is either present or missing before the last item.  The library operation findpaths is used to indicate the path to the integer 10 in each case.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ; Nest1 <span style="color: #ff00ff;">:=</span> [1, 2, [3, 4, 5, [6, 7], 8, 9], 10]
</pre>
</div>
<pre class="example">
+-+-+-----------------+--+
|1|2|+-+-+-+-----+-+-+|10|
| | ||3|4|5|+-+-+|8|9||  |
| | || | | ||6|7|| | ||  |
| | || | | |+-+-+| | ||  |
| | |+-+-+-+-----+-+-+|  |
+-+-+-----------------+--+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ; Nest2 <span style="color: #ff00ff;">:=</span> [1, 2, [3, 4, 5, [6, 7], 8, 9] 10]
</pre>
</div>
<pre class="example">
+-+-+----------------------+
|1|2|+-----------------+--+|
| | ||+-+-+-+-----+-+-+|10||
| | |||3|4|5|+-+-+|8|9||  ||
| | ||| | | ||6|7|| | ||  ||
| | ||| | | |+-+-+| | ||  ||
| | ||+-+-+-+-----+-+-+|  ||
| | |+-----------------+--+|
+-+-+----------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">findpaths 10 Nest1
</pre>
</div>
<pre class="example">
+---+
|+-+|
||3||
|+-+|
+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">findpaths 10 Nest2
</pre>
</div>
<pre class="example">
+-----+
|+-+-+|
||2|1||
|+-+-+|
+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">(Nest2@@[2,0,3,0])
</pre>
</div>
<pre class="example">
6
</pre>

<div class="org-src-container">

<pre class="src src-nial">(Nest2@@[2,0,4])
</pre>
</div>
<pre class="example">
8
</pre>

<p>
Address Validity
</p>

<p>
The index used in selecting a part of an array must be an expression that evaluates to a valid address.  An invalid index returns a fault as follows:
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Indexing Method</th>
<th scope="col" class="left">Fault</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">A@I</td>
<td class="left">?address</td>
</tr>

<tr>
<td class="left">A#I</td>
<td class="left">?addresses</td>
</tr>

<tr>
<td class="left">A@@P</td>
<td class="left">?path</td>
</tr>

<tr>
<td class="left">A &vert; I</td>
<td class="left">?slice</td>
</tr>
</tbody>
</table>

<p>
The operation pick works the same as the at method of indexing.  If the index is invalid, pick returns the fault ?address.  Similarly, choose works the same as at all indexing.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">pick</span> Cities
</pre>
</div>
<pre class="example">
Moscow
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">choose</span> Cities
</pre>
</div>
<pre class="example">
Ottawa Moscow
</pre>

<div class="org-src-container">

<pre class="src src-nial">10 <span style="color: #ffffff; font-weight: bold;">pick</span> Cities
</pre>
</div>
<pre class="example">
?address
</pre>

<div class="org-src-container">

<pre class="src src-nial">4 5 6 <span style="color: #ffffff; font-weight: bold;">choose</span> Cities
</pre>
</div>
<pre class="example">
Paris ?address ?address
</pre>
</div>
</div>

<div id="outline-container-sec-146" class="outline-2">
<h2 id="sec-146"><span class="section-number-2">146</span> <i>infix notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-146">

<p>
In Nial an operation-expression may be placed between two array-expressions. This is called an infix use of the operation-expression.
</p>

<div class="org-src-container">

<pre class="src src-nial">7 <span style="color: #ff00ff; font-weight: bold;">+</span> 5
</pre>
</div>
<pre class="example">
12
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> 1 2 3 4 5 6
</pre>
</div>
<pre class="example">
1 2 3
4 5 6
</pre>

<p>
In using the infix notation, one must understand that if a sequence of operations are placed between two array arguments, all but the first operation are applied to the second argument.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3
</pre>
</div>
<pre class="example">
4 3 2
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 (<span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">tell</span>) 3
</pre>
</div>
<pre class="example">
3 6
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 (<span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">reverse</span>) <span style="color: #ffffff; font-weight: bold;">tell</span> 3
</pre>
</div>
<pre class="example">
2 3 4
</pre>
</div>
</div>

<div id="outline-container-sec-147" class="outline-2">
<h2 id="sec-147"><span class="section-number-2">147</span> initial subdirectory</h2>
<div class="outline-text-2" id="text-147">

<p>
The initial subdirectory is within the directory identified as the Nialroot directory.  It holds a number of files that may be used for initializing Q'Nial including the defs.ndf file used for creating the clearws workspace.
</p>

<p>
When a Q'Nial session is initiated, if none of the -defs, Filename or Wsname options is used as a parameter to the nial command, the clearws.nws workspace is loaded.  If the clearws.nws file does not exist in the current directory, it is sought in the Nialroot directory.  If it is not present in either place, it is created automatically by the initialization process and kept internal to Q'Nial.
</p>

<p>
A user can customize their version of QNial by setting up an initial directory and modifying the defs.ndf file to include definitions they wish to be present in every QNial session.
</p>
</div>
</div>

<div id="outline-container-sec-148" class="outline-2">
<h2 id="sec-148"><span class="section-number-2">148</span> <code>INNER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-148">

<p>
The transformer <i>=INNER=</i> generalizes the inner product operation of linear algebra.  For a pair of lists A and B, the result is the application of the reductive operation f to the result of applying the binary pervasive operation g to A and B.  It is assumed that f is one of the seven reductive operations of Nial: sum, product, or, and, max, min, or link and that g distributes pairwise.  For tables, OUTER g is applied to the rows of A and the columns of B and f is applied to each item of the outer product.
</p>

<p>
Thus, INNER [+,*]  is equivalent to matrix multiplication in linear algebra and INNER [or,and]  is boolean matrix product.  For higher dimensional arrays, the lists are formed by "pushing down" the last axis of A and the first axis of B.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 4 <span style="color: #ffff00;">INNER</span> [<span style="color: #ff00ff; font-weight: bold;">+</span>,<span style="color: #ff00ff; font-weight: bold;">*</span>] 4 5 6
</pre>
</div>

<div class="org-src-container">

<pre class="src src-nial">loll <span style="color: #ffff00;">INNER</span> [<span style="color: #ffffff; font-weight: bold;">or</span>,<span style="color: #ffffff; font-weight: bold;">and</span>] olol
</pre>
</div>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 8;
B <span style="color: #ff00ff;">:=</span> 4 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 8;
A B
</pre>
</div>
<pre class="example">
+-------+-----+
|1 2 3 4|0 1 2|
|5 6 7 8|3 4 5|
|       |6 7 0|
|       |1 2 3|
+-------+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffff00;">INNER</span> [<span style="color: #ffffff; font-weight: bold;">sum</span>,<span style="color: #ffffff; font-weight: bold;">times</span>] B
</pre>
</div>
</div>
<div id="outline-container-sec-148-1" class="outline-3">
<h3 id="sec-148-1"><span class="section-number-3">148.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-148-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">INNER</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f g (<span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B) {
  <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ffff00;">OUTER</span> (f g) (0 <span style="color: #ffffff; font-weight: bold;">split</span> B) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-148-2" class="outline-3">
<h3 id="sec-148-2"><span class="section-number-3">148.2</span> Equation</h3>
<div class="outline-text-3" id="text-148-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffff00;">INNER</span> [f,g] B) <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A) <span style="color: #ffffff; font-weight: bold;">link</span> (<span style="color: #ffffff; font-weight: bold;">rest</span> <span style="color: #ffffff; font-weight: bold;">shape</span> B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-149" class="outline-2">
<h2 id="sec-149"><span class="section-number-2">149</span> <code>innerproduct</code></h2>
<div class="outline-text-2" id="text-149">

<p>
The operation innerproduct computes the mathematical inner product of real vectors and matrices using special code for efficiency.  For real matrices, it produces the same result as A INNER [+,*] B, but computes the result more rapidly for large arguments.  It coerces boolean and integer arrays to reals.  The name ip is provided as an abbreviation.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 8;
B <span style="color: #ff00ff;">:=</span> 4 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 8;
A B
</pre>
</div>
<pre class="example">
+-------+-----+
|1 2 3 4|0 1 2|
|5 6 7 8|3 4 5|
|       |6 7 0|
|       |1 2 3|
+-------+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">innerproduct</span> B
</pre>
</div>
<pre class="example">
28. 38. 24.
68. 94. 64.
</pre>


<p>
The number of columns of A must match the number of rows in B.
</p>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ffffff; font-weight: bold;">ip</span> A
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-150" class="outline-2">
<h2 id="sec-150"><span class="section-number-2">150</span> interrupt</h2>
<div class="outline-text-2" id="text-150">

<p>
An interrupt is an event that causes the operating system to suspend its operation and address a requirement of higher priority.  Typically, interrupts occur to handle input/output.  However, an interrupt also occurs when a fault is detected.
</p>

<p>
In the default mode of operation of Q'Nial, most fault values are not created.  Rather, an interrupt is triggered.  A description of the fault triggering mechanism is given under fault triggering.
</p>

<p>
The user can interrupt execution by pressing &lt;Ctrl-c&gt; &lt;Return&gt; at the keyboard in console versions, or clicking on the STOP button in the GUI version. This capability can be turned off using setinterrrupts. An interrupt can also be triggered under program control using the expression Toplevel.
</p>
</div>
</div>

<div id="outline-container-sec-151" class="outline-2">
<h2 id="sec-151"><span class="section-number-2">151</span> <code>inverse</code></h2>
<div class="outline-text-2" id="text-151">

<p>
The operation inverse computes the mathematical inverse of a square matrix A returning a square matrix of the same shape.  If A is singular within numerical limits, the result is the fault ?singular.  The name <code>inv</code> is provided as an abbreviation.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seed</span> 0.5;
A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">ceiling</span> (100. <span style="color: #ff00ff; font-weight: bold;">*</span> (3 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">random</span> 9))
</pre>
</div>
<pre class="example">
50 44 13
78 74 90
98 67 17
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">inverse</span> A
</pre>
</div>
<pre class="example">
-0.0736442  0.00189821  0.0462669
  0.115652 -0.00654341  -0.053798
-0.0312664   0.0148461 0.00413593
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">innerproduct</span> <span style="color: #ffffff; font-weight: bold;">inverse</span> A
</pre>
</div>
<pre class="example">
         1. -6.93889e-18 -7.11237e-17
 9.4369e-16           1. -1.97758e-16
3.60822e-16 -6.93889e-18           1.
</pre>

<p>
The final computation shows that the result is not always an exact inverse due to roundoff errors introduced by using floating point arithmetic.
</p>
</div>

<div id="outline-container-sec-151-1" class="outline-3">
<h3 id="sec-151-1"><span class="section-number-3">151.1</span> Equations</h3>
<div class="outline-text-3" id="text-151-1">
<div class="org-src-container">

<pre class="src src-nial">A a square matrix ==&gt; A <span style="color: #ffffff; font-weight: bold;">innerproduct</span> (<span style="color: #ffffff; font-weight: bold;">inverse</span> A) <span style="color: #ffffff; font-weight: bold;">innerproduct</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A   (within roundoff error)
<span style="color: #ffffff; font-weight: bold;">inverse</span> A <span style="color: #ffffff; font-weight: bold;">innerproduct</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">solve</span> B   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-152" class="outline-2">
<h2 id="sec-152"><span class="section-number-2">152</span> <code>isboolean</code></h2>
<div class="outline-text-2" id="text-152">

<p>
The operation isboolean tests whether or not A is a boolean atom.  It returns true if A is a boolean, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isboolean</span> <span style="color: #ffffff; font-weight: bold;">false</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isboolean</span> llollool
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isboolean</span> 7
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-152-1" class="outline-3">
<h3 id="sec-152-1"><span class="section-number-3">152.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-152-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isboolean</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> o }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-153" class="outline-2">
<h2 id="sec-153"><span class="section-number-2">153</span> <code>ischar</code></h2>
<div class="outline-text-2" id="text-153">

<p>
The operation ischar tests whether or not atom A is a character atom.  It returns true if A is a character, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">ischar</span> (`a) (<span style="color: #00ff00;">'a'</span>) 7
</pre>
</div>
<pre class="example">
loo
</pre>


<p>
In the example 'a' is not an atom; it is a solitary holding `a.
</p>
</div>

<div id="outline-container-sec-153-1" class="outline-3">
<h3 id="sec-153-1"><span class="section-number-3">153.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-153-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ischar</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> ` }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-154" class="outline-2">
<h2 id="sec-154"><span class="section-number-2">154</span> <code>isfault</code></h2>
<div class="outline-text-2" id="text-154">

<p>
The operation isfault tests whether or not A is a fault.  It returns true if A is a fault, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isfault</span> (?<span style="color: brightred;">?error</span>) ("<span style="color: brightred;">?error</span>)
</pre>
</div>
<pre class="example">
lo
</pre>
</div>

<div id="outline-container-sec-154-1" class="outline-3">
<h3 id="sec-154-1"><span class="section-number-3">154.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-154-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isfault</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> ?? }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-155" class="outline-2">
<h2 id="sec-155"><span class="section-number-2">155</span> <code>isinteger</code></h2>
<div class="outline-text-2" id="text-155">

<p>
The operation isinteger tests whether or not A is an integer.  It returns true if A is an integer, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> (7)(2 3 4)(`3)(3.0)
</pre>
</div>
<pre class="example">
looo
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isinteger</span> (`a <span style="color: #ffffff; font-weight: bold;">find</span> <span style="color: #00ff00;">'whale'</span>)
</pre>
</div>
<pre class="example">
l
</pre>


<p>
The last example returns true because the result of `a find 'whale' is an integer, since the second argument of find is a list.
</p>
</div>

<div id="outline-container-sec-155-1" class="outline-3">
<h3 id="sec-155-1"><span class="section-number-3">155.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-155-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isinteger</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 0 }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-156" class="outline-2">
<h2 id="sec-156"><span class="section-number-2">156</span> <code>isphrase</code></h2>
<div class="outline-text-2" id="text-156">

<p>
The operation isphrase tests whether or not A is a phrase.  It returns true if A is a phrase, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isphrase</span> <span style="color: #ffaf00;">"Mike</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isphrase</span> <span style="color: #00ff00;">'abc'</span>
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isphrase</span>  `a
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-156-1" class="outline-3">
<h3 id="sec-156-1"><span class="section-number-3">156.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-156-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isphrase</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> "" }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-157" class="outline-2">
<h2 id="sec-157"><span class="section-number-2">157</span> <code>isreal</code></h2>
<div class="outline-text-2" id="text-157">

<p>
The operation isreal tests whether or not A is a real number.  It returns true if A is a real number, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isreal</span> 3.5
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isreal</span> <span style="color: #00ff00;">'abc'</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-157-1" class="outline-3">
<h3 id="sec-157-1"><span class="section-number-3">157.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-157-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isreal</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 0.  }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-158" class="outline-2">
<h2 id="sec-158"><span class="section-number-2">158</span> <code>isstring</code></h2>
<div class="outline-text-2" id="text-158">

<p>
The operation isstring tests whether or not the array A is a string.  It returns true if A is a string, false otherwise.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> <span style="color: #00ff00;">'A string'</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> `A
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> `2 `A `?
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
l
</pre>
</div>

<div id="outline-container-sec-158-1" class="outline-3">
<h3 id="sec-158-1"><span class="section-number-3">158.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-158-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">OP</span> A { <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 1 <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">ischar</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-158-2" class="outline-3">
<h3 id="sec-158-2"><span class="section-number-3">158.2</span> Equations</h3>
<div class="outline-text-3" id="text-158-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">atomic</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">isstring</span> <span style="color: #ffffff; font-weight: bold;">string</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-159" class="outline-2">
<h2 id="sec-159"><span class="section-number-2">159</span> item</h2>
<div class="outline-text-2" id="text-159">

<p>
An array A is said to be an item of array B if B holds A at one or more locations. The term is a relative one; we cannot speak of item except in reference to the array that holds it.  The items of an array A are the objects at the locations at the top level.
</p>

<p>
The number of items in an array is called the tally of the array.  Because an array is rectangular, the tally is the product of the shape.
</p>

<p>
The following names are give to common array structures:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right"># of items</th>
<th scope="col" class="right"># of axes</th>
<th scope="col" class="left">Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="right">1</td>
<td class="left">empty list</td>
</tr>

<tr>
<td class="right">1</td>
<td class="right">0</td>
<td class="left">single</td>
</tr>

<tr>
<td class="right">1</td>
<td class="right">1</td>
<td class="left">solitary</td>
</tr>

<tr>
<td class="right">1</td>
<td class="right">2</td>
<td class="left">1 by 1 table</td>
</tr>

<tr>
<td class="right">2</td>
<td class="right">1</td>
<td class="left">pair</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">1</td>
<td class="left">triple</td>
</tr>

<tr>
<td class="right">4</td>
<td class="right">1</td>
<td class="left">quadruple</td>
</tr>
</tbody>
</table>

<p>
The arrays of Nial are a recursive data type.  That is, the items of an array are also arrays.  Since an array has arrays as items, it may contain data at lower levels than the top one.  A path is a list of addresses that describes a data object at some depth within the array.
</p>

<p>
An array is said to be simple if all its items are atomic.
</p>

<p>
A part of an array is a data object that is contained at some level within the array.  The atomic parts of an array are called the leaves of the array.  The simple parts are called twigs.  The term level is used informally to describe the relative position of a part within the nesting structure of an array.  An item is at the first or top level, an item of an item is at the second level, etc.
</p>

<p>
An empty array is one that has no items.
</p>
</div>
</div>

<div id="outline-container-sec-160" class="outline-2">
<h2 id="sec-160"><span class="section-number-2">160</span> <code>ITERATE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-160">

<p>
The transformer <i>=ITERATE=</i> is used to apply the operation f sequentially to the items of A in row major order.  (Row major order means across the rows moving left to right, starting at the top row and then going down the rows.  An example is given under <a href="#sec-171">171</a>.) The result is the result of applying f to the final item.  If A has no items, the result is the fault ?noexpr.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ITERATE</span> <span style="color: #ffffff; font-weight: bold;">write</span> <span style="color: #ffaf00;">"Hello</span> <span style="color: #ffaf00;">"out</span> <span style="color: #ffaf00;">"there</span>.
</pre>
</div>
<pre class="example">
Hello
out
there.
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">EXTERNAL</span> <span style="color: #ffffff; font-weight: bold;">VARIABLE</span>;
accum <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> B { <span style="color: #ffffff; font-weight: bold;">NONLOCAL</span> A; A <span style="color: #ff00ff;">:=</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> B };
A <span style="color: #ff00ff;">:=</span> 20;
<span style="color: #ffff00;">ITERATE</span> accum 3 4 5 ; A
</pre>
</div>
<pre class="example">
32
</pre>

<p>
In the second example, the operation accum increments variable A by the argument value.  The example shows ITERATE being used to apply accum to the list 3 4 5, which results in A having the values 23, 27 and 32.
</p>

<p>
With <i>=ITERATE=</i>, an operation that has a side effect can be applied to an array of arguments sequentially in a specific sequence.  On the other hand, the order of application is undefined for <i>=EACH=</i>.
</p>

<p>
A second major difference between <i>=EACH=</i> and <i>=ITERATE=</i> is that <i>=ITERATE=</i> returns only the result of the last application whereas <i>=EACH=</i> returns the array of all the results.
</p>
</div>

<div id="outline-container-sec-160-1" class="outline-3">
<h3 id="sec-160-1"><span class="section-number-3">160.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-160-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">ITERATE</span> <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">TR</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #00ffff;">FOR</span> X <span style="color: #00ffff;">WITH</span> A <span style="color: #00ffff;">DO</span> f A <span style="color: #00ffff;">ENDFOR</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-161" class="outline-2">
<h2 id="sec-161"><span class="section-number-2">161</span> <i>juxtaposition</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span>&#xa0;<span class="table">table</span></span></h2>
<div class="outline-text-2" id="text-161">

<p>
The syntax rules for simple-expressions show three uses of the side-by-side or juxtapositional notation of Nial: strand formation, prefix operation application and infix operation application.  There are no syntactic restrictions as to whether or not a particular operation may be applied in infix or prefix form.  A fault is returned at run time if an operation is used inappropriately.
</p>

<p>
<b>Summary of Juxtapositional Syntax</b>
</p>

<p>
The following table illustrates the uses of juxtaposition in Nial, where A and B are array-expressions, f and g are operation-expressions, and T is a transformer:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Form</th>
<th scope="col" class="left">Name</th>
<th scope="col" class="left">Object</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">A B</td>
<td class="left">strand</td>
<td class="left">array</td>
</tr>

<tr>
<td class="left">A f</td>
<td class="left">currying</td>
<td class="left">operation</td>
</tr>

<tr>
<td class="left">f A</td>
<td class="left">prefix use</td>
<td class="left">array</td>
</tr>

<tr>
<td class="left">f g</td>
<td class="left">composition</td>
<td class="left">operation</td>
</tr>

<tr>
<td class="left">T f</td>
<td class="left">transform</td>
<td class="left">operation</td>
</tr>

<tr>
<td class="left">A f B</td>
<td class="left">infix use</td>
<td class="left">array</td>
</tr>

<tr>
<td class="left">T f A</td>
<td class="left">transform use</td>
<td class="left">array</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-162" class="outline-2">
<h2 id="sec-162"><span class="section-number-2">162</span> <code>laminate</code></h2>
<div class="outline-text-2" id="text-162">
<p>
:Class:  construction operation
:Usage:  I laminate A   laminate I A
:SeeAlso: link, catenate
:END:
</p>

<p>
The operation laminate merges the items of A adding a new axis before axis I of the items.  The items of A must be of the same shape.
</p>

<p>
The following example creates a three dimensional array from two tables, placing the new axes at the front:
</p>

<div class="org-src-container">

<pre class="src src-nial">0 <span style="color: #ffffff; font-weight: bold;">laminate</span> (<span style="color: #ffffff; font-weight: bold;">tell</span> 2 3) (<span style="color: #ffffff; font-weight: bold;">count</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+  +---+---+---+
|0 0|0 1|0 2|  |1 1|1 2|1 3|
+---+---+---+  +---+---+---+
|1 0|1 1|1 2|  |2 1|2 2|2 3|
+---+---+---+  +---+---+---+
</pre>
</div>

<div id="outline-container-sec-162-1" class="outline-3">
<h3 id="sec-162-1"><span class="section-number-3">162.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-162-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">laminate</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> I A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #00ffff;">THEN</span>
      Axesofitems <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">axes</span> <span style="color: #ffffff; font-weight: bold;">first</span> A;
      <span style="color: #ffffff; font-weight: bold;">link</span> (I <span style="color: #ffffff; font-weight: bold;">take</span> Axesofitems) (I <span style="color: #ffffff; font-weight: bold;">drop</span> Axesofitems <span style="color: #ff00ff; font-weight: bold;">+</span> 1) <span style="color: #ffffff; font-weight: bold;">blend</span> A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?conform error in laminate'</span>
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-163" class="outline-2">
<h2 id="sec-163"><span class="section-number-2">163</span> <code>last</code></h2>
<div class="outline-text-2" id="text-163">

<p>
The operation last returns the last of the items of A.  If A is empty, it returns the fault ?address.  The operation last is a special case of pick (because first is defined in terms of pick) and its behaviour is determined by that of pick.  Every nonempty array has a last item.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">last</span> 4 5 6
</pre>
</div>
<pre class="example">
6
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
2 3
</pre>
</div>

<div id="outline-container-sec-163-1" class="outline-3">
<h3 id="sec-163-1"><span class="section-number-3">163.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-163-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-163-2" class="outline-3">
<h3 id="sec-163-2"><span class="section-number-3">163.2</span> Equations</h3>
<div class="outline-text-3" id="text-163-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">last</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-164" class="outline-2">
<h2 id="sec-164"><span class="section-number-2">164</span> <span class="todo TODO">TODO</span> <code>latent</code></h2>
<div class="outline-text-2" id="text-164">

<p>
The expression Latent is used to name an expression to be executed without user intervention when the workspace is loaded.  Latent is used in closed applications so that an application can be started when the workspace is loaded.  Latent can establish any default or initial conditions desired.
</p>

<div class="org-src-container">

<pre class="src src-nial">Latent <span style="color: #00ffff;">IS</span> {
   <span style="color: #ffffff; font-weight: bold;">settrigger</span> o;
   <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"log</span>;
   StartApp;
   <span style="color: #ffffff; font-weight: bold;">Bye</span>; }
</pre>
</div>

<p>
The number of levels to reach an atom along each path need not be the same.  For example, in the following array, the phrase "hello is at the fiIn the example, Latent is defined to turn of triggering of faults, to turn on session logging, to start the application and then to terminate the session.
</p>
</div>
</div>

<div id="outline-container-sec-165" class="outline-2">
<h2 id="sec-165"><span class="section-number-2">165</span> <code>LEAF</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-165">

<p>
The transformer <i>=LEAF=</i> modifies an operation f into an operation that applies f to every atom of the argument A.  The result of applying LEAF f to A has the same shape as A.  If f maps atoms to atoms, the result has the same structure as A.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+
|0 0|0 1|0 2|
+---+---+---+
|1 0|1 1|1 2|
+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">LEAF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
</pre>
</div>
<pre class="example">
+---+---+---+
|1 1|1 1|1 1|
+---+---+---+
|1 1|1 1|1 1|
+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> (2 3) (1 2)
</pre>
</div>
<pre class="example">
+---+---+
|2 3|1 2|
+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">LEAF</span> <span style="color: #ffffff; font-weight: bold;">tell</span> B
</pre>
</div>
<pre class="example">
+-----------+-------+
|+---+-----+|+-+---+|
||0 1|0 1 2|||0|0 1||
|+---+-----+|+-+---+|
+-----------+-------+
</pre>

<p>
The first example shows that the result of applying a LEAF transform to a table is a table of the same shape.  The atoms have been mapped to 1 since the tally of an atom is 1.  The second example shows that applying a LEAF transform to a list gives a list of the same length.  However, the structure of the result is not preserved in this example because tell maps an integer to a list of integers.
</p>
</div>

<div id="outline-container-sec-165-1" class="outline-3">
<h3 id="sec-165-1"><span class="section-number-3">165.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-165-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">LEAF</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">atomic</span> A <span style="color: #00ffff;">THEN</span>
      f A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffff00;">EACH</span> (<span style="color: #ffff00;">LEAF</span> f) A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-165-2" class="outline-3">
<h3 id="sec-165-2"><span class="section-number-3">165.2</span> Equations</h3>
<div class="outline-text-3" id="text-165-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">LEAF</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
f unary pervasive ==&gt; <span style="color: #ffff00;">LEAF</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> f A
(<span style="color: #ffff00;">LEAF</span> f) (<span style="color: #ffff00;">LEAF</span> g) A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">LEAF</span> (f g) A
<span style="color: #ffff00;">LEAF</span> f <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffff00;">LEAF</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-166" class="outline-2">
<h2 id="sec-166"><span class="section-number-2">166</span> level</h2>
<div class="outline-text-2" id="text-166">

<p>
The term level is used informally to describe the relative position of a part within the nesting structure of an array.  An item is at the first or top level, an item of an item is at the second level, etc.
</p>

<p>
An atom is viewed in two ways.  As an indivisible data object it is viewed as having no levels and cannot be broken into subarrays.  As an array data structure it is viewed as a single holding itself and therefore has an infinity of levels.  This view is necessary for atomic arrays to fit the theory of nested array mathematics.
rst level, the integer 23 is at the second level and the character `b is at the third level.
</p>

<div class="org-src-container">

<pre class="src src-nial">[ 23 <span style="color: #00ff00;">'abc'</span>, <span style="color: #ffaf00;">"hello</span> , <span style="color: #ffffff; font-weight: bold;">tell</span> 2 2 ]
</pre>
</div>
<pre class="example">
+------------+-----+-------------+
|+--+-------+|hello|+-----+-----+|
||23|+-+-+-+||     ||+-+-+|+-+-+||
||  ||a|b|c|||     |||0|0|||0|1|||
||  |+-+-+-+||     ||+-+-+|+-+-+||
|+--+-------+|     |+-----+-----+|
|            |     ||+-+-+|+-+-+||
|            |     |||1|0|||1|1|||
|            |     ||+-+-+|+-+-+||
|            |     |+-----+-----+|
+------------+-----+-------------+
</pre>

<p>
Some of the operations of Nial that operate on simple arrays are extended to arbitrarily nested arrays by being applied to the atoms at the deepest level.  These are called pervasive operations.
</p>
</div>
</div>

<div id="outline-container-sec-167" class="outline-2">
<h2 id="sec-167"><span class="section-number-2">167</span> <code>libpath</code></h2>
<div class="outline-text-2" id="text-167">

<p>
The variable Libpath is used by the operation library as a list of paths to directories that are to be checked for the definition file named in the library argument.  The directories defined by Libpath are searched before the system dependent library directories.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Libpath</span> <span style="color: #ff00ff;">:=</span> [<span style="color: #00ff00;">'mydefs'</span>,<span style="color: #00ff00;">'mylib\newdefs'</span>];
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-168" class="outline-2">
<h2 id="sec-168"><span class="section-number-2">168</span> <code>library</code></h2>
<div class="outline-text-2" id="text-168">

<p>
The operation library loads a definition from the Q'Nial library of definition files.  Nm is the name of a library file as a phrase or string.  The name is augmented with the path information for the library and loaded into the workspace using loaddefs.
</p>

<p>
Sw, an optional argument, is either 0 (the default) or 1.  If Sw is 0, there is no display of the file as it is loaded.  If Sw is 1, the file is displayed as the file is read.
</p>

<p>
Some of the programs in the library are grouped in definition files by function.  When such a file is specified, all the definitions in the file are loaded.  If it is desired to load only one operation from a definition file which contains several operations, it is necessary to edit the library file in order to isolate the desired operation in one file.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">library</span> <span style="color: #ffaf00;">"labeltable</span>
</pre>
</div>

<p>
Library searches for files using paths that are provided in its definition.  Before searching for system defined directories, it searches in the directories named in the global variable Libpath, which is empty by default.
</p>

<p>
To modify Libpath, either edit the standard definitions file defs.ndf, or assign it a value dynamically.
</p>
</div>
</div>

<div id="outline-container-sec-169" class="outline-2">
<h2 id="sec-169"><span class="section-number-2">169</span> <code>like</code></h2>
<div class="outline-text-2" id="text-169">

<p>
The operation like compares two arrays A and B and returns true if all the items of A are items of B and vice versa.  Otherwise it returns false.  The operation like corresponds to set equality at the first level of nesting.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">like</span> 3 2 2 3 2
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">like</span> 3 2 4
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'hello world'</span> <span style="color: #ffffff; font-weight: bold;">like</span> <span style="color: #00ff00;">'whole door'</span>
</pre>
</div>
<pre class="example">
l
</pre>
</div>

<div id="outline-container-sec-169-1" class="outline-3">
<h3 id="sec-169-1"><span class="section-number-3">169.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-169-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">like</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { (A <span style="color: #ffffff; font-weight: bold;">allin</span> B) <span style="color: #ffffff; font-weight: bold;">and</span> (B <span style="color: #ffffff; font-weight: bold;">allin</span> A)}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-170" class="outline-2">
<h2 id="sec-170"><span class="section-number-2">170</span> <code>link</code></h2>
<div class="outline-text-2" id="text-170">

<p>
The operation link returns the list of the items of the items of its argument.  If it is applied to a pair of arrays A and B, the result is the items of A followed by the items of B.
</p>

<p>
If link is applied to an arbitrary array A, the items of the first item of A are followed by the items of the second item of A, etc.
</p>

<p>
If A is empty, the result is Null.  If A is not empty but there are no items in all the items of A, the result is also Null.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 5 4 7 2 <span style="color: #ffffff; font-weight: bold;">link</span> 2 4 6 8
</pre>
</div>
<pre class="example">
2 3 5 4 7 2 2 4 6 8
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #00ff00;">'hen'</span> <span style="color: #00ff00;">'hello'</span> <span style="color: #00ff00;">'eh'</span>
</pre>
</div>
<pre class="example">
henhelloeh
</pre>

<p>
The first example shows that the link of two lists of length 6 and 4 is a list of length 10.  The second example illustrates the linking of three strings.
</p>

<p>
Link is similar to a set-union operation, although it does not remove duplicates in the representation.  The composition of cull with link may be more appropriate as a union operation.
</p>
</div>

<div id="outline-container-sec-170-1" class="outline-3">
<h3 id="sec-170-1"><span class="section-number-3">170.1</span> Equations</h3>
<div class="outline-text-3" id="text-170-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
<span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffff00;">EACH</span> f A
<span style="color: #ffffff; font-weight: bold;">simple</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">simple</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">content</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-171" class="outline-2">
<h2 id="sec-171"><span class="section-number-2">171</span> <code>list</code></h2>
<div class="outline-text-2" id="text-171">

<p>
The operation <a href="#sec-171">171</a> returns the list of the items of A in row major order.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 24
</pre>
</div>
<pre class="example">
1  2  3  4   13 14 15 16
5  6  7  8   17 18 19 20
9 10 11 12   21 22 23 24
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">list</span> A
</pre>
</div>
<pre class="example">
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
+---+
|abc|
+---+
</pre>

<p>
The first example shows row major order for a table.  The second example shows that the list of an atom is the solitary holding the atom.
</p>
</div>

<div id="outline-container-sec-171-1" class="outline-3">
<h3 id="sec-171-1"><span class="section-number-3">171.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-171-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-171-2" class="outline-3">
<h3 id="sec-171-2"><span class="section-number-3">171.2</span> Equations</h3>
<div class="outline-text-3" id="text-171-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffff00;">EACH</span> f A
<span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-172" class="outline-2">
<h2 id="sec-172"><span class="section-number-2">172</span> <code>ln</code></h2>
<div class="outline-text-2" id="text-172">

<p>
The operation <a href="#sec-172">172</a> implements the natural logarithm function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">natural logarithm of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">natural logarithm of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">real natural logarithm if A &gt; 0.0; ?ln if A &lt;= 0.0</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?ln</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?ln</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">ln</span>  l  2  3.5   `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0. 0.693147 1.25276 ?ln ?ln ?error
</pre>
</div>

<div id="outline-container-sec-172-1" class="outline-3">
<h3 id="sec-172-1"><span class="section-number-3">172.1</span> Equation</h3>
<div class="outline-text-3" id="text-172-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 0 ==&gt; <span style="color: #ffffff; font-weight: bold;">exp</span> <span style="color: #ffffff; font-weight: bold;">ln</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-173" class="outline-2">
<h2 id="sec-173"><span class="section-number-2">173</span> <code>load</code></h2>
<div class="outline-text-2" id="text-173">

<p>
The operation load is used to retrieve the saved workspace named by the phrase or string Wsname.  The convention in Q'Nial is to save workspaces with a file name extension of the form .nws to make it easy to identify workspace files in the file system.  When saving or loading a workspace, the extension may be omitted.
</p>

<p>
The effect of loading a workspace is to replace the current workspace with the saved one.  To keep the contents of the current workspace, save should be used prior to doing a load.
</p>

<p>
The operation load may be used within a defined expression or operation.  However, in such a use, it interrupts the execution of the operation or expression and does the load as though the operation were entered at top level.
</p>

<p>
If a workspace contains an expression with the name Latent, load executes Latent when the load is complete.  This mechanism can be used to have the load of a workspace automatically begin an application or to chain execution of workspaces.
</p>

<p>
There is no mechanism to obtain individual objects saved in a workspace.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">load</span> <span style="color: #ffaf00;">"mywork</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-174" class="outline-2">
<h2 id="sec-174"><span class="section-number-2">174</span> <code>loaddefs</code></h2>
<div class="outline-text-2" id="text-174">

<p>
The operation loaddefs is used to load Nial actions (definitions or expressions) from the file named by the phrase or string Deffilename.  The convention in Q'Nial is to name Nial definition files with a file name extension of the form .ndf to make it easy to identify such files in the file system.
</p>

<p>
When loading a file with loaddefs, the file extension may be omitted.  The operation may have an optional second argument to specify the mode of loading.  If mode is 0 or if it is omitted, the actions are not displayed as they are processed.  If it is 1, the actions are displayed.
</p>

<p>
The file of actions consists of groups of lines that are treated as a unit.  These lines are separated by a blank line.  If the first character in the first line of the group is #, the group is a remark and is not processed.
</p>

<p>
Several lines, up to a blank line, are treated as one long line.  No blank spaces are inserted between the end of one line and the beginning of another.  Thus, care should be taken to ensure that identifiers are not joined together.
</p>

<p>
If a syntax error is detected when a definition is being loaded, the definition is not installed.  The absence of the erroneous definition may cause subsequent definitions in the file to fail also.  If any errors are detected, the number of errors is displayed when loaddefs ends.  Only the first syntax error found in each action is reported.
</p>

<p>
The backslash character,  \ , which is used to continue a line of a definition in immediate mode, must not be inserted at the end of lines in a definition file.
</p>

<p>
The tab characters, if they exist in a definition file, are treated as though they are space characters.  Since some editor programs insert tabs automatically, the display of the file on input may be different from the display using the editor.
</p>

<p>
A definition file may contain uses of loaddefs.  For a large application with many definition files, it is a goo=d idea to have one file which= can construct the application by using loaddefs to bring in the other files in an appropriate order.  Loaddefs can also be used to execute a script of Nial expressions.  This feature is convenient when simulating a Q'Nial session and capturing its output in a log file.
</p>
</div>
</div>

<div id="outline-container-sec-175" class="outline-2">
<h2 id="sec-175"><span class="section-number-2">175</span> local environment</h2>
<div class="outline-text-2" id="text-175">

<p>
A local environment is a collection of associations that are known within a limited section of program text.  These limited sections are formed by blocks, operation-forms and transformer-forms as discussed in the relevant sections below.  A name that has a local association in one of these forms is said to have local scope.
</p>

<p>
Program fragments in which local variables are being assigned can be nested, so that one local scope surrounds another.  A local association is not visible outside the construct in which it is defined; and a name with local scope can hide associations that the name has in surrounding scopes.
</p>

<p>
At any point in a program fragment, there is a current environment consisting of all names whose associations are visible.  It includes the names having local scope in the program fragment being executed, names that are visible in the surrounding scopes and names that have global scope.
</p>

<p>
In program text, the scope of all names is determined by the static structure of the program text.  The one exception is text that has the operation execute applied to it under program control.
</p>

<p>
In a local environment, a variable identifier can be chosen the same as a predefined or user-defined global definition name.  Such a choice makes the global use of the name unavailable in the local context.
</p>

<p>
In any context, an identifier can name only one of: a variable, an array- expression, an operation-expression, or a transformer-expression.  During one session, the role of a name, i.e.  the class of syntactic object it names, cannot be changed.
</p>

<p>
If a block is used as a primary-expression, the local environment created by a block is determined by the block itself.  If it is the body of an operation-form, the local environment includes the formal parameter names of the operation-form as variables.
</p>

<p>
A block delimits a local environment.  It allows new uses of names which do not interfere with uses of those names outside the block.  For example, within a block, a predefined operation name can be redefined and used for a different purpose.  Only the reserved words of Q'Nial cannot be reused in this fashion.  Definitions that appear within the block have local scope.  That is, the definitions can be referenced only in the body of the block.  Variables assigned within the block may or may not have local scope, depending on the appearance of a local and/or a nonlocal declaration.  If there is no declaration, all assigned variables have local scope.  Declaring some variables as local does not change the effect on undeclared variables that are used on the left of assignment.  They are automatically localized.
</p>

<p>
If a nonlocal declaration is used, an assigned name that is on the nonlocal list is sought in surrounding scopes.  If the name is not found, a variable is created in the global environment.
</p>

<p>
During the parse of the assign-expression appearing in a block, each name on the variable list is sought in the local environment.  If the name exists in the local environment, the assignment affects the local association.  If a name does not exist in the local environment and no reference has been made to a nonlocal variable with the same name, a local variable is created in the block.  An assign-expression parsed in the global environment creates a global variable if a variable with that name does not already exist.
</p>

<p>
An operation-form defines a local environment.  The formal parameter names are names of local variables.  If the body of the operation form is a block, the local environment of the block is extended to include the formal parameters.  When the operation is applied, the formal parameter names are assigned from the value of the actual argument.  If there is only one formal parameter, the actual argument is assigned to it as a whole; otherwise, the items of the actual argument are assigned to the formal parameters in corresponding order.  If there is a length mismatch between the list of formal parameter names and the values of the actual argument, the fault ?op<sub>parameter</sub> is returned.
</p>

<p>
The value of the application of the operation is the value of the body of the operation-form, which is evaluated with the local variables in the parameter list assigned as described above.  In determining the association for a name that appears in the body of an operation form, Q'Nial looks for the name in the local environment.  If the name is not found locally, the name is sought in surrounding environments until it is found or until the global environment is searched.  If it is not found, a fault ?unknown identifier: is given when the operation-form is analyzed (parsed).
</p>

<p>
Operation-forms are most frequently used in definitions where they are given an associated name.  However, an operation-form can appear directly in an expression provided it is enclosed in parentheses.  In this usage, it can be an argument to a transformer name or can be applied to an array argument.
</p>

<p>
The operation execute can be used within the execution of a block to make an assignment to variables or to invoke the definition mechanism.  If execute is used to make a new definition or to create a new variable, the resulting variable or definition is placed in the global environment.  However, if the block has local variables or local definitions, execute can be used to change a local version dynamically.  A similar situation occurs with dynamic alteration of variables using assign.
</p>
</div>
</div>

<div id="outline-container-sec-176" class="outline-2">
<h2 id="sec-176"><span class="section-number-2">176</span> <code>log</code></h2>
<div class="outline-text-2" id="text-176">

<p>
The operation log implements the base 10 logarithm function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">base 10 logarithm of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">base 10 logarithm of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">real base 10 logarithm if A &gt; 0.0; ?log if A &lt;= 0.0</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?log</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?log</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">log</span>  l  2  3.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0. 0.30103 0.544068 ?log ?log ?error
</pre>
</div>

<div id="outline-container-sec-176-1" class="outline-3">
<h3 id="sec-176-1"><span class="section-number-3">176.1</span> Equation</h3>
<div class="outline-text-3" id="text-176-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 0 ==&gt; 10. <span style="color: #ffffff; font-weight: bold;">power</span> <span style="color: #ffffff; font-weight: bold;">log</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A (within roundoff error)
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-177" class="outline-2">
<h2 id="sec-177"><span class="section-number-2">177</span> log file</h2>
<div class="outline-text-2" id="text-177">

<p>
Q'Nial provides a facility to record the actions in a session in a text file.  The default name for the log file is auto.nlg.  Logging is initiated by:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"log</span>
</pre>
</div>
<pre class="example">
nolog
</pre>

<p>
Logging is ended by:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"nolog</span>
</pre>
</div>
<pre class="example">
log
</pre>

<p>
The log file name can be changed using:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setlogname</span> <span style="color: #ffaf00;">"newname</span>
</pre>
</div>
<pre class="example">
auto.nlg
</pre>

<p>
A log file is opened and closed on each usage by the internal logging routine.  As a result, the log file is always available if the session is terminated unexpectedly.  If a file with the name of the log file exists when set "log is executed, the logging information is appended at the end.
</p>
</div>
</div>

<div id="outline-container-sec-178" class="outline-2">
<h2 id="sec-178"><span class="section-number-2">178</span> <code>lower</code></h2>
<div class="outline-text-2" id="text-178">

<p>
The operation lower is used to partition an array A along its axes by indicating that the last N axes are to become axes of the items of the result.  The remaining axes become the axes of the result.  N must be an integer in the range from 0 to valence A.  The result is an array of shape given by dropping the last N items of shape A.  The items of the result have the shape given by taking the last N items of shape A.  Thus, the 1 lower of an array of shape 3 4 2 is a 3 by 4 table of pairs.  The 2 lower of the same array is a triple of 4 by 2 tables.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 3 4 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'ABCDEFGHIJKLMNOPQRSTUVWX'</span>
</pre>
</div>
<pre class="example">
AB  IJ  QR
CD  KL  ST
EF  MN  UV
GH  OP  WX
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">lower</span> A
</pre>
</div>
<pre class="example">
+--+--+--+--+
|AB|CD|EF|GH|
+--+--+--+--+
|IJ|KL|MN|OP|
+--+--+--+--+
|QR|ST|UV|WX|
+--+--+--+--+
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">lower</span> A
</pre>
</div>
<pre class="example">
+--+--+--+
|AB|IJ|QR|
|CD|KL|ST|
|EF|MN|UV|
|GH|OP|WX|
+--+--+--+
</pre>
</div>

<div id="outline-container-sec-178-1" class="outline-3">
<h3 id="sec-178-1"><span class="section-number-3">178.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-178-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">lower</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> N <span style="color: #ffffff; font-weight: bold;">raise</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-178-2" class="outline-3">
<h3 id="sec-178-2"><span class="section-number-3">178.2</span> Equations</h3>
<div class="outline-text-3" id="text-178-2">
<div class="org-src-container">

<pre class="src src-nial">N a nonnegative integer <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> (N <span style="color: #ffffff; font-weight: bold;">lower</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opp</span> N <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> (N <span style="color: #ffffff; font-weight: bold;">drop</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opp</span> N <span style="color: #ffffff; font-weight: bold;">take</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> (N <span style="color: #ffffff; font-weight: bold;">lower</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-179" class="outline-2">
<h2 id="sec-179"><span class="section-number-2">179</span> <code>lt</code></h2>
<div class="outline-text-2" id="text-179">

<p>
The operation lt compares two atoms A and B with the less than relation, returning true if A is less than B and false otherwise.  Symbol &lt; is a synonym for lt.
</p>

<p>
The atoms in Nial are organized as a lattice using &lt;= for the ordering.  The numeric atoms are comparable across types but literal atoms are not comparable with numeric atoms.  The literal types are not comparable across types.  A comparison between incomparable objects results in false.
</p>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ff00ff;">:=</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">&lt;</span> R
</pre>
</div>
<pre class="example">
ollooo
oolooo
oooooo
oooooo
oooooo
oooooo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'apple'</span> <span style="color: #ff00ff; font-weight: bold;">&lt;</span> <span style="color: #00ff00;">'above'</span>
</pre>
</div>
<pre class="example">
ooolo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"apple</span> <span style="color: #ff00ff; font-weight: bold;">&lt;</span> <span style="color: #ffaf00;">"above</span>
</pre>
</div>
<pre class="example">
o
</pre>


<p>
The use of OUTER &lt; shows the comparisons between various atom types.  The last two examples show the difference between comparing two strings, where the operation is distributed by its pervasive property; and comparing the corresponding phrases.
</p>
</div>

<div id="outline-container-sec-179-1" class="outline-3">
<h3 id="sec-179-1"><span class="section-number-3">179.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-179-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">lt</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B ( ( A <span style="color: #ffffff; font-weight: bold;">lte</span> B ) <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> ( A <span style="color: #ffffff; font-weight: bold;">mate</span> B ) )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-180" class="outline-2">
<h2 id="sec-180"><span class="section-number-2">180</span> <code>lte</code></h2>
<div class="outline-text-2" id="text-180">

<p>
The operation lte compares two atoms A and B with the less than or equal relation, returning true if A is less than B and false otherwise.  The symbol &lt;= is a synonym for lte.
</p>

<p>
The atoms in Nial are organized as a lattice using &lt;= for the ordering.  The numeric atoms are comparable across types but numeric and literal atoms are incomparable.  The literal types are not comparable across types.  A comparison between incomparable objects results in false.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ff00ff;">:=</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>



<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> R
</pre>
</div>
<pre class="example">
lllooo
ollooo
oolooo
oooloo
oooolo
oooool
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'apple'</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #00ff00;">'above'</span>
</pre>
</div>
<pre class="example">
loolo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"apple</span> <span style="color: #ff00ff; font-weight: bold;">&lt;</span> <span style="color: #ffaf00;">"above</span>
</pre>
</div>
<pre class="example">
o
</pre>


<p>
The use of OUTER &lt;= shows the comparisons between various atom types.  The last two examples show the difference between comparing two strings, where the operation is distributed by its pervasive property; and comparing the corresponding phrases.
</p>
</div>
</div>

<div id="outline-container-sec-181" class="outline-2">
<h2 id="sec-181"><span class="section-number-2">181</span> <code>match</code></h2>
<div class="outline-text-2" id="text-181">

<p>
The operation match compares two atoms A and B for exact equality, returning true if A is equal to B and false otherwise.  Match cannot be used to determine the equality of atoms of different numeric or literal type, as when comparing the real number 3.0 with the integer 3.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">match</span> 3
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial">3.0 <span style="color: #ffffff; font-weight: bold;">match</span> 3
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"o</span> <span style="color: #ffffff; font-weight: bold;">match</span> `o
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">1.0 <span style="color: #ffffff; font-weight: bold;">match</span> l 1 1.0
</pre>
</div>
<pre class="example">
ool
</pre>

<div class="org-src-container">

<pre class="src src-nial">`  <span style="color: #ffffff; font-weight: bold;">match</span> <span style="color: #00ff00;">'a list of letters'</span>
</pre>
</div>
<pre class="example">
olooooloolooooooo
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">match</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
+--+--+--+
|oo|ol|oo|
+--+--+--+
|lo|ll|lo|
+--+--+--+
</pre>

<p>
The second last example shows that the binary pervasive extension of match allows a lists of atoms to be compared for a value, returning a bitstring of results.  The last example shows where in the structure of tell 2 3 a 1 is held.
</p>
</div>
</div>

<div id="outline-container-sec-182" class="outline-2">
<h2 id="sec-182"><span class="section-number-2">182</span> <code>mate</code></h2>
<div class="outline-text-2" id="text-182">

<p>
The operation mate compares two atoms A and B for equality with type coercion, returning true if A is equal to or can be coerced to B as a number; and false otherwise.  Mate is used to determine the equality of atoms of different numeric type, as when comparing the real number 3.0 with the integer 3.  It cannot be used to determine equality of literal types.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">mate</span> 3
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial">3.0 <span style="color: #ffffff; font-weight: bold;">mate</span> 3
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"o</span> <span style="color: #ffffff; font-weight: bold;">mate</span> `o
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">1.0 <span style="color: #ffffff; font-weight: bold;">mate</span> l 1 1.0
</pre>
</div>
<pre class="example">
lll
</pre>

<p>
The last example shows that the binary pervasive extension of mate allows a lists of atoms to be compared for a value, returning a bitstring of results.
</p>
</div>

<div id="outline-container-sec-182-1" class="outline-3">
<h3 id="sec-182-1"><span class="section-number-3">182.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-182-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mate</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { (A <span style="color: #ffffff; font-weight: bold;">lte</span> B) <span style="color: #ffffff; font-weight: bold;">and</span> (B <span style="color: #ffffff; font-weight: bold;">lte</span> A) }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-183" class="outline-2">
<h2 id="sec-183"><span class="section-number-2">183</span> <code>max</code></h2>
<div class="outline-text-2" id="text-183">

<p>
The operation max, when applied to a simple array A, finds the least atom that is greater than or equal to all the items.  If the atoms of A are all positive numbers, for example, max A returns the biggest.  If the items are not comparable, the result is the fault ?I, the atom in the lattice of Nial atoms that is greater than or equal to all other atoms (the zenith).  If A is empty, the result is the fault ?O, the atom that is less than or equal to all other atoms (the nadir).
</p>

<p>
Max is extended to arbitrary arrays by its multi pervasive behaviour.  It is a reductive operation in that it reduces a simple array to a single atom.  Applied to a pair of simple arrays, it produces a simple array with the corresponding items compared.
</p>

<p>
If the items of A are all numeric type, they are comparable.  The result is the highest numeric type represented in the array, where boolean is the lowest numeric type and real number is the highest.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">max</span> 3 45 23 18 3.5
</pre>
</div>
<pre class="example">
45.
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">max</span> 3 <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
?I
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffaf00;">"abc</span> <span style="color: #ffaf00;">"def</span> <span style="color: #ffaf00;">"c</span>
</pre>
</div>
<pre class="example">
def
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #00ff00;">'apples'</span> <span style="color: #00ff00;">'orange'</span>
</pre>
</div>
<pre class="example">
orpngs
</pre>

<p>
The first example shows that max of a list of numbers of different type is the maximum number, coerced to the highest type.  The second shows that the integer 3 and the phrase "abc" are incomparable and the result is the fault ?I.  The third example shows that phrases are directly comparable.  The last shows that strings are compared on a character by character basis.
</p>
</div>

<div id="outline-container-sec-183-1" class="outline-3">
<h3 id="sec-183-1"><span class="section-number-3">183.1</span> Equations</h3>
<div class="outline-text-3" id="text-183-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">max</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">max</span> A
<span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">max</span> A =f= <span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">atomic</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">max</span> B <span style="color: #ffffff; font-weight: bold;">lte</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">and</span> (B <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">lte</span> A)
<span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> ?<span style="color: brightred;">?O</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-184" class="outline-2">
<h2 id="sec-184"><span class="section-number-2">184</span> <code>min</code></h2>
<div class="outline-text-2" id="text-184">

<p>
The operation min, when applied to a simple array A, finds the greatest atom that is less than or equal to all the items.  If the atoms of A are all positive numbers, for example, min A returns the smallest number.  If the items are not comparable, the result is the fault ?O, the atom in the lattice of Nial atoms that is less than or equal to all other atoms (the nadir).  If A is empty, the result is the fault ?I, the atom that is greater than or equal to all other atoms (the zenith).
</p>

<p>
Min is extended to arbitrary arrays by its multi pervasive behaviour.  It is a reductive operation in that it reduces a simple array to a single atom.  Applied to a pair of simple arrays, it produces a simple array with the corresponding items compared.
</p>

<p>
If the items of A are all numeric type, they are comparable.  The result is the highest numeric type represented in the array, where boolean is the lowest numeric type and real number is the highest.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">min</span> 3 45 23 18 3.5
</pre>
</div>
<pre class="example">
3.
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">min</span> 3 <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
?O
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">min</span> <span style="color: #ffaf00;">"abc</span> <span style="color: #ffaf00;">"def</span> <span style="color: #ffaf00;">"c</span>
</pre>
</div>
<pre class="example">
abc
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">min</span> <span style="color: #00ff00;">'apples'</span> <span style="color: #00ff00;">'orange'</span>
</pre>
</div>
<pre class="example">
apalee
</pre>


<p>
The first example shows that min of a list of numbers of different type is the minimum number, coerced to the highest type.  The second shows that the integer 3 and the phrase "abc" are incomparable and the result is the fault ?I.  The third example shows that phrases are directly comparable.  The last shows that strings are compared on a character by character basis.
</p>
</div>

<div id="outline-container-sec-184-1" class="outline-3">
<h3 id="sec-184-1"><span class="section-number-3">184.1</span> Equations</h3>
<div class="outline-text-3" id="text-184-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">min</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">min</span> A
<span style="color: #ffffff; font-weight: bold;">min</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">min</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">min</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">atomic</span> A ==&gt; A <span style="color: #ffffff; font-weight: bold;">lte</span> <span style="color: #ffffff; font-weight: bold;">min</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">and</span> (A <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ffffff; font-weight: bold;">lte</span> B)
<span style="color: #ffffff; font-weight: bold;">min</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> ?<span style="color: brightred;">?I</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-185" class="outline-2">
<h2 id="sec-185"><span class="section-number-2">185</span> <code>minus</code></h2>
<div class="outline-text-2" id="text-185">

<p>
The operation minus returns the result of subtracting two numeric atoms.  It coerces the type of the atoms to be the higher type, if they differ; or to integer, if both are boolean.  The result is of the type of the coerced arguments.
</p>

<p>
The symbol - is a synonym for minus.  Care must be taken when using this symbol because it also is used to form negative constants and the latter use has higher priority.  Thus,
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 10;
A <span style="color: #ff00ff; font-weight: bold;">-</span> 1
</pre>
</div>
<pre class="example">
9
</pre>


<p>
does a subtraction, but
</p>

<div class="org-src-container">

<pre class="src src-nial">A -1
</pre>
</div>
<pre class="example">
10 -1
</pre>

<p>
forms a pair.
</p>

<p>
If one argument is numeric and the other is a fault or if both arguments are the same fault, the answer is the fault.  In all other cases when one or more of the arguments is not numeric, the result is the arithmetic fault ?A.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>



<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">minus</span> R
</pre>
</div>
<pre class="example">
     0      -1    -1.5   ?A  ?A  ?error
     1       0    -0.5   ?A  ?A  ?error
   1.5     0.5      0.   ?A  ?A  ?error
    ?A      ?A      ?A   ?A  ?A  ?A
    ?A      ?A      ?A   ?A  ?A  ?A
?error  ?error  ?error   ?A  ?A  ?error
</pre>

<p>
The above example illustrates all combinations of atom types for the two arguments to minus.
</p>
</div>

<div id="outline-container-sec-185-1" class="outline-3">
<h3 id="sec-185-1"><span class="section-number-3">185.1</span> Equations</h3>
<div class="outline-text-3" id="text-185-1">
<div class="org-src-container">

<pre class="src src-nial">0 <span style="color: #ffffff; font-weight: bold;">minus</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A
A <span style="color: #ffffff; font-weight: bold;">minus</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">plus</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-186" class="outline-2">
<h2 id="sec-186"><span class="section-number-2">186</span> <code>mix</code></h2>
<div class="outline-text-2" id="text-186">

<p>
The operation mix is intended to be used on an array A with items which are all the same shape.  In this case, the shape of the result is formed by the shape of A linked with the shape of the items.  The list of items of the result is the link of the items of A.  If A does not have equally shaped items, the fault ?conform is returned.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mix</span> (2 3) (4 5) (6 7)
</pre>
</div>
<pre class="example">
2 3
4 5
6 7
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> (<span style="color: #ffffff; font-weight: bold;">tell</span> 2 3)(<span style="color: #ffffff; font-weight: bold;">count</span> 2 3)
</pre>
</div>
<pre class="example">
+-------------+-------------+
|+---+---+---+|+---+---+---+|
||0 0|0 1|0 2|||1 1|1 2|1 3||
|+---+---+---+|+---+---+---+|
||1 0|1 1|1 2|||2 1|2 2|2 3||
|+---+---+---+|+---+---+---+|
+-------------+-------------+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mix</span> A
</pre>
</div>
<pre class="example">
+---+---+---+  +---+---+---+
|0 0|0 1|0 2|  |1 1|1 2|1 3|
+---+---+---+  +---+---+---+
|1 0|1 1|1 2|  |2 1|2 2|2 3|
+---+---+---+  +---+---+---+
</pre>

<p>
The first example shows that the result of mixing a triple of pairs is a 3 by 2 table.  The second example shows that mixing a pair of 2 by 3 tables is a 2 by 2 by 3 array, with the tables as the planes of the array.
</p>

<p>
The operation mix is the left inverse of the operations rows and raise for nonempty arrays.  It is often used to transform from a list of lists view of data to a table view of data.  In practice, transformations between the two representations on large arrays should be avoided in Q'Nial since considerable work is involved in doing the restructuring.
</p>
</div>

<div id="outline-container-sec-186-1" class="outline-3">
<h3 id="sec-186-1"><span class="section-number-3">186.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-186-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">append</span> 0 <span style="color: #ffffff; font-weight: bold;">reshape</span> A
   <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #00ffff;">THEN</span>
      ?<span style="color: brightred;">?conform</span>
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-186-2" class="outline-3">
<h3 id="sec-186-2"><span class="section-number-3">186.2</span> Equations</h3>
<div class="outline-text-3" id="text-186-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">mix</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> A)(<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> A)
<span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">mix</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> (<span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> 1) <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> (I <span style="color: #ffffff; font-weight: bold;">raise</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-187" class="outline-2">
<h2 id="sec-187"><span class="section-number-2">187</span> <code>mod</code></h2>
<div class="outline-text-2" id="text-187">

<p>
The operation mod returns the remainder of dividing integer A by integer B.  If the divisor B is zero, the result is A.  If it is negative, the result is the fault ?negative divisor.
</p>

<p>
The operation mod coerces a boolean argument to an integer.  It produces a fault if either argument is not an integer or a boolean.
</p>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>



<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">mod</span> R
</pre>
</div>
<pre class="example">
     0      1 ?A     ?A     ?A     ?error
     0      0 ?A     ?A     ?A     ?error
?A     ?A     ?A     ?A     ?A     ?error
?A     ?A     ?A     ?A     ?A     ?error
?A     ?A     ?A     ?A     ?A     ?error
?error ?error ?error ?error ?error ?error
</pre>

<div class="org-src-container">

<pre class="src src-nial">(5 <span style="color: #ffffff; font-weight: bold;">mod</span> 3)(-5 <span style="color: #ffffff; font-weight: bold;">mod</span> 3)(5 <span style="color: #ffffff; font-weight: bold;">mod</span> -3)(5 <span style="color: #ffffff; font-weight: bold;">mod</span> 0)
</pre>
</div>
<pre class="example">
2 1 ?negative divisor 5
</pre>

<p>
The first example illustrates all combinations of atom types for the two arguments to mod.
</p>

<p>
The remainder on division by a positive integer B is always a number between 0 and B - 1.  If A is negative, the integer returned obeys the rule of modular arithmetic as described in the definition.  The result of A mod 0 is A rather than a fault, since that is the preferred result in mathematics.
</p>
</div>

<div id="outline-container-sec-187-1" class="outline-3">
<h3 id="sec-187-1"><span class="section-number-3">187.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-187-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mod</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">floor</span> (A <span style="color: #ff00ff; font-weight: bold;">-</span> (B <span style="color: #ff00ff; font-weight: bold;">*</span> (A <span style="color: #ffffff; font-weight: bold;">quotient</span> B)) ) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-187-2" class="outline-3">
<h3 id="sec-187-2"><span class="section-number-3">187.2</span> Equation</h3>
<div class="outline-text-3" id="text-187-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isinteger</span> A ==&gt; A <span style="color: #ffffff; font-weight: bold;">mod</span> 0 <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-188" class="outline-2">
<h2 id="sec-188"><span class="section-number-2">188</span> <del>mold</del></h2>
<div class="outline-text-2" id="text-188">

<p>
The operation mold is provided for backward compatibility with earlier versions of Nial.  The current definition is a synonym for take.  The previous definition was a reshaping operation that was almost always used on lists and take has the same effect as the previous definition on lists.
</p>
</div>

<div id="outline-container-sec-188-1" class="outline-3">
<h3 id="sec-188-1"><span class="section-number-3">188.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-188-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">mold</span> <span style="color: #00ffff;">is</span> <span style="color: #ffffff; font-weight: bold;">take</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-189" class="outline-2">
<h2 id="sec-189"><span class="section-number-2">189</span> multi pervasive</h2>
<div class="outline-text-2" id="text-189">

<p>
Each operation f in this class reduces a simple array (an array of atoms) to an atom.
</p>

<p>
A multi pervasive operation maps an array having items of identical structure to one with the same structure, applying the operation to the simple arrays formed from all the atoms in corresponding positions in the atoms.
</p>

<p>
There are six operations in this class. They are the reductive operations of arithmetic and logic.
</p>

<p>
If a multi pervasive operation is applied to an array that does not have items of the same shape, the effect is to build a conformable pair by replicating an atom or solitary item of the array to the common shape of the other items.  If two or more of the items have tally different from one and are of unequal shape, the fault ?conform is returned.  On a pair, a multi pervasive operation behaves the same way as a binary pervasive operation does.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> [3 4 5 6 , 5 , 7 8 9 10] <span style="color: #ff00ff; font-weight: bold;">=</span> 15 17 19 21
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The following table describes the multi pervasive operations.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operation</th>
<th scope="col" class="left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">and</td>
<td class="left">logical "and" of a boolean array</td>
</tr>

<tr>
<td class="left">max</td>
<td class="left">highest item in the array</td>
</tr>

<tr>
<td class="left">min</td>
<td class="left">lowest item in the array</td>
</tr>

<tr>
<td class="left">or</td>
<td class="left">logical "or" of a boolean array</td>
</tr>

<tr>
<td class="left">product</td>
<td class="left">arithmetic product of an array of numbers</td>
</tr>

<tr>
<td class="left">sum</td>
<td class="left">arithmetic sum of an array of numbers</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-189-1" class="outline-3">
<h3 id="sec-189-1"><span class="section-number-3">189.1</span> Equations</h3>
<div class="outline-text-3" id="text-189-1">
<div class="org-src-container">

<pre class="src src-nial">f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACHALL</span> f A
f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">pack</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A
f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">REDUCE</span> f A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-190" class="outline-2">
<h2 id="sec-190"><span class="section-number-2">190</span> nested definition</h2>
<div class="outline-text-2" id="text-190">

<p>
A nested definition is one that appears in a definition sequence within a block.  Its name is a local definition name.  If the name is also used outside the block, the external meaning is not known in the block.
</p>

<p>
Nested definitions can be used to encapsulate support definitions within a larger definition that is to be made available to other users.  This avoids cluttering up the name space with names that might interfere with the user's other work.  It is often easier to develop the large definition without encapsulation and package it in encapsulated form once the design is completed.
</p>
</div>
</div>

<div id="outline-container-sec-191" class="outline-2">
<h2 id="sec-191"><span class="section-number-2">191</span> <code>next</code></h2>
<div class="outline-text-2" id="text-191">

<p>
The command next is used in debugging a definition that has been suspended using Break or &lt;Ctrl B&gt;.  The effect of next is to execute the next expression in an expression sequence and to suspend execution again.  If the current expression involves a call on a defined operation or expression, execution of the entire definition is completed and execution is suspended on the expression after the current one.  If the current expression is the last one in the expression sequence where the break began, the effect is the same as using resume.
</p>

<p>
The related command nextv displays the result of the expression executed on a step before displaying the next expression.
</p>
</div>
</div>

<div id="outline-container-sec-192" class="outline-2">
<h2 id="sec-192"><span class="section-number-2">192</span> <code>nialroot</code></h2>
<div class="outline-text-2" id="text-192">

<p>
The expression Nialroot returns a string giving the path to the directory holding the help directory, the initial directory and the library directories.  Nialroot is defined before Q'Nial is run.  In Windows and Unix versions this is set up as part of the installation procedure. Under EXTDOS, it is defined using a set command such as:
set nialroot=C:\qnial62
</p>
</div>
</div>

<div id="outline-container-sec-193" class="outline-2">
<h2 id="sec-193"><span class="section-number-2">193</span> <code>no_expr</code></h2>
<div class="outline-text-2" id="text-193">

<p>
The expression <code>No_expr</code> returns the fault <code>?missing_expr</code>.  It is the default value for an expression name declared to be external or that has been erased.
</p>
</div>
</div>

<div id="outline-container-sec-194" class="outline-2">
<h2 id="sec-194"><span class="section-number-2">194</span> <code>no_op</code></h2>
<div class="outline-text-2" id="text-194">

<p>
The operation <code>no_op</code> returns the fault <code>?missing_op</code> when applied to any array A.  It is the default value for an operation name declared to be external or that has been erased.
</p>
</div>
</div>

<div id="outline-container-sec-195" class="outline-2">
<h2 id="sec-195"><span class="section-number-2">195</span> <code>NO_TR</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-195">

<p>
The transformer <i>=NO_TR=</i> transforms any operation f to an operation that returns the fault ?missing<sub>tr</sub> when applied to any array A.  It is the default value for a transformer name declared to be external or that has been erased.
</p>
</div>
</div>

<div id="outline-container-sec-196" class="outline-2">
<h2 id="sec-196"><span class="section-number-2">196</span> <code>?no_value</code></h2>
<div class="outline-text-2" id="text-196">

<p>
The fault <a href="#sec-196">196</a>is a special fault value used as the default value of variables that have been declared external or that have been erased.
</p>
</div>
</div>

<div id="outline-container-sec-197" class="outline-2">
<h2 id="sec-197"><span class="section-number-2">197</span> <code>not</code></h2>
<div class="outline-text-2" id="text-197">

<p>
The operation <a href="#sec-197">197</a> reverses the value of a boolean.  It returns true if A is false and false if A is true.  If A is any other atom, the result is the logical fault <code>?L</code>.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">not</span> l
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">not</span> lollo
</pre>
</div>
<pre class="example">
olool
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">not</span> 2 <span style="color: #ffaf00;">"abc</span> o
</pre>
</div>
<pre class="example">
?L ?L l
</pre>
</div>

<div id="outline-container-sec-197-1" class="outline-3">
<h3 id="sec-197-1"><span class="section-number-3">197.1</span> Equations</h3>
<div class="outline-text-3" id="text-197-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">not</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">not</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">and</span> A =f= <span style="color: #ffffff; font-weight: bold;">or</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">not</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">or</span> A =f= <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">not</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-198" class="outline-2">
<h2 id="sec-198"><span class="section-number-2">198</span> <code>notin</code></h2>
<div class="outline-text-2" id="text-198">

<p>
The operation notin returns true if A is not an item of B and returns false if it is.
</p>


<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">notin</span> 56 34 23 3 57 3
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">4 1 <span style="color: #ffffff; font-weight: bold;">notin</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">notin</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">notin</span> <span style="color: #ffaf00;">"apple</span>
</pre>
</div>
<pre class="example">
l
</pre>
</div>

<div id="outline-container-sec-198-1" class="outline-3">
<h3 id="sec-198-1"><span class="section-number-3">198.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-198-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">notin</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">not</span> (A <span style="color: #ffffff; font-weight: bold;">in</span> B) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-198-2" class="outline-3">
<h3 id="sec-198-2"><span class="section-number-3">198.2</span> Equation</h3>
<div class="outline-text-3" id="text-198-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">notin</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">notin</span> <span style="color: #ffffff; font-weight: bold;">list</span> B
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-199" class="outline-2">
<h2 id="sec-199"><span class="section-number-2">199</span> <code>null</code></h2>
<div class="outline-text-2" id="text-199">

<p>
The expression Null denotes the empty list.  It is the array returned as the shape of a single and is equal to the empty string.  The empty list notation  [ ]  also denotes the empty list Null.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> 5
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> []
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
l
</pre>


<p>
Since there is an empty array for each shape containing a zero, unless you are certain A is a list, the test: A = Null should not be used in place of empty A.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>; <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
+
|
+
</pre>

<p>
Null is not displayed when sketch display mode is set.  In diagram mode it is displayed as the left border of a list diagram.
</p>

<p>
A selection operation such as pick or first applied to Null results in the fault ?address.
</p>
</div>

<div id="outline-container-sec-199-1" class="outline-3">
<h3 id="sec-199-1"><span class="section-number-3">199.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-199-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">shape</span> 0
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-199-2" class="outline-3">
<h3 id="sec-199-2"><span class="section-number-3">199.2</span> Equations</h3>
<div class="outline-text-3" id="text-199-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> 0
<span style="color: #ffffff; font-weight: bold;">atomic</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-200" class="outline-2">
<h2 id="sec-200"><span class="section-number-2">200</span> numeric type hierarchy</h2>
<div class="outline-text-2" id="text-200">

<p>
The three numeric types: boolean, integer and real, are organized in a hierarchy in the order mentioned.  For arithmetic and comparative binary operations, if the types of arguments are both numeric but differ in type, they are coerced to the higher of the two types.  For example, if you add an integer to a real number, say 3 + 4.5, the integer is coerced to 3.0 and a real number addition is done.  Boolean atoms are always coerced to integers if they are used with arithmetic operations.
</p>

<p>
There are six types of atoms in Nial.  They are boolean, integer, real, character, phrase and fault.  The first three are numeric types and are used for arithmetic operations.  The last three are literal types and are used for symbol manipulation.  All six types of atoms are used in comparisons.
</p>

<p>
A boolean atom is the result of a comparison of array values; or the result of a test relating to a characteristic of an array or the content of an array.  There are two boolean atoms: true and false, denoted by l and o respectively. When booleans are treated as numbers, true corresponds to one and false to zero.
</p>

<p>
An integer atom is a positive or negative whole number representing a quantity of units.  A dash symbol (-) immediately preceding the integer denotes a negative integer.  No space is permitted between the dash and the number, otherwise the dash is interpreted as the arithmetical operation of subtraction.  Conversely, a space is required when subtraction is intended.  An integer is represented by an internal form that limits its range of values in the Q'Nial implementation of Nial.
</p>

<p>
A real atom is a number which can represent any position on the real line.  It may be written with a fractional part and/or with a decimal exponent.  It is represented internally by a floating point number.
</p>
</div>
</div>

<div id="outline-container-sec-201" class="outline-2">
<h2 id="sec-201"><span class="section-number-2">201</span> <code>open</code></h2>
<div class="outline-text-2" id="text-201">

<p>
The operation open prepares the host file named by the phrase or string Filename for use in one of seven possible modes.  Mode is a character, string or phrase encoding the mode as follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Mode</th>
<th scope="col" class="left">Mode Name</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">r</td>
<td class="left">read</td>
<td class="left">existing sequential text file, read only</td>
</tr>

<tr>
<td class="left">w</td>
<td class="left">write</td>
<td class="left">create sequential text file, write only</td>
</tr>

<tr>
<td class="left">a</td>
<td class="left">append</td>
<td class="left">existing sequential text file, write only starting at the end</td>
</tr>

<tr>
<td class="left">d</td>
<td class="left">direct</td>
<td class="left">existing or new binary file, direct access for both read and write</td>
</tr>

<tr>
<td class="left">c</td>
<td class="left">communication</td>
<td class="left">existing or new sequential text file, for both read and write</td>
</tr>

<tr>
<td class="left">pr</td>
<td class="left">pipe read</td>
<td class="left">output from the command Filename is available</td>
</tr>

<tr>
<td class="left">pw</td>
<td class="left">pipe write</td>
<td class="left">input to the command Filename is provided</td>
</tr>
</tbody>
</table>

<p>
In read, write, append or communication modes, Filename must include the file extension, if any.  In direct mode, two host files are opened, one with extension .ndx and the other with extension .rec, standing for index and record, respectively.  In this mode, Filename is the root of the file name, without any extension.
</p>

<p>
The communication mode can be used with special forms of readfile and writefile usage to access a special device or a communications port.  This mode is available only on the EXTDOS Version of Nial.
</p>

<p>
The pipe modes treat the Filename as a host command. The open causes the command to be executed. In pipe read, the output from the command is obtained using readfile; in pipe write, input to the command is provided using writefile.
</p>

<p>
The result of open is a file designator, an integer specifying an input/output port.  This value is used in later references to the file.
</p>

<p>
The effect of open may be system dependent.  If the file exists and can be opened by the user in the requested mode, the result will be the file designator.  If it cannot be opened or does not exist, the result will be a fault message generated from the error message provided by the host system.  For portable programs, the specific fault message should not be used in an equality test.  The result of an open should be tested for a fault value using isfault to catch unexpected failures.
</p>
</div>
</div>

<div id="outline-container-sec-202" class="outline-2">
<h2 id="sec-202"><span class="section-number-2">202</span> operation</h2>
<div class="outline-text-2" id="text-202">

<p>
An operation is a functional object that is given an argument array and returns a result array.  The process of executing an operation by giving it an argument value is called an operation call or an operation application.
</p>

<p>
An operation can be constructed by defining one or more parameters and giving an algorithm to compute the result in terms of the parameters.  An operation is usually given a name when it is defined.  There are also program fragments that construct unnamed operations by composing operations, forming a list of operations or modifying an operation by use of a transformer.
</p>

<p>
A named operation is either a predefined operation or an operation that has been given an explicit name using the IS definition mechanism.
</p>
</div>
</div>

<div id="outline-container-sec-203" class="outline-2">
<h2 id="sec-203"><span class="section-number-2">203</span> operation composition</h2>
<div class="outline-text-2" id="text-203">

<p>
A sequence of simple-operation denotations forms an operation-sequence in the syntax of Nial.  Its meaning is the same as the composition of the operations in the sequence which is explained by its effect when applied.
</p>

<p>
The result of applying an operation-sequence to an argument is determined by applying the simple-operations in the sequence in right-to-left order.  The simple-operation on the right is applied to the argument giving an intermediate result.  Then the simple-operation to the immediate left is applied to the result of the first application.  Subsequent simple-operations are applied to the results in turn.
</p>

<p>
An example of this concept is the expression
</p>

<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span>) 8 7 2 5 3
</pre>
</div>
<pre class="example">
7
</pre>

<p>
The expression sequence first rest  is evaluated by applying rest to the argument resulting in 7 2 5 3 and then first is applied giving 7.
</p>

<p>
The relationship can be described by the equations:
</p>

<div class="org-src-container">

<pre class="src src-nial">(f g) A <span style="color: #ff00ff; font-weight: bold;">=</span> f (g A)
(f g h) A <span style="color: #ff00ff; font-weight: bold;">=</span> f (g (h A))
</pre>
</div>
<p>
etc.
</p>

<p>
which is mathematically known as the rule of function composition.
</p>
</div>
</div>

<div id="outline-container-sec-204" class="outline-2">
<h2 id="sec-204"><span class="section-number-2">204</span> <i>operation form</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-204">

<p>
An operation-form is the syntactic structure used to describe an operation in terms of a parameterized expression-sequence.  The identifiers following the keyword operation are called the formal parameters.  The body of an operation-form is normally a block but it may be an expression-sequence without automatic localization.
</p>

<div class="org-src-container">

<pre class="src src-bnf">operation-form ::=
   OPERATION { identifiers }+ block
   | OPERATION { identifiers }+
     ( expression-sequence )
</pre>
</div>

<p>
An operation-form defines a local environment.  The formal parameter names are names of local variables.  If the body of the operation form is a block, the local environment of the block is extended to include the formal parameters.  When the operation is applied, the formal parameter names are assigned from the value of the actual argument.  If there is only one formal parameter, the actual argument is assigned to it as a whole; otherwise, the items of the actual argument are assigned to the formal parameters in corresponding order.  If there is a length mismatch between the list of formal parameter names and the values of the actual argument, the fault ?op<sub>parameter</sub> is returned.
</p>

<p>
The value of the application of the operation is the value of the body of the operation-form, which is evaluated with the local variables in the parameter list assigned as described above.  In determining the association for a name that appears in the body of an operation form, Q'Nial looks for the name in the local environment.  If the name is not found locally, the name is sought in surrounding environments until it is found or until the global environment is searched.  If it is not found, a fault ?unknown identifier: is given when the operation-form is analyzed (parsed).
</p>

<p>
Operation-forms are most frequently used in definitions where they are given an associated name.  However, an operation-form can appear directly in an expression provided it is enclosed in parentheses.  In this usage, it can be an argument to a transformer name or can be applied to an array argument.
</p>
</div>
</div>

<div id="outline-container-sec-205" class="outline-2">
<h2 id="sec-205"><span class="section-number-2">205</span> <code>opposite</code></h2>
<div class="outline-text-2" id="text-205">

<p>
The operation opposite returns the opposite value of the integer or real number A.  The opposite value of a positive number A is the corresponding negative value and vice versa.  The operation produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">opposite of the corresponding integer</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">opposite integer</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">opposite real number</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<p>
The name opp is a synonym for opposite used as an abbreviation.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">opposite</span>  l  -2  3.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?err</span>
</pre>
</div>
<pre class="example">
-1 2 -3.5 ?A ?A ?err
</pre>

<p>
In Nial, the symbol - is used as part of negative numbers and as a synonym for minus. Care must be taken to use a space after the symbol before a constant to get the expected subtraction.
</p>
</div>

<div id="outline-container-sec-205-1" class="outline-3">
<h3 id="sec-205-1"><span class="section-number-3">205.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-205-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (0 <span style="color: #ffffff; font-weight: bold;">minus</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-205-2" class="outline-3">
<h3 id="sec-205-2"><span class="section-number-3">205.2</span> Equations</h3>
<div class="outline-text-3" id="text-205-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A
A <span style="color: #ff00ff; font-weight: bold;">-</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-206" class="outline-2">
<h2 id="sec-206"><span class="section-number-2">206</span> <code>ops</code></h2>
<div class="outline-text-2" id="text-206">

<p>
The expression Ops returns a list of phrases giving the names of all user defined operations in the workspace.
</p>
</div>
<div id="outline-container-sec-206-1" class="outline-3">
<h3 id="sec-206-1"><span class="section-number-3">206.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-206-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Ops</span> <span style="color: #00ffff;">IS</span> {
   Names Roles <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">symbols</span> 0;
   "<span style="color: #00ffff;">op</span> <span style="color: #ffffff; font-weight: bold;">match</span> Roles <span style="color: #ffffff; font-weight: bold;">sublist</span> Names }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-207" class="outline-2">
<h2 id="sec-207"><span class="section-number-2">207</span> <code>or</code></h2>
<div class="outline-text-2" id="text-207">

<p>
The operation or applies to a boolean array A and does the boolean sum of its items.  If any item of A is true, the result is true; otherwise it is false.  Used in binary form, it implements the usual or-connective of logic.  If A is a simple array but has a non-boolean item, the result is the logical fault ?L.  The operation extends to non-simple arrays by the multi pervasive mechanism.
</p>


<div class="org-src-container">

<pre class="src src-nial">l <span style="color: #ffffff; font-weight: bold;">or</span> o
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">or</span> oooolooo
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">lloo <span style="color: #ffffff; font-weight: bold;">or</span> lolo
</pre>
</div>
<pre class="example">
lllo
</pre>


<p>
Or is a reductive operation in that it reduces an array of booleans to a single boolean.  Applied to a pair of bitstrings, it produces a bitstring resulting from applying or to the bits of its arguments in corresponding positions.
</p>
</div>

<div id="outline-container-sec-207-1" class="outline-3">
<h3 id="sec-207-1"><span class="section-number-3">207.1</span> Equations</h3>
<div class="outline-text-3" id="text-207-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">or</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">or</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">or</span> A =f= <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">not</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-208" class="outline-2">
<h2 id="sec-208"><span class="section-number-2">208</span> <code>OUTER</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-208">

<p>
The transformer <i>=OUTER=</i> transforms an operation f to an operation that applies f to each item of the cartesian product of its argument.  In the case where the arguments are a pair of lists A and B, the result is a table of the applications of f with every pair chosen with the first item from A and the second from B.
</p>

<div class="org-src-container">

<pre class="src src-nial">1 2 3 4 5 <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">*</span> 1 2 3 4 5
</pre>
</div>
<pre class="example">
1  2  3  4  5
2  4  6  8 10
3  6  9 12 15
4  8 12 16 20
5 10 15 20 25
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'abcd'</span>
</pre>
</div>
<pre class="example">
+---+---+---+---+
|aa |bb |cc |dd |
+---+---+---+---+
|aaa|bbb|ccc|ddd|
+---+---+---+---+
</pre>

<p>
The first example shows OUTER * being used to generate a multiplication table.  The second shows that it can be applied to an operation that has a non-atomic result.
</p>
</div>

<div id="outline-container-sec-208-1" class="outline-3">
<h3 id="sec-208-1"><span class="section-number-3">208.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-208-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">OUTER</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">cart</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-208-2" class="outline-3">
<h3 id="sec-208-2"><span class="section-number-3">208.2</span> Equations</h3>
<div class="outline-text-3" id="text-208-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">OUTER</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> (<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span>) A B ==&gt; A <span style="color: #ffff00;">OUTER</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">mix</span> (A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffff00;">EACHRIGHT</span> f B)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-209" class="outline-2">
<h2 id="sec-209"><span class="section-number-2">209</span> overflow</h2>
<div class="outline-text-2" id="text-209">

<p>
The term integer overflow is used to describe the situation when an integer that is too big for the internal representation of integers is generated.  Q'Nial uses 32 bit integers and checks for overflow during computations.  If an arithmetic computation produces an overflow, a fault value is produced.
</p>

<p>
An overflow can also develop during computation with real numbers.  The computer hardware detects such a problem and an interrupt occurs which causes Q'Nial to jump to top level.
</p>
</div>
</div>

<div id="outline-container-sec-210" class="outline-2">
<h2 id="sec-210"><span class="section-number-2">210</span> <code>pack</code></h2>
<div class="outline-text-2" id="text-210">

<p>
The operation <a href="#sec-210">210</a> interchanges the top two levels of an array with equally shaped items.  If A is an array with items all of the same shape, the result is an array of that shape, with items having the shape that A has.  If A does not have items of the same shape but all the items that have zero items or more than one item are of the same shape, it is modified by replicating the items with one item to that shape before interchanging levels.  Otherwise it returns the fault ?conform.
</p>

<p>
The items of the result are the arrays of items of A from corresponding positions.  Pack is used implicitly in all binary pervasive and multi pervasive operations.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> (2 3 4) (4 5 6)
</pre>
</div>
<pre class="example">
+---+---+---+
|2 4|3 5|4 6|
+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #00ff00;">'ab'</span> <span style="color: #00ff00;">'cd'</span> <span style="color: #00ff00;">'ef'</span> <span style="color: #00ff00;">'gh'</span>
</pre>
</div>
<pre class="example">
+----+----+
|aceg|bdfh|
+----+----+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> (<span style="color: #ffffff; font-weight: bold;">tell</span> 2 3) (<span style="color: #ffffff; font-weight: bold;">count</span> 2 3)
</pre>
</div>
<pre class="example">
+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|
||0 0|1 1|||0 1|1 2|||0 2|1 3||
|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+
|+---+---+|+---+---+|+---+---+|
||1 0|2 1|||1 1|2 2|||1 2|2 3||
|+---+---+|+---+---+|+---+---+|
+---------+---------+---------+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pack</span> (2 3 4) 5 [2 3] <span style="color: #00ff00;">'abc'</span>
</pre>
</div>
<pre class="example">
+-----------+-----------+-----------+
|+-+-+---+-+|+-+-+---+-+|+-+-+---+-+|
||2|5|2 3|a|||3|5|2 3|b|||4|5|2 3|c||
|+-+-+---+-+|+-+-+---+-+|+-+-+---+-+|
+-----------+-----------+-----------+
</pre>

<p>
The first example shows that pack of a pair of triples is a triple of pairs.  The second shows that pack of a quadruple of pairs is a pair of quadruples.  The third shows that pack of a pair of 2 by 3 tables is a 2 by 3 table of pairs.  The final example shows a case where replication occurs.  The first and last items have shape <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup>.  The second and third items are an atom and a solitary and hence can be replicated.
</p>
</div>

<div id="outline-container-sec-210-1" class="outline-3">
<h3 id="sec-210-1"><span class="section-number-3">210.1</span> Equations</h3>
<div class="outline-text-3" id="text-210-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">equal</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> A
<span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
<span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">pack</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">simple</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">pack</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-211" class="outline-2">
<h2 id="sec-211"><span class="section-number-2">211</span> <code>pair</code></h2>
<div class="outline-text-2" id="text-211">

<p>
The operation pair has no effect on a pair but converts all other arrays to a pair by reshaping the array with shape 2.  Used in infix notation, it has the effect of forming a pair from the two arguments.  An explicit pair can also be achieved with list or strand notation.  The operation is useful in functional expressions where it is an argument to a transformer.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">pair</span> 4 5
</pre>
</div>
<pre class="example">
+-+---+
|3|4 5|
+-+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pair</span> 3 4 5
</pre>
</div>
<pre class="example">
3 4
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pair</span> <span style="color: #ffffff; font-weight: bold;">single</span> 3 4 5
</pre>
</div>
<pre class="example">
+-----+-----+
|3 4 5|3 4 5|
+-----+-----+
</pre>

<p>
The major use of pair is as an operation applied using a transformer.
</p>
</div>

<div id="outline-container-sec-211-1" class="outline-3">
<h3 id="sec-211-1"><span class="section-number-3">211.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-211-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pair</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (2 <span style="color: #ffffff; font-weight: bold;">reshape</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-211-2" class="outline-3">
<h3 id="sec-211-2"><span class="section-number-3">211.2</span> Equations</h3>
<div class="outline-text-3" id="text-211-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pair</span> <span style="color: #ffffff; font-weight: bold;">pair</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">pair</span> A
A <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">pair</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">cart</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-212" class="outline-2">
<h2 id="sec-212"><span class="section-number-2">212</span> <code>parse</code></h2>
<div class="outline-text-2" id="text-212">

<p>
The operation parse carries out the internal parsing capability of the interpreter.  Its argument is a token stream produced by scan or deparse.  The result is the parse tree recording the semantic intent of the input.  The parse tree is a highly encoded form of nested array designed for efficient processing.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'sum 23 45'</span>
</pre>
</div>
<pre class="example">
+---+-----------------------------+
|100|+-+-----+-------------------+|
|   ||4|3 4 3|+-+-------+-------+||
|   || |     ||8|1 23 23|1 45 45|||
|   || |     |+-+-------+-------+||
|   |+-+-----+-------------------+|
+---+-----------------------------+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'foo IS first'</span>
</pre>
</div>
<pre class="example">
+---+-----------------------------+
|100|+--+---------------+------+-+|
|   ||11|+--+----------+|3 47 3|1||
|   ||  ||22|2 160 7459||      | ||
|   ||  |+--+----------+|      | ||
|   |+--+---------------+------+-+|
+---+-----------------------------+
</pre>

<p>
The first example gives the parse tree corresponding to an application of an operation to a strand of constants.  The second example gives the parse tree for the definition of foo as the predefined operation first.  The small integers that appear as the first items of the arrays serve as tags to indicate the kind of node that is represented in the parse tree.  They are used by the eval and deparse operations.  The representation of parse trees is implementation dependent and is not intended for program manipulation.
</p>
</div>

<div id="outline-container-sec-212-1" class="outline-3">
<h3 id="sec-212-1"><span class="section-number-3">212.1</span> Equations</h3>
<div class="outline-text-3" id="text-212-1">
<div class="org-src-container">

<pre class="src src-nial">Ts a token stream ==&gt; <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> <span style="color: #ffffff; font-weight: bold;">parse</span> Ts <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">parse</span> Ts
S a <span style="color: #ffffff; font-weight: bold;">string</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> S
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-213" class="outline-2">
<h2 id="sec-213"><span class="section-number-2">213</span> <code>PARTITION</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-213">

<p>
The transformer <i>=PARTITION=</i> is used to apply operation f to partitions of the array A, placing the results of the applications as partitions of the result array.
</p>

<p>
The partitions of A are determined by the axis numbers in I, using (I split A) to form them implicitly.  The results of applying f, viewed as an intermediate array R, are combined into the final result, using (J blend R), to place the axes of the items of R into the final result.  If the left argument is a solitary, it is assumed to be used as the argument to both split and blend implicitly.
</p>

<p>
For a table A, I = 1, f being reverse, the effect is to reverse the rows of A.  In general, if I = J and is a single axis number and f maps a list to one of the same length, the effect is to apply f to the lists formed by pushing axis I down, resulting in an array of the same shape as A.  Two dimensional partitions of a three dimensional array can be mapped using an I with tally 2.
</p>


<div class="org-src-container">

<pre class="src src-nial">[1] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> (3 5 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 15)
</pre>
</div>
<pre class="example">
 5  4  3  2  1
10  9  8  7  6
15 14 13 12 11
</pre>

<div class="org-src-container">

<pre class="src src-nial">[0] <span style="color: #ffff00;">PARTITION</span> (2 <span style="color: #ffffff; font-weight: bold;">rotate</span>) (6 6 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 36)
</pre>
</div>
<pre class="example">
12 13 14 15 16 17
18 19 20 21 22 23
24 25 26 27 28 29
30 31 32 33 34 35
 0  1  2  3  4  5
 6  7  8  9 10 11
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%4.2f'</span>;
<span style="color: #ffffff; font-weight: bold;">seed</span> .5 ; A:=2 3 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">random</span> 18
</pre>
</div>
<pre class="example">
0.50 0.43 0.12   0.03 0.81 0.24
0.77 0.73 0.89   0.58 0.98 0.47
0.98 0.66 0.16   0.24 0.16 0.50
</pre>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #00ffff;">gets</span> 1 2 <span style="color: #ffffff; font-weight: bold;">split</span> A
</pre>
</div>
<pre class="example">
+--------------+--------------+
|0.50 0.43 0.12|0.03 0.81 0.24|
|0.77 0.73 0.89|0.58 0.98 0.47|
|0.98 0.66 0.16|0.24 0.16 0.50|
+--------------+--------------+
</pre>


<div class="org-src-container">

<pre class="src src-nial">C <span style="color: #00ffff;">gets</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">inverse</span> B
</pre>
</div>
<pre class="example">
+-----------------+-----------------+
|-7.43  0.18  4.69|-2.51  2.21 -0.90|
|11.78 -0.62 -5.55| 1.09  0.25 -0.76|
|-3.27  1.48  0.51| 0.83 -1.13  2.69|
+-----------------+-----------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 2 <span style="color: #ffffff; font-weight: bold;">blend</span> C
</pre>
</div>
<pre class="example">
-7.43  0.18  4.69   -2.51  2.21 -0.90
11.78 -0.62 -5.55    1.09  0.25 -0.76
-3.27  1.48  0.51    0.83 -1.13  2.69
</pre>


<div class="org-src-container">

<pre class="src src-nial">[1 2] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffffff; font-weight: bold;">inverse</span> A
</pre>
</div>
<pre class="example">
-7.43  0.18  4.69   -2.51  2.21 -0.90
11.78 -0.62 -5.55    1.09  0.25 -0.76
-3.27  1.48  0.51    0.83 -1.13  2.69
</pre>

<p>
The transformer <i>=RANK=</i> is a simpler version of a partitioning transformer that always pushes down the right end axes.
</p>
</div>

<div id="outline-container-sec-213-1" class="outline-3">
<h3 id="sec-213-1"><span class="section-number-3">213.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-213-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">PARTITION</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Ij A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> Ij <span style="color: #ffffff; font-weight: bold;">or</span> (<span style="color: #ffffff; font-weight: bold;">tally</span> Ij <span style="color: #ff00ff; font-weight: bold;">&gt;</span> 2) <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'invalid left arg of PARTITION transform'</span>
   <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #00ffff;">THEN</span>
      A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> Ij <span style="color: #ff00ff; font-weight: bold;">=</span> 1 <span style="color: #00ffff;">THEN</span>
         I <span style="color: #ff00ff;">:=</span> J <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">first</span> Ij;
      <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> Ij <span style="color: #ff00ff; font-weight: bold;">=</span> 2 <span style="color: #00ffff;">THEN</span>
         I J <span style="color: #ff00ff;">:=</span> Ij;
      <span style="color: #00ffff;">ENDIF</span>;
      II <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">except</span> I <span style="color: #ffffff; font-weight: bold;">link</span> I;
      B <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">tally</span> I <span style="color: #ffff00;">RANK</span> f (II <span style="color: #ffffff; font-weight: bold;">fuse</span> A);
      <span style="color: #00ffff;">IF</span> J <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">and</span> (<span style="color: #ffffff; font-weight: bold;">shape</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>) <span style="color: #00ffff;">THEN</span>
         <span style="color: #ffffff; font-weight: bold;">first</span> B
      <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">tally</span> J <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">valence</span> B <span style="color: #ff00ff; font-weight: bold;">-</span> (<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">tally</span> I)) <span style="color: #00ffff;">THEN</span>
         JJ <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">axes</span> B <span style="color: #ffffff; font-weight: bold;">except</span> J <span style="color: #ffffff; font-weight: bold;">link</span> J;
         <span style="color: #ffff00;">GRADE</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> JJ <span style="color: #ffffff; font-weight: bold;">fuse</span> B
      <span style="color: #00ffff;">ELSE</span>
         <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'left arg incompatible with function in PARTITION transform'</span>
      <span style="color: #00ffff;">ENDIF</span>
  <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-213-2" class="outline-3">
<h3 id="sec-213-2"><span class="section-number-3">213.2</span> Equations</h3>
<div class="outline-text-3" id="text-213-2">
<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">split</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> \[I,<span style="color: #ffffff; font-weight: bold;">Null</span>] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
I <span style="color: #ffffff; font-weight: bold;">blend</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> \[<span style="color: #ffffff; font-weight: bold;">Null</span>,I] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
<span style="color: #ffff00;">EACH</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> \[<span style="color: #ffffff; font-weight: bold;">Null</span>,<span style="color: #ffffff; font-weight: bold;">Null</span>] <span style="color: #ffff00;">PARTITION</span> (<span style="color: #ffffff; font-weight: bold;">single</span> f <span style="color: #ffffff; font-weight: bold;">first</span>) A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-214" class="outline-2">
<h2 id="sec-214"><span class="section-number-2">214</span> <code>pass</code></h2>
<div class="outline-text-2" id="text-214">

<p>
The operation pass is the identity operation for arrays.  It returns the argument A.  Pass is used when expressing computations in a functional style using an atlas (a list of operations).
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pass</span> 2 3 4
</pre>
</div>
<pre class="example">
2 3 4
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pass</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
hello world
</pre>
</div>

<div id="outline-container-sec-214-1" class="outline-3">
<h3 id="sec-214-1"><span class="section-number-3">214.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-214-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pass</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-214-2" class="outline-3">
<h3 id="sec-214-2"><span class="section-number-3">214.2</span> Equations</h3>
<div class="outline-text-3" id="text-214-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">pass</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">pass</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-215" class="outline-2">
<h2 id="sec-215"><span class="section-number-2">215</span> <code>paste</code></h2>
<div class="outline-text-2" id="text-215">

<p>
The operation paste combines character tables in a two dimensional layout.  It is used internally by picture and can be used to create modifications of the standard picture output to improve the display of results.  The left argument Sw has six parameters that control the layout and the right argument A is the array of tables to be combined.  The components of argument Sw are the following:
</p>

<dl class="org-dl">
<dt> Vertical edge spacing </dt><dd>an integer indicating the number of blank lines to be put between the rows of items
</dd>
<dt> Horizontal edge spacing </dt><dd>an integer indicating the number of blank spaces to be put between the columns of items
</dd>
<dt> vertical line indicator </dt><dd>If the value is 1, vertical lines are drawn between columns.  If it is 0, they are not
</dd>
<dt> Horizontal line indicator </dt><dd>If the value is 1, horizontal lines are drawn between rows.  If it is 0, they are not
</dd>
<dt> Vertical justification indicator </dt><dd>This is either a single integer indicating the same justification for all fields or an array of integers of the same shape as A indicating the justification for each item of A.  The codes are: 0 for top justification, 1 for centered and 2 for bottom justification
</dd>
<dt> Horizontal justification indicator </dt><dd>This is either a single integer indicating the same justification for all fields, or an array of integers of the same shape as A indicating the| justification for each item of A.  The codes are: 0 for left justification, 1 for centered and 2 for right justification
</dd>
</dl>

<p>
If either line indicator is 1, the entire result is boxed.
</p>

<pre class="example">
    1 2 1 3 1 1 paste EACH sketch (2 4 reshape 'some' 'words' 'of' 'wisdom')
+--------+---------+------+----------+
|        |         |      |          |
|  some  |  words  |  of  |  wisdom  |
|        |         |      |          |
+--------+---------+------+----------+
|        |         |      |          |
|  some  |  words  |  of  |  wisdom  |
|        |         |      |          |
+--------+---------+------+----------+
</pre>
</div>
</div>

<div id="outline-container-sec-216" class="outline-2">
<h2 id="sec-216"><span class="section-number-2">216</span> pervasive</h2>
<div class="outline-text-2" id="text-216">

<p>
Some of the operations of Nial that operate on simple arrays are extended to arbitrarily nested arrays by being applied to the atoms at the deepest level.  These are called pervasive operations.
</p>

<p>
There are three class=es of pervasive operations: unary pervasive, binary pervasive and multi pervasive.  The first class applies the operations= to the atoms of the array. The second class are binary operations that apply to pairs of atoms from corresponding positions in the pair of arguments. The third class applies the operation to the simple arrays formed from atoms in corresponding positions in the items of the argument, reducing the simple array to a single atom.
</p>
</div>
</div>

<div id="outline-container-sec-217" class="outline-2">
<h2 id="sec-217"><span class="section-number-2">217</span> <code>phrase</code></h2>
<div class="outline-text-2" id="text-217">

<p>
The operation phrase converts a string into a phrase with the same content.  It returns phrases and faults unchanged and converts other atoms after coercing them to their string equivalents.  The resulting phrase may contain blanks.  There is a one-to-one correspondence between phrases and strings.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">phrase</span> <span style="color: #00ff00;">'(613) 549-2222'</span>
</pre>
</div>
<pre class="example">
(613) 549-2222
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span> ; <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">phrase</span> o 613 3.5 `A <span style="color: #00ff00;">'Now'</span> <span style="color: #ffaf00;">"Wow</span> <span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
"o "613 "3.5 "A "Now "Wow "error
</pre>
</div>

<div id="outline-container-sec-217-1" class="outline-3">
<h3 id="sec-217-1"><span class="section-number-3">217.1</span> Equations</h3>
<div class="outline-text-3" id="text-217-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isphrase</span> P ==&gt; <span style="color: #ffffff; font-weight: bold;">phrase</span> <span style="color: #ffffff; font-weight: bold;">string</span> P <span style="color: #ff00ff; font-weight: bold;">=</span> P
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-217-2" class="outline-3">
<h3 id="sec-217-2"><span class="section-number-3">217.2</span> Pragmatics</h3>
<div class="outline-text-3" id="text-217-2">
<p>
The correspondence between phrases and strings is not complete in that phrase cannot hold a null character (representation 0) and attempting to build such a phrase using the operation phrase will result in a truncated phrase.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-218" class="outline-2">
<h2 id="sec-218"><span class="section-number-2">218</span> <code>pi</code></h2>
<div class="outline-text-2" id="text-218">

<p>
The expression Pi returns the real number which is the ratio of the circumference of a circle to its diameter.  Pi is useful in scientific computing.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%15.12f'</span> ; <span style="color: #ffffff; font-weight: bold;">Pi</span>
</pre>
</div>
<pre class="example">
3.141592653590
</pre>


<p>
Equation
   Pi = arccos -1 (within roundoff error)
</p>
</div>
</div>

<div id="outline-container-sec-219" class="outline-2">
<h2 id="sec-219"><span class="section-number-2">219</span> <code>pick</code></h2>
<div class="outline-text-2" id="text-219">

<p>
Pick is the fundamental selection operation for arrays.  The normal use is that I is an address for A.  The result is the item that is located at address I in 0-origin addressing.  If I is a solitary integer and A is a list, I is converted to an integer to make it an address for a list.  If I is not a valid address for A, the result is the fault ?address.
</p>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">pick</span> 3 6 23 46 57 25
</pre>
</div>
<pre class="example">
46
</pre>



<div class="org-src-container">

<pre class="src src-nial">[3] <span style="color: #ffffff; font-weight: bold;">pick</span> 3 6 23 46 57 25
</pre>
</div>
<pre class="example">
46
</pre>



<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffaf00;">"a</span> <span style="color: #ffaf00;">"list</span> <span style="color: #ffaf00;">"of</span> <span style="color: #ffaf00;">"words</span> <span style="color: #ffaf00;">"as</span> <span style="color: #ffaf00;">"phrases</span>
</pre>
</div>
<pre class="example">
a     list of
words as   phrases
</pre>


<div class="org-src-container">

<pre class="src src-nial">0 2 <span style="color: #ffffff; font-weight: bold;">pick</span> A
</pre>
</div>
<pre class="example">
of
</pre>

<div class="org-src-container">

<pre class="src src-nial">5 5 <span style="color: #ffffff; font-weight: bold;">pick</span> A
</pre>
</div>
<pre class="example">
?address
</pre>

<p>
In the first example, pick selects the fourth item because of 0-origin indexing.  In the second example, <sup><a id="fnr.2.100" name="fnr.2.100" class="footref" href="#fn.2">2</a></sup> is not an address of the list (its addresses are integers) but it is converted to integer 3.  Thus, a solitary integer can be used as an address of a list for pick.  The third example shows that an address for a table is a pair of integers.  The last example shows that picking out of range returns a fault.
</p>

<p>
The concept of picking closely corresponds to subscript notation in mathematics.  Q'Nial supports a direct notation for subscripting a variable: Var@I.  This notation, called the at notation, can be used on both the left and right of an assignment expression.  Its use on the right is equivalent to pick.
</p>
</div>

<div id="outline-container-sec-219-1" class="outline-3">
<h3 id="sec-219-1"><span class="section-number-3">219.1</span> Equations</h3>
<div class="outline-text-3" id="text-219-1">
<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">pick</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">list</span> I) <span style="color: #ffffff; font-weight: bold;">pick</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> I
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> (<span style="color: #ffff00;">EACH</span> f A) <span style="color: #ff00ff; font-weight: bold;">=</span> f (I <span style="color: #ffffff; font-weight: bold;">pick</span> A)
A <span style="color: #ffffff; font-weight: bold;">choose</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">pick</span> B
I <span style="color: #ffffff; font-weight: bold;">pick</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> \[I] <span style="color: #ffffff; font-weight: bold;">reach</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-220" class="outline-2">
<h2 id="sec-220"><span class="section-number-2">220</span> <code>picture</code></h2>
<div class="outline-text-2" id="text-220">

<p>
The operation picture computes a character table that describes the array A.
</p>

<p>
An atom is displayed directly.  A nonatomic array is displayed as a tableau of rows and columns arranged to allow sufficient space for the largest items.  In most cases, the items of the array are displayed within a frame diagram.
</p>

<p>
The operation is affected by the setting of two internal switches: diagram/sketch and decor/nodecor.  The first controls the use of frames in the pictures.  The second controls the decoration of atoms, solitaries, strings and empty arrays.
</p>

<p>
In diagram mode, a nonatomic array is displayed with a frame and the upper left corner has an o if it is a single.  In sketch mode, a simple array, one having atomic items, is displayed without a frame.  A non-simple array has a frame and a nonatomic single has an o in the upper left corner of the frame.
</p>

<p>
The decor/nodecor switch pictures atoms in an undecorated manner if nodecor mode is set.  If sketch mode is also set, strings and phrases appear the same.  The decor mode pictures atoms so that they can be distinguished: characters are preceded by a grave symbol `, phrases by a double quote " and faults by a question mark ?.  In sketch mode with decor set, a string is enclosed in quotes and a simple solitary is placed in brackets.
</p>

<p>
In sketch mode an empty array has an empty picture, whereas in diagram mode, the picture of an empty array is one side of a frame diagram, with no items.
</p>

<p>
An array of dimensionality higher than two is laid out as an arrangement of tables.  If the array has valence 3, the tables are arranged horizontally.  If it has valence 4, the first axis is placed down the page and the second axis across the page.  Thus, an array of shape 3 4 5 6 is pictured as 3 rows of 4 tables each of which is a 5 by 6 tableau.  A space is left between each of the tables.  For higher dimensions, the axes continue to alternate across and down the page with greater spacing between arrangements.
</p>

<p>
The result of picture coincides with the output displayed by Q'Nial in the top level loop.
</p>

<p>
In the top level loop, the picture is wrapped around as a whole if it is too wide to fit on the screen.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>; <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"nodecor</span>;
P <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">picture</span> l 1 7 7.0 `a <span style="color: #ffaf00;">"a</span> <span style="color: #00ff00;">'a'</span> (3 4 5) <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
+-+-+-+--+-+-+-+-----++
|l|1|7|7.|a|a|a|3 4 5||
+-+-+-+--+-+-+-+-----++
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"nodecor</span>; P
</pre>
</div>
<pre class="example">
+-+-+-+--+-+-+---+-------+-+
|l|1|7|7.|a|a|+-+|+-+-+-+|+|
| | | |  | | ||a|||3|4|5||||
| | | |  | | |+-+|+-+-+-+|+|
+-+-+-+--+-+-+---+-------+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>; <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>; P
</pre>
</div>
<pre class="example">
+-+-+-+--+--+--+---+-----++
|l|1|7|7.|`a|"a|'a'|3 4 5||
+-+-+-+--+--+--+---+-----++
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>; P
</pre>
</div>
<pre class="example">
+-+-+-+--+--+--+----+-------+-+
|l|1|7|7.|`a|"a|+--+|+-+-+-+|+|
| | | |  |  |  ||`a|||3|4|5||||
| | | |  |  |  |+--+|+-+-+-+|+|
+-+-+-+--+--+--+----+-------+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>;
<span style="color: #ffffff; font-weight: bold;">picture</span> 3 4 5
</pre>
</div>
<pre class="example">
+--+--+--+--+--+--+--+
|`+|`-|`+|`-|`+|`-|`+|
+--+--+--+--+--+--+--+
|`||`3|`||`4|`||`5|`||
+--+--+--+--+--+--+--+
|`+|`-|`+|`-|`+|`-|`+|
+--+--+--+--+--+--+--+
</pre>

<p>
The first four examples illustrate the same array pictured with the four combinations of the mode settings.  The final example illustrates that if the result of picture is displayed at top level in diagram - decor mode, the implicit use of picture on the resulting character table causes it to be decorated.
</p>
</div>

<div id="outline-container-sec-220-1" class="outline-3">
<h3 id="sec-220-1"><span class="section-number-3">220.1</span> Equations</h3>
<div class="outline-text-3" id="text-220-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">write</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">writescreen</span> <span style="color: #ffffff; font-weight: bold;">picture</span> A
<span style="color: #ffffff; font-weight: bold;">valence</span> <span style="color: #ffffff; font-weight: bold;">picture</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 2
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-221" class="outline-2">
<h2 id="sec-221"><span class="section-number-2">221</span> <code>place</code></h2>
<div class="outline-text-2" id="text-221">

<p>
The operation place is the fundamental insertion operation for arrays.  The normal use is that I is the address where B is to be placed in a modified version of A.  The result is the modified array.  If I is a solitary integer and A is a list, I is converted to an integer before being used.  If I is not a valid address for A, the result is the fault ?address.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffaf00;">"abc</span> 2 <span style="color: #ffffff; font-weight: bold;">place</span> 2 3 4 5 6
</pre>
</div>
<pre class="example">
2 3 abc 5 6
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">place</span> (`_ 2) <span style="color: #00ff00;">'my work'</span>
</pre>
</div>
<pre class="example">
my_work
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 4 5 6 7
</pre>
</div>
<pre class="example">
4 5 6 7
</pre>



<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 27 2 <span style="color: #ffffff; font-weight: bold;">place</span> A; A
</pre>
</div>
<pre class="example">
4 5 27 7
</pre>


<div class="org-src-container">

<pre class="src src-nial">50 100 <span style="color: #ffffff; font-weight: bold;">place</span> A
</pre>
</div>
<pre class="example">
?address
</pre>


<p>
The fourth example shows the use of place in updating the value of a variable A.  The last example illustrates an out of range use of place.
</p>

<p>
Nial provides a simpler notation for updating a variable.  A@I (pronounced A at I) can be used on the left of assignment to update the item at location I.  If the address is out of range a fault occurs.
</p>

<div class="org-src-container">

<pre class="src src-nial">A@1 <span style="color: #ff00ff;">:=</span> 25
</pre>
</div>
<pre class="example">
4 25 27 7
</pre>


<div class="org-src-container">

<pre class="src src-nial">A@5 <span style="color: #ff00ff;">:=</span> 7
</pre>
</div>
<pre class="example">
?address
</pre>

<div class="org-src-container">

<pre class="src src-nial">A
</pre>
</div>
<pre class="example">
4 25 27 7
</pre>


<p>
The semantics of using the at notation on the left in assignment can be achieved using the operation update.  The at notation and the update operation are usually more efficient than place because they avoid doing a copy of the right argument of place.
</p>
</div>

<div id="outline-container-sec-221-1" class="outline-3">
<h3 id="sec-221-1"><span class="section-number-3">221.1</span> Equations</h3>
<div class="outline-text-3" id="text-221-1">
<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; (I <span style="color: #ffffff; font-weight: bold;">pick</span> A) I <span style="color: #ffffff; font-weight: bold;">place</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
B \[I] <span style="color: #ffffff; font-weight: bold;">deepplace</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> B I <span style="color: #ffffff; font-weight: bold;">place</span> A
I <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt;shape(B I <span style="color: #ffffff; font-weight: bold;">place</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-222" class="outline-2">
<h2 id="sec-222"><span class="section-number-2">222</span> <code>placeall</code></h2>
<div class="outline-text-2" id="text-222">

<p>
The operation placeall generalizes the operation place to modify a collection of items of A.  It returns a modified version of array A with the items at the addresses I replaced by the items of B.  It corresponds to the sequential use of place with corresponding items from B and I.  If an item of I is repeated, its last occurrence will determine the effect on A.  If B has fewer items than I, its items are used cyclically (the first item is used after the last and the list repeated).
</p>


<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffaf00;">"abc</span> <span style="color: #ffaf00;">"def</span>) (2 3) <span style="color: #ffffff; font-weight: bold;">placeall</span> 2 3 4 5 6
</pre>
</div>
<pre class="example">
2 3 abc def 6
</pre>


<div class="org-src-container">

<pre class="src src-nial">Text <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">'my work is fun'</span>;

<span style="color: #ffffff; font-weight: bold;">placeall</span> (<span style="color: #00ff00;">'_'</span> (`  <span style="color: #ffffff; font-weight: bold;">findall</span> Text)) Text
</pre>
</div>
<pre class="example">
my_work_is_fun
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 4 5 6 7 ;
A <span style="color: #ff00ff;">:=</span> (27 28) (3 2) <span style="color: #ffffff; font-weight: bold;">placeall</span> A; A
</pre>
</div>
<pre class="example">
4 5 28 27
</pre>


<p>
The last example shows the use of placeall to update the value of a variable A.
</p>

<p>
Q'Nial provides a simpler notation for updating a variable at several locations.  The notation A#I (pronounced A at all I) can be used on the left of assignment to indicate the update of the items at the addresses given by I.  If an item of I is out of range, the result is a fault but the variable is modified by the assignments done to locations that precede the invalid one.
</p>


<div class="org-src-container">

<pre class="src src-nial">A<span style="color: #66f;">#(0 1) := 25 26</span>
</pre>
</div>
<pre class="example">
25 26 27 7
</pre>

<div class="org-src-container">

<pre class="src src-nial">A<span style="color: #66f;">#(2 100) := 50 51</span>
</pre>
</div>
<pre class="example">
?addresses
</pre>

<div class="org-src-container">

<pre class="src src-nial">A
</pre>
</div>
<pre class="example">
25 26 50 7
</pre>


<p>
The semantics of using the at all notation on the left in assignment can be achieved using the operation updateall.
</p>

<p>
The at all notation and the updateall operation are usually more efficient than placeall as they avoid doing a copy of the entire right argument of placeall.
</p>

<p>
Placeall is not the same as (pack B I) EACHBOTH place A.  The latter results in an array of modifications of A, one for each item to be replaced.
</p>
</div>

<div id="outline-container-sec-222-1" class="outline-3">
<h3 id="sec-222-1"><span class="section-number-3">222.1</span> Equations</h3>
<div class="outline-text-3" id="text-222-1">
<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; (I <span style="color: #ffffff; font-weight: bold;">choose</span> A) I <span style="color: #ffffff; font-weight: bold;">placeall</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> (B I <span style="color: #ffffff; font-weight: bold;">placeall</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-223" class="outline-2">
<h2 id="sec-223"><span class="section-number-2">223</span> <code>plus</code></h2>
<div class="outline-text-2" id="text-223">

<p>
The operation plus is the same as sum except that plus enforces the rule that it must be applied to a pair.
</p>

<p>
Sum is multi pervasive and can add up any number of items.  The symbol + is a synonym for sum.
</p>


<div class="org-src-container">

<pre class="src src-nial">7 <span style="color: #ffffff; font-weight: bold;">plus</span> 9
</pre>
</div>
<pre class="example">
16
</pre>

<div class="org-src-container">

<pre class="src src-nial">(2 3 4) <span style="color: #ffffff; font-weight: bold;">plus</span> (12 22 33)
</pre>
</div>
<pre class="example">
14 25 37
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">plus</span> 2 3 4
</pre>
</div>
<pre class="example">
?plus expects a pair
</pre>
</div>
</div>

<div id="outline-container-sec-224" class="outline-2">
<h2 id="sec-224"><span class="section-number-2">224</span> <code>positions</code></h2>
<div class="outline-text-2" id="text-224">

<p>
The operation positions is used in conjunction with picture on singles, lists or tables.  For such arrays, it returns an array of the same shape with the items being the addresses at which the pictures of the corresponding items of A appear in the picture of A.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #00ffff;">gets</span> 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffaf00;">"cat</span> <span style="color: #00ff00;">'fish'</span> 34.5 <span style="color: #ffaf00;">"dog</span> <span style="color: #00ff00;">'meat'</span> 26.5
</pre>
</div>
<pre class="example">
+---+----+----+
|cat|fish|34.5|
+---+----+----+
|dog|meat|26.5|
+---+----+----+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">positions</span> A
</pre>
</div>
<pre class="example">
+---+---+----+
|1 1|1 5|1 10|
+---+---+----+
|3 1|3 5|3 10|
+---+---+----+
</pre>

<p>
The operation positions is useful in applications that do interactive editing of data from its display on the screen.
</p>
</div>
</div>

<div id="outline-container-sec-225" class="outline-2">
<h2 id="sec-225"><span class="section-number-2">225</span> <code>post</code></h2>
<div class="outline-text-2" id="text-225">

<p>
The operation post restructures an array A to be a table with one column holding the items of A in row major order.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">post</span> 3 4 5
</pre>
</div>
<pre class="example">
3
4
5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">post</span> <span style="color: #00ff00;">'Now is the time'</span>
     <span style="color: #00ff00;">'for all good men'</span>
     <span style="color: #00ff00;">'to come to the aid'</span>
     <span style="color: #00ff00;">'of the party'</span>
</pre>
</div>
<pre class="example">
+------------------+
|Now is the time   |
+------------------+
|for all good men  |
+------------------+
|to come to the aid|
+------------------+
|of the party      |
+------------------+
</pre>

<p>
The major purpose of post is to restructure data for display.
</p>
</div>

<div id="outline-container-sec-225-1" class="outline-3">
<h3 id="sec-225-1"><span class="section-number-3">225.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-225-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">post</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { (<span style="color: #ffffff; font-weight: bold;">tally</span> A) 1 <span style="color: #ffffff; font-weight: bold;">reshape</span> A}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-225-2" class="outline-3">
<h3 id="sec-225-2"><span class="section-number-3">225.2</span> Equations</h3>
<div class="outline-text-3" id="text-225-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">post</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">tally</span> A) 1
<span style="color: #ffffff; font-weight: bold;">post</span> <span style="color: #ffffff; font-weight: bold;">post</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">post</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-226" class="outline-2">
<h2 id="sec-226"><span class="section-number-2">226</span> <code>power</code></h2>
<div class="outline-text-2" id="text-226">

<p>
The operation power returns the result of raising the number A to the power B.  The result is an integer if both A and B are boolean or integer and B is non-negative.  If B is an integer, the power is done by multiplication.  Otherwise it uses exp (B * ln A).
</p>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">power</span> R
</pre>
</div>
<pre class="example">
     1        1         1.  ?A  ?A  ?error
     2        4    5.65685  ?A  ?A  ?error
   2.5     6.25   9.b88212  ?A  ?A  ?error
?A       ?A       ?A        ?A  ?A  ?A
?A       ?A       ?A        ?A  ?A  ?A
?error   ?error   ?error    ?A  ?A  ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">power</span> 3
</pre>
</div>
<pre class="example">
8
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">power</span> -3
</pre>
</div>
<pre class="example">
0.125
</pre>

<div class="org-src-container">

<pre class="src src-nial">16 <span style="color: #ffffff; font-weight: bold;">power</span> .5
</pre>
</div>
<pre class="example">
4.
</pre>

<p>
The examples show that power has different meanings depending on the right argument B.  If B is a positive integer, the result is A multiplied by itself B times.  If B is a negative integer, the result is the reciprocal of the result when B is positive.  The last case illustrates that if B is 0.5, the result is a real number that is a square root of
</p>
</div>

<div id="outline-container-sec-226-1" class="outline-3">
<h3 id="sec-226-1"><span class="section-number-3">226.1</span> Equations</h3>
<div class="outline-text-3" id="text-226-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isreal</span> B ==&gt; A <span style="color: #ffffff; font-weight: bold;">power</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">exp</span> (B <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">ln</span> A)
<span style="color: #ffffff; font-weight: bold;">sqrt</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">power</span> 0.5   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-227" class="outline-2">
<h2 id="sec-227"><span class="section-number-2">227</span> predicate</h2>
<div class="outline-text-2" id="text-227">

<p>
A predicate is an operation that tests a condition and returns true if the condition holds and false otherwise.  A predicate is not pervasive.
</p>

<p>
The predefined predicate operations include:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operation</th>
<th scope="col" class="left">Test</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><a href="#sec-8">8</a></td>
<td class="left">set-like inclusion</td>
</tr>

<tr>
<td class="left"><a href="#sec-24">24</a></td>
<td class="left">an array is an atom</td>
</tr>

<tr>
<td class="left"><a href="#sec-82">82</a></td>
<td class="left">all items differ</td>
</tr>

<tr>
<td class="left"><a href="#sec-94">94</a></td>
<td class="left">an array has no items</td>
</tr>

<tr>
<td class="left"><a href="#sec-95">95</a></td>
<td class="left">all items are equal</td>
</tr>

<tr>
<td class="left"><a href="#sec-152">152</a></td>
<td class="left">arg is a boolean atom</td>
</tr>

<tr>
<td class="left"><a href="#sec-153">153</a></td>
<td class="left">arg is a character atom</td>
</tr>

<tr>
<td class="left"><a href="#sec-154">154</a></td>
<td class="left">arg is a fault symbol</td>
</tr>

<tr>
<td class="left"><a href="#sec-155">155</a></td>
<td class="left">arg is a integer number</td>
</tr>

<tr>
<td class="left"><a href="#sec-156">156</a></td>
<td class="left">arg is a symbol</td>
</tr>

<tr>
<td class="left"><a href="#sec-157">157</a></td>
<td class="left">arg is a real number</td>
</tr>

<tr>
<td class="left"><a href="#sec-158">158</a></td>
<td class="left">arg is a list of characters</td>
</tr>

<tr>
<td class="left"><a href="#sec-169">169</a></td>
<td class="left">two arrays contain same items</td>
</tr>

<tr>
<td class="left"><a href="#sec-260">260</a></td>
<td class="left">string matches a regular expression</td>
</tr>

<tr>
<td class="left"><a href="#sec-295">295</a></td>
<td class="left">all items are atoms</td>
</tr>

<tr>
<td class="left"><a href="#sec-347">347</a></td>
<td class="left">items are not all equal</td>
</tr>

<tr>
<td class="left"><a href="#sec-348">348</a></td>
<td class="left">lexical ordering</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-228" class="outline-2">
<h2 id="sec-228"><span class="section-number-2">228</span> <i>prefix notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-228">

<p>
An operation-expression can precede an array-expression.  This is called a prefix use of the operation expression.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ff00ff; font-weight: bold;">+</span> 7 5
</pre>
</div>
<pre class="example">
12
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reshape</span> [2 3,1 2 3 4 5 6]
</pre>
</div>
<pre class="example">
1 2 3
4 5 6
</pre>
</div>
</div>

<div id="outline-container-sec-229" class="outline-2">
<h2 id="sec-229"><span class="section-number-2">229</span> prelattice of atoms</h2>
<div class="outline-text-2" id="text-229">

<p>
The ordering sequence of the characters for sorting purposes is fixed for each Q'Nial version.
</p>

<p>
The binary and multi pervasive comparative operations of Nial organize the atoms of Nial in a prelattice or sorting sequence.  The operation lte (or &lt;=) does a less than or equal comparison between atoms.  The numeric atoms are comparable, with a coercion being done if the arguments are of different numeric type.  The nadir, represented by the fault ?O, is less than or equal to all atoms.  The zenith, ?I, is greater than or equal to all atoms.  Except for these two special cases, literal atoms are incomparable with atoms of different type.  However, they can be compared within the same type using a character collating sequence that is version specific.
</p>

<p>
Phrases are compared lexicographically, such that "apple is after "ape but before "apt.  Strings, being character lists, produce a list of results when compared.
</p>

<p>
Comparisons are of two forms: binary pervasive predicates which return boolean values and multi pervasive predicates that obtain the largest or smallest item in a list.  If two atoms are incomparable, the predicates return false, whereas max returns the zenith and min returns the nadir.
</p>

<p>
These rules were chosen so that the following laws hold for all arrays A and B:
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">max</span> A <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">and</span> (A <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> B)
A <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #ffffff; font-weight: bold;">min</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">and</span> (A <span style="color: #ffff00;">EACHRIGHT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> B)
</pre>
</div>

<p>
See the entry for up for a discussion of the lexicographic ordering in Q'Nial.
</p>
</div>
</div>

<div id="outline-container-sec-230" class="outline-2">
<h2 id="sec-230"><span class="section-number-2">230</span> <code>product</code></h2>
<div class="outline-text-2" id="text-230">

<p>
The operation product multiplies the items of a simple array of numbers, reducing them to a single number that is their product.  The type of the result is the highest type of the items.  The operation is extended to non-simple arrays by the multi pervasive mechanism.  The symbol * and prod are synonyms for product.  The operation times is product restricted to use on pairs.
For an empty array, the result is 1.
</p>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
l 2 2.5 a abc ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">product</span> R
</pre>
</div>
<pre class="example">
     1       2      2.5  ?A  ?A  ?error
     2       4       5.  ?A  ?A  ?error
   2.5      5.     6.25  ?A  ?A  ?error
?A      ?A      ?A       ?A  ?A  ?A
?A      ?A      ?A       ?A  ?A  ?A
?error  ?error  ?error   ?A  ?A  ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">product</span> 3. 45. 23. 18. 3.5
</pre>
</div>
<pre class="example">
195615.
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">product</span> (3 4 5)(2 3 2)(0 2 4)(1 1 1)
</pre>
</div>
<pre class="example">
0 24 40
</pre>

<p>
The first example shows the result of product on all combinations of types of atoms.  The last example shows that pervasive extension of product multiples a list of triples in an item by item fashion.
</p>
</div>

<div id="outline-container-sec-230-1" class="outline-3">
<h3 id="sec-230-1"><span class="section-number-3">230.1</span> Equations</h3>
<div class="outline-text-3" id="text-230-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">product</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">product</span> B
<span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span>(<span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">single</span>) A
<span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">product</span> A =f= <span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">cart</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
<span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-231" class="outline-2">
<h2 id="sec-231"><span class="section-number-2">231</span> <code>profile</code></h2>
<div class="outline-text-2" id="text-231">

<p>
The operation profile is used to convert the profiling statistics into a displayable form.  If Fnm is a file name, as a string or a phrase, then the output is written to the file.  If it is the empty string, then the profiling
information is displayed on the screen.  If logging is on, it will be copied to the log file.  The gathering of profile statistics must be turned off when profile is called. A detailed example of the output is given in the help entry on profiling.
</p>

<p>
Examples of use:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">profile</span> <span style="color: #ffaf00;">"myprofl</span>
</pre>
</div>
<pre class="example">
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">profile</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
</pre>
</div>
</div>

<div id="outline-container-sec-232" class="outline-2">
<h2 id="sec-232"><span class="section-number-2">232</span> <code>profiletable</code></h2>
<div class="outline-text-2" id="text-232">

<p>
The expression Profiletable is used to summarize the internal data structures that are used in the gathering of profiling statistics to produce the same information that is displayed by the operation profile.  It produces a list of entries, one for each definition that has been encountered during execution with profiling on.  Each entry includes the name, the number of direct calls, the number of recursive calls, the execution time, and a list of subentries for the definitions directly called by the definition.  The subentries summarize the information for the called definitions in the same format except that no further breakdown is given on definitions they call.
</p>

<p>
A detailed example of the output of Profiletable is given in the help entry on profiling.
</p>
<pre class="example">
    Profiletable
+-----------------+-------------------------------------+---
|+----+--+-+----++|+-----+--+-+----+-------------------+|+--
||test|12|0|4.12||||tryit|11|0|4.12|+-----------------+|||ag
|+----+--+-+----++||     |  | |    ||+----+--+-+----++||||
|                 ||     |  | |    |||test|11|0|4.12||||||
|                 ||     |  | |    ||+----+--+-+----++||||
|                 ||     |  | |    |+-----------------+|||
|                 |+-----+--+-+----+-------------------+|+--
+-----------------+-------------------------------------+---


---+-+-+----+--------------------+|
ain|1|0|3.96|+------------------+||
   | | |    ||+-----+--+-+----++|||
   | | |    |||tryit|10|0|3.96|||||
   | | |    ||+-----+--+-+----++|||
   | | |    |+------------------+||
---+-+-+----+--------------------+|
----------------------------------+
</pre>
</div>
</div>

<div id="outline-container-sec-233" class="outline-2">
<h2 id="sec-233"><span class="section-number-2">233</span> <code>profiletree</code></h2>
<div class="outline-text-2" id="text-233">

<p>
The expression Profiletree is used to display the detailed information from the internal data structures that are used in the gathering of profiling statistics.  It produces a nested list of entries showing the calling dynamic calling sequence from top level, with the amount of time and number of calls at each level.  Each entry includes the name, the number of direct calls, the execution time, and a list of subentries for the definitions directly called by the definition.  The subentries provide the same information for the called definitions in the same format including entries on all the definitions that they call in turn.
</p>

<p>
A detailed example of the output of Profiletable is given in the help entry on profiling.
</p>

<p>
Example of use:
</p>
<pre class="example">
    Profiletree
+--------+-+----+-------------------------------------------
|TOPLEVEL|0|4.18|+------------+-----------------------------
|        | |    ||+----+-+--++|+-----+-+----+---------------
|        | |    |||test|1|0.||||tryit|1|0.16|+--------------
|        | |    ||+----+-+--++||     | |    ||+----+-+----++
|        | |    ||            ||     | |    |||test|1|0.16||
|        | |    ||            ||     | |    ||+----+-+----++
|        | |    ||            ||     | |    |+--------------
|        | |    ||            |+-----+-+----+---------------
|        | |    ||            |
|        | |    ||            |
|        | |    ||            |
|        | |    ||            |
|        | |    |+------------+-----------------------------
+--------+-+----+-------------------------------------------

------------------------------------------------------+
--+--------------------------------------------------+|
-+|+-----+-+----+-----------------------------------+||
+|||again|1|3.96|+---------------------------------+|||
||||     | |    ||+-----+--+----+-----------------+||||
||||     | |    |||tryit|10|3.96|+---------------+|||||
||||     | |    |||     |  |    ||+----+--+----++||||||
+|||     | |    |||     |  |    |||test|10|3.96||||||||
-+||     | |    |||     |  |    ||+----+--+----++||||||
  ||     | |    |||     |  |    |+---------------+|||||
  ||     | |    ||+-----+--+----+-----------------+||||
  ||     | |    |+---------------------------------+|||
  |+-----+-+----+-----------------------------------+||
--+--------------------------------------------------+|
------------------------------------------------------+
</pre>
</div>
</div>

<div id="outline-container-sec-234" class="outline-2">
<h2 id="sec-234"><span class="section-number-2">234</span> profiling</h2>
<div class="outline-text-2" id="text-234">

<p>
Q'Nial Profiling Facility
</p>

<p>
Q'Nial has a profiling capability that is used to gather relative execution times for operations, transformers and defined expressions written in Nial.  The profiling capability has the following features:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Command</th>
<th scope="col" class="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">setprofile A</td>
<td class="left">turns on or off the internal routines that collect the statistics</td>
</tr>

<tr>
<td class="left">profile Fnm</td>
<td class="left">that displays the profile data to the screen or writes it to a file</td>
</tr>

<tr>
<td class="left">Clearprofile</td>
<td class="left">clears the current profile information and reinitializes the profiling system</td>
</tr>

<tr>
<td class="left">Profiletable</td>
<td class="left">provides the profile information as a table</td>
</tr>

<tr>
<td class="left">Profiletree</td>
<td class="left">provides the detailed profile information in terms of the call tree</td>
</tr>
</tbody>
</table>

<p>
The operation setprofile is called with argument l to turn on the collection of data for a profiling session.  It is called with argument o to suspend gathering statistics for a session. Both calls to setprofile should be in the same scope, and cannot be nested. Only one profiling session can be underway at a time.
</p>

<p>
The operation profile is called with a text argument (string or phrase) that is used as the file name for the profile information. If an empty string is the argument, the output is sent directly to the screen. It computes the statistics on the profiling session underway, prepares the output, and writes it to the file.
</p>

<p>
The expression Clearprofile clears the two internal data structures that are built as execution is profiled so that a new profiling session can be started.
</p>

<p>
The expression Profiletree provides the summary data that is displayed in the output produced by profile, but stores it in a Nial array.
</p>

<p>
The expression Profiletree provides a dynamic call tree of the execution with related times. This provides a more detailed breakdown of the profile data.  The following session illustrates the use of the profiling capability:
</p>

<div class="org-src-container">

<pre class="src src-nial">  <span style="color: #ffffff; font-weight: bold;">setwidth</span> 60;

  test <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> n {
     z <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">random</span> n n;
     <span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffffff; font-weight: bold;">abs</span> (z <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">inv</span> <span style="color: #ffffff; font-weight: bold;">inv</span> z) }

  tryit <span style="color: #00ffff;">is</span>  <span style="color: #00ffff;">op</span> N { test N }

  again <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> M N { <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> tryit (M <span style="color: #ffffff; font-weight: bold;">reshape</span> N) }

  fact <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> n {
     <span style="color: #00ffff;">IF</span> n&lt;=1 <span style="color: #00ffff;">THEN</span> 1 <span style="color: #00ffff;">ELSE</span> n <span style="color: #ff00ff; font-weight: bold;">*</span> fact (n <span style="color: #ff00ff; font-weight: bold;">-</span> 1) <span style="color: #00ffff;">ENDIF</span> }

  <span style="color: #66f;"># first profiling session</span>

:     <span style="color: #ffffff; font-weight: bold;">setprofile</span> l
o

:     test 20
3.86843e-15

:     tryit 50
2.83107e-14

:     again 10 75
6.72483e-13

:     <span style="color: #ffffff; font-weight: bold;">setprofile</span> o
l

:     <span style="color: #ffffff; font-weight: bold;">profile</span> <span style="color: #00ff00;">''</span>

Total execution <span style="color: #ffffff; font-weight: bold;">time</span> of <span style="color: #ffffff; font-weight: bold;">profile</span> session:        4.780000
Total execution <span style="color: #ffffff; font-weight: bold;">time</span> <span style="color: #ffffff; font-weight: bold;">in</span> top level calls:        4.420000

<span style="color: #00ffff;">op</span> name[.<span style="color: #00ffff;">tr</span> arg]                 calls[rec]    <span style="color: #ffffff; font-weight: bold;">time</span> time/call  <span style="color: #66f;">% time</span>
test..........................   12           4.42   0.3683    100.0&lt;

tryit.........................   11           4.31   0.3918     97.5&lt;
 test.........................   11           4.31   0.3918   100.00

again.........................    1           4.04   4.0400     91.4&lt;
 tryit........................   10           4.04   0.4040   100.00

        <span style="color: #ffffff; font-weight: bold;">profiletree</span>
: +--------+-+----+-------------------------------------------
: |TOPLEVEL|0|4.78|+--------------+---------------------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----++|+-----+-+----+-------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||test|1|0.11||||tryit|1|0.27|+------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----++||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||test|1|0.27
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |+------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              |+-----+-+----+-------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              <span style="color: #ff00ff; font-weight: bold;">|</span>
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              <span style="color: #ff00ff; font-weight: bold;">|</span>
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              <span style="color: #ff00ff; font-weight: bold;">|</span>
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              <span style="color: #ff00ff; font-weight: bold;">|</span>
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |+--------------+---------------------------
: +--------+-+----+-------------------------------------------

--------------------------------------------------------+
----+--------------------------------------------------+|
---+|+-----+-+----+-----------------------------------+||
--+|||again|1|4.04|+---------------------------------+|||
++||||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+-----+--+----+-----------------+||||
: ||||||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||tryit|10|4.04|+---------------+|||||
++||||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||     <span style="color: #ff00ff; font-weight: bold;">|</span>  <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+--+----++||||||
--+|||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||     <span style="color: #ff00ff; font-weight: bold;">|</span>  <span style="color: #ff00ff; font-weight: bold;">|</span>    |||test|10|4.04||||||||
---+||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||     <span style="color: #ff00ff; font-weight: bold;">|</span>  <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+--+----++||||||
    ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||     <span style="color: #ff00ff; font-weight: bold;">|</span>  <span style="color: #ff00ff; font-weight: bold;">|</span>    |+---------------+|||||
    ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+-----+--+----+-----------------+||||
    ||     <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |+---------------------------------+|||
    |+-----+-+----+-----------------------------------+||
----+--------------------------------------------------+|
--------------------------------------------------------+

<span style="color: #66f;"># second profiling session</span>

:     <span style="color: #ffffff; font-weight: bold;">clearprofile</span>

:     <span style="color: #ffffff; font-weight: bold;">setprofile</span> l
o

:     test 30
1.72085e-14

:     fact 4
24

:     <span style="color: #ffffff; font-weight: bold;">setprofile</span> o
l

:     <span style="color: #ffffff; font-weight: bold;">profile</span> <span style="color: #00ff00;">''</span>

Total execution <span style="color: #ffffff; font-weight: bold;">time</span> of <span style="color: #ffffff; font-weight: bold;">profile</span> session:        0.330000
Total execution <span style="color: #ffffff; font-weight: bold;">time</span> <span style="color: #ffffff; font-weight: bold;">in</span> top level calls:        0.050000

<span style="color: #00ffff;">op</span> name[.<span style="color: #00ffff;">tr</span> arg]                 calls[rec]    <span style="color: #ffffff; font-weight: bold;">time</span> time/call  <span style="color: #66f;">% time</span>
test..........................    1           0.01   0.0100     20.0&lt;

fact..........................    1[    3]    0.04   0.0400     80.0&lt;



:     <span style="color: #ffffff; font-weight: bold;">profiletree</span>
: +--------+-+----+-------------------------------------------
: |TOPLEVEL|0|0.33|+--------------+---------------------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----++|+----+-+----+--------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||test|1|0.01||||fact|1|0.04|+-------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+----++||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+--+--
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||fact|1|0.|+-
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  ||+
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  ||+
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |+-
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||+----+-+--+--
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              ||    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |+-------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    ||              |+----+-+----+--------------
: <span style="color: #ff00ff; font-weight: bold;">|</span>        <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>    |+--------------+---------------------------
: +--------+-+----+-------------------------------------------

------------------------------+
-----------------------------+|
----------------------------+||
---------------------------+|||
--------------------------+||||
-------------------------+|||||
----+-+--+--------------+||||||
fact|1|0.|+------------+|||||||
    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  ||+----+-+--++||||||||
    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |||fact|1|0.||||||||||
    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  ||+----+-+--++||||||||
    <span style="color: #ff00ff; font-weight: bold;">|</span> <span style="color: #ff00ff; font-weight: bold;">|</span>  |+------------+|||||||
----+-+--+--------------+||||||
-------------------------+|||||
--------------------------+||||
---------------------------+|||
----------------------------+||
-----------------------------+|
------------------------------+

 <span style="color: #66f;">% end of session</span>
</pre>
</div>
<pre class="example">
</pre>


<p>
The profile statistics show the division of time between the various definitions. For each definition called during the profiling session there is a summary of the number of calls and time used. For each definition there is also a breakdown on the time spent in other definitions that were directly called from that definition.
</p>

<p>
Entries in the profile statistics that have a "&lt;" to the right of the last value are top level calls.  All other entries have been called by these top level calls.
</p>

<p>
The time spent in direct recursive calls is counted in the original call. The number of such calls is placed in brackets after the number of top level calls.
</p>

<p>
The statistics do not account for local definitions within global ones; their execution time is simply added to the time for the global definition.
</p>

<p>
A feature of the profiler not shown in the above example is that when timing a transformer definition, the time spent executing the argument operation(s) is computed in order to understand how much of the cost of the transformer is due to applying the argument operation(s).
</p>

<p>
The accuracy of the timing information is limited by the precision of the information available through system calls to the host system.  For very small definitions the statistics may show no execution time.  Usually their effect can be estimated by considering the execution time of the calling definition.
</p>

<p>
The Profiletable result provides the summarized profile statistics as a quintuple consisting of the name of the definition, the number of calls, the number of recursive calls, the time, and a list of records for each definition it directly calls. Each of the latter records has the same information provided for the routine itself, but does not report on the definitions it itself calls.
</p>

<p>
The Profiletree result starts with a node indicating the toplevel and the total execution time. It has a list of subnodes for each definition called from the top level. Each of these has the number of calls, the execution time and nodes for each definition it calls. A recursive call is reported directly in a subnode and hence a deeply recursive routine will produce a deeply nested array of profile information.
</p>
</div>
</div>

<div id="outline-container-sec-235" class="outline-2">
<h2 id="sec-235"><span class="section-number-2">235</span> program fragment</h2>
<div class="outline-text-2" id="text-235">

<p>
Nial is a programming language specifically designed for use in an interactive environment.  The formal description of the language describes the valid language constructs that can be entered in one interaction; and explains the meaning of one such entry in terms of the environment created by earlier interactions in the same session.  The term program fragment is used to describe a meaningful piece of program text.
</p>

<p>
The rules for writing well formed program fragments in Nial are called the syntax rules of Nial.  A program fragment that is well formed is said to be syntactically correct.  The syntax rules are analogous to the rules of grammar that determine the correctness of English.
</p>
</div>
</div>

<div id="outline-container-sec-236" class="outline-2">
<h2 id="sec-236"><span class="section-number-2">236</span> <code>putfile</code></h2>
<div class="outline-text-2" id="text-236">

<p>
The operation putfile writes the rows of items of A as text records to the file with name Filename.  It is used in conjunction with getfile.  The file must not be open.  Items of A are arrays of characters of any valence.
</p>

<p>
In the following example, three strings would be written to the file Maillist.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">putfile</span> <span style="color: #ffaf00;">"Maillist</span> [<span style="color: #00ff00;">'Now is the time'</span> <span style="color: #00ff00;">'for all goodmen'</span>,<span style="color: #00ff00;">'to come to the aid'</span>]
</pre>
</div>
<pre class="example">
</pre>
</div>

<div id="outline-container-sec-236-1" class="outline-3">
<h3 id="sec-236-1"><span class="section-number-3">236.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-236-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">putfile</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> File A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">isfault</span> (Filenum <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> File <span style="color: #ffaf00;">"w</span>) <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffff00;">ITERATE</span> (Filenum <span style="color: #ffffff; font-weight: bold;">writefile</span>) (<span style="color: #ffffff; font-weight: bold;">link</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A) ;
      <span style="color: #ffffff; font-weight: bold;">close</span> Filenum ;
   <span style="color: #00ffff;">ELSE</span>
      Filenum
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-237" class="outline-2">
<h2 id="sec-237"><span class="section-number-2">237</span> <code>quiet_fault</code></h2>
<div class="outline-text-2" id="text-237">

<p>
The operation <a href="#sec-237">237</a> is a version of operation fault that turns off fault triggering before producing the fault and restores the triggering switch to its prior value after producing the fault.
</p>
</div>

<div id="outline-container-sec-237-1" class="outline-3">
<h3 id="sec-237-1"><span class="section-number-3">237.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-237-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">quiet_fault</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Str {
   Oldsetting <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">settrigger</span> o;
   Res <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">fault</span> Str;
   <span style="color: #ffffff; font-weight: bold;">settrigger</span> Oldsetting;
   Res }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-238" class="outline-2">
<h2 id="sec-238"><span class="section-number-2">238</span> <code>quotient</code></h2>
<div class="outline-text-2" id="text-238">

<p>
The operation quotient returns the quotient of dividing integer A by integer B.  If the divisor B is zero, the result is zero.  If it is negative, the result is the fault ?negative divisor.  The operation quotient converts boolean arguments to integer but otherwise produces a fault if either argument is not an integer.
</p>



<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>;
R <span style="color: #ffff00;">OUTER</span> <span style="color: #ffffff; font-weight: bold;">quotient</span> R
</pre>
</div>
<pre class="example">
     1       0  ?A      ?A  ?A  ?error
     2       1  ?A      ?A  ?A  ?error
?A      ?A      ?A      ?A  ?A  ?error
?A      ?A      ?A      ?A  ?A  ?A
?A      ?A      ?A      ?A  ?A  ?A
?error  ?error  ?error  ?A  ?A  ?error
</pre>

<div class="org-src-container">

<pre class="src src-nial">(5 <span style="color: #ffffff; font-weight: bold;">quotient</span> 2) (-5 <span style="color: #ffffff; font-weight: bold;">quotient</span> 2)
</pre>
</div>
<pre class="example">
2 -3
</pre>

<div class="org-src-container">

<pre class="src src-nial">(5 <span style="color: #ffffff; font-weight: bold;">quotient</span> -2) (5 <span style="color: #ffffff; font-weight: bold;">quotient</span> 0)
</pre>
</div>
<pre class="example">
?negative divisor 0
</pre>


<p>
The first example illustrates all combinations of atom types for the two arguments to quotient.
</p>

<p>
The quotient on division by a positive integer B is always an integer on the same side of the origin as A.  The result of A quotient 0 is 0 rather than a fault since this rule is compatible with the choice that A mod 0 is A.   The operation quotient is used in place of divide in situations where the result must be an integer.
</p>

<p>
Equation
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isinteger</span> A ==&gt; A <span style="color: #ffffff; font-weight: bold;">quotient</span> 0 <span style="color: #ff00ff; font-weight: bold;">=</span> 0
<span style="color: #ffffff; font-weight: bold;">floor</span> (A <span style="color: #ff00ff; font-weight: bold;">-</span> (B*(A <span style="color: #ffffff; font-weight: bold;">quotient</span> B))) =f= A <span style="color: #ffffff; font-weight: bold;">mod</span> B
A <span style="color: #ffffff; font-weight: bold;">quotient</span> B =f=  <span style="color: #ffffff; font-weight: bold;">floor</span> (A <span style="color: #ff00ff; font-weight: bold;">/</span> B)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-239" class="outline-2">
<h2 id="sec-239"><span class="section-number-2">239</span> <code>raise</code></h2>
<div class="outline-text-2" id="text-239">

<p>
The operation raise is used to partition an array A along its axes by indicating that the first N axes are to be retained in the result.  The remaining axes become axes of the items of the result.  N must be an integer in the range from 0 to valence A.  The result is an array of shape given by taking the first N items of shape A.  The items of the result have the shape given by dropping the first N items of shape A.  Thus, the 2 raise of an array of shape 3 4 2 is a 3 by 4 table of pairs.  The 1 raise of the same array is a triple of 4 by 2 tables.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 3 4 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'ABCDEFGHIJKLMNOPQRSTUVWX'</span>
</pre>
</div>
<pre class="example">
AB  IJ  QR
CD  KL  ST
EF  MN  UV
GH  OP  WX
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">raise</span> A
</pre>
</div>
<pre class="example">
+--+--+--+--+
|AB|CD|EF|GH|
+--+--+--+--+
|IJ|KL|MN|OP|
+--+--+--+--+
|QR|ST|UV|WX|
+--+--+--+--+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">raise</span> A
</pre>
</div>
<pre class="example">
+--+--+--+
|AB|IJ|QR|
|CD|KL|ST|
|EF|MN|UV|
|GH|OP|WX|
+--+--+--+
</pre>
</div>

<div id="outline-container-sec-239-1" class="outline-3">
<h3 id="sec-239-1"><span class="section-number-3">239.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-239-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">raise</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { N <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">split</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-239-2" class="outline-3">
<h3 id="sec-239-2"><span class="section-number-3">239.2</span> Equations</h3>
<div class="outline-text-3" id="text-239-2">
<div class="org-src-container">

<pre class="src src-nial">N a nonnegative integer <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt;
                         <span style="color: #ffffff; font-weight: bold;">shape</span> (N <span style="color: #ffffff; font-weight: bold;">raise</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> N <span style="color: #ffffff; font-weight: bold;">take</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> (N <span style="color: #ffffff; font-weight: bold;">raise</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> N <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> (N <span style="color: #ffffff; font-weight: bold;">raise</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-240" class="outline-2">
<h2 id="sec-240"><span class="section-number-2">240</span> <code>random</code></h2>
<div class="outline-text-2" id="text-240">

<p>
The operation random is used to generate pseudo-random real numbers in the range from 0.  to 1.  The argument S is a shape and random generates product S numbers storing them in an array of shape S. Random uses a congruential method with period 2147483647.  The random generator generates a sequence of integers using the formula: R := 16807 * R mod 214783647 starting with R = 314159262.  The result is the real R/2147483647.  The sequence can be initialized using the operation seed with an argument N, where 0. &lt; N &lt; 1.0.
</p>

<p>
Seed resets the random number generator to use R = floor (R1 * 214783647.).
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seed</span> 0.314159; <span style="color: #ffffff; font-weight: bold;">random</span> 5
</pre>
</div>
<pre class="example">
0.070 0.743 0.240 0.627 0.309
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">floor</span> ( 100. <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">random</span> 2 5 )
</pre>
</div>
<pre class="example">
98 19 94 47 36
88 44 47 82 38
</pre>

<p>
The first example shows the five random numbers generated after a seed of 0.314159 is used.  The second example illustrates how to use the operation random to generate 10 random integers between 0 and 99 and store them in an array of shape 2 5.
</p>
</div>
</div>

<div id="outline-container-sec-241" class="outline-2">
<h2 id="sec-241"><span class="section-number-2">241</span> <code>RANK</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-241">

<p>
The transformer <i>=RANK=</i> applies an operation f to arrays formed from the last N axes of A.  The results of the applications of f  must all be the same shape and are combined to form a result array using mix.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffff00;">RANK</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> (3 4 5 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 60)
</pre>
</div>
<pre class="example">
20 19 18 17 16   40 39 38 37 36   60 59 58 57 56
15 14 13 12 11   35 34 33 32 31   55 54 53 52 51
10  9  8  7  6   30 29 28 27 26   50 49 48 47 46
 5  4  3  2  1   25 24 23 22 21   45 44 43 42 41
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffff00;">RANK</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 12)
</pre>
</div>
<pre class="example">
10 26 42
</pre>

<p>
The first example reverses the planes of the generated array.  The second example sums the rows of the generated matrix.
</p>
</div>

<div id="outline-container-sec-241-1" class="outline-3">
<h3 id="sec-241-1"><span class="section-number-3">241.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-241-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">RANK</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> N A {
   <span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #ffff00;">EACH</span> f (N <span style="color: #ffffff; font-weight: bold;">lower</span> A) }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-242" class="outline-2">
<h2 id="sec-242"><span class="section-number-2">242</span> <code>reach</code></h2>
<div class="outline-text-2" id="text-242">

<p>
The operation reach is used to select an array at an arbitrary path P within the nested structure of A.  P is a list of addresses where the first item of P selects an item of A, the second selects an item of that item, etc.  If P is empty, the result is A.  The operation is implemented as an iterated pick and hence the addresses in the path are converted using first if they are solitary integers.  If one of the picks attempts a selection out of bounds, the result is fault ?path.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> (<span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #00ff00;">'ABCDEFGHIJKL'</span> <span style="color: #00ff00;">'1234567890ab'</span>)
</pre>
</div>
<pre class="example">
+--+--+--+--+
|A1|B2|C3|D4|
+--+--+--+--+
|E5|F6|G7|H8|
+--+--+--+--+
|I9|J0|Ka|Lb|
+--+--+--+--+
</pre>


<div class="org-src-container">

<pre class="src src-nial">(2 0) 1 <span style="color: #ffffff; font-weight: bold;">reach</span> A
</pre>
</div>
<pre class="example">
9
</pre>

<p>
In the example, the path (2 0) 1 picks the item with address 1 of the location with address 2 0.
</p>

<p>
Q'Nial supports a direct notation for doing a reach into an array associated with a variable: Var@@I (pronounced Var at path I).  The at path notation can be used on both the left and right of an assignment expression.
</p>
</div>

<div id="outline-container-sec-242-1" class="outline-3">
<h3 id="sec-242-1"><span class="section-number-3">242.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-242-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reach</span> <span style="color: #00ffff;">IS</span> P A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> P <span style="color: #00ffff;">THEN</span>
      A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">rest</span> P <span style="color: #ffffff; font-weight: bold;">reach</span> (<span style="color: #ffffff; font-weight: bold;">first</span> P <span style="color: #ffffff; font-weight: bold;">pick</span> A)
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-242-2" class="outline-3">
<h3 id="sec-242-2"><span class="section-number-3">242.2</span> Equations</h3>
<div class="outline-text-3" id="text-242-2">
<div class="org-src-container">

<pre class="src src-nial">P <span style="color: #ffffff; font-weight: bold;">reach</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">list</span> P) <span style="color: #ffffff; font-weight: bold;">reach</span> A
items of P are valid addresses where used ==&gt; (P <span style="color: #ffffff; font-weight: bold;">reach</span> A) P <span style="color: #ffffff; font-weight: bold;">deepplace</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-243" class="outline-2">
<h2 id="sec-243"><span class="section-number-2">243</span> <code>read</code></h2>
<div class="outline-text-2" id="text-243">

<p>
The operation read is used in an interaction with the user running a program to obtain an array value from the keyboard after issuing a prompt given by the string or character P.  After receiving the prompt, the user types a sequence of characters and then presses the Return key.  The sequence of characters, excluding the Return, becomes the string entered.  The string is executed to give the result of read.  If the string being executed contains an integer representation that would convert to a number outside the range of integers, the corresponding real number is returned.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">read</span> <span style="color: #00ff00;">'Type an expression : '</span>;
</pre>
</div>
<pre class="example">
Type an expression : 3 + count 10
</pre>

<div class="org-src-container">

<pre class="src src-nial">A
</pre>
</div>
<pre class="example">
4 5 6 7 8 9 10 11 12 13
</pre>

<p>
The operation read is similar to operation readscreen.  The difference is that in read the string received from the keyboard is evaluated, whereas in readscreen, the string is returned.
</p>
</div>

<div id="outline-container-sec-243-1" class="outline-3">
<h3 id="sec-243-1"><span class="section-number-3">243.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-243-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">read</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> P { <span style="color: #ffffff; font-weight: bold;">execute</span> <span style="color: #ffffff; font-weight: bold;">readscreen</span> P }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-244" class="outline-2">
<h2 id="sec-244"><span class="section-number-2">244</span> <code>readarray</code></h2>
<div class="outline-text-2" id="text-244">

<p>
The operation readarray is used to read the component or components indicated by N from the direct access file with file port Fnum.  The file must have been created using writearray and must have been opened as a direct file using open.
</p>

<p>
If N is an integer, the result is the array stored at record position N of the file.
</p>

<p>
If N is a list of integers, the result is a list of the corresponding records.  If there is no record at position N, the result is the fault ?missing.  If N is greater than filetally A, the result is the fault ?eof.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">readarray</span> Fnum [23,24,25];
</pre>
</div>
<pre class="example">
</pre>

<p>
If N is a solitary integer, the result is a solitary holding the selected item.
</p>
</div>
</div>

<div id="outline-container-sec-245" class="outline-2">
<h2 id="sec-245"><span class="section-number-2">245</span> <code>readchar</code></h2>
<div class="outline-text-2" id="text-245">

<p>
The expression Readchar is used to obtain the result of a single keystroke on the keyboard.  The character is not displayed on the screen automatically.  If the keystroke corresponds to a single displayable ASCII character, the result is that character.  Otherwise, the result is a phrase indicating the function key pressed.
</p>

<p>
Q'Nial supports all the standard keys of the IBMPC keyboard.  On a non-IBMPC version of Q'Nial, these keys are available through use of escape sequences.
</p>

<p>
The input from Readchar can be displayed by the use of writechars.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">writechars</span> <span style="color: #ffffff; font-weight: bold;">Readchar</span>
</pre>
</div>
<pre class="example">
Backspace
</pre>

<p>
In the example, the user responded by pressing the backspace key.
</p>

<p>
Readchar is used when developing an interactive program in which the user uses keystrokes to indicate requested actions.  The decision whether or not to display a character on the screen can be made by the program rather than done automatically.
</p>

<p>
The following table lists the non-character keystrokes recognized on the IBMPC keypad and gives the default sequences accepted by an ASCII terminal when the corresponding keystroke is not present.  The two keyboard layouts on SUN workstations behave like an IBMPC keyboard.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">IBMPC</th>
<th scope="col" class="left">IBMPC Keystroke</th>
<th scope="col" class="left">Sun Console</th>
<th scope="col" class="left">Ascii Terminal</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Return</td>
<td class="left">Return</td>
<td class="left">Return</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Backspace</td>
<td class="left">Backspace</td>
<td class="left">Backspace</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Del</td>
<td class="left">Del</td>
<td class="left">Del</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ins</td>
<td class="left">Esc Esc i</td>
<td class="left">Esc Esc i</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Up<sub>Arrow</sub></td>
<td class="left">Up<sub>Arrow</sub></td>
<td class="left">Up<sub>Arrow</sub></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Down<sub>Arrow</sub></td>
<td class="left">Down<sub>Arrow</sub></td>
<td class="left">Down<sub>Arrow</sub></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Right<sub>Arrow</sub></td>
<td class="left">Right<sub>Arrow</sub></td>
<td class="left">Right<sub>Arrow</sub></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Left<sub>Arrow</sub></td>
<td class="left">Left<sub>Arrow</sub></td>
<td class="left">Left<sub>Arrow</sub></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Home</td>
<td class="left">Home</td>
<td class="left">Esc Esc h</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">End</td>
<td class="left">End</td>
<td class="left">Esc Esc e</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">PgUp</td>
<td class="left">PgUp</td>
<td class="left">Esc Esc u</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">PgDn</td>
<td class="left">PgDn</td>
<td class="left">Esc Esc d</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl Left<sub>Arrow</sub></td>
<td class="left">Esc Left<sub>Arrow</sub></td>
<td class="left">Esc Esc c l</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl Right<sub>Arrow</sub></td>
<td class="left">Esc Right<sub>Arrow</sub></td>
<td class="left">Esc Esc c r</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl PgUp</td>
<td class="left">Esc PgUp</td>
<td class="left">Esc Esc c u</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl PgDn</td>
<td class="left">Esc PgDn</td>
<td class="left">Esc Esc c d</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl Home</td>
<td class="left">Esc Home</td>
<td class="left">Esc Esc c h</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Ctrl End</td>
<td class="left">Esc End</td>
<td class="left">Esc Esc c e</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Tab</td>
<td class="left">Tab</td>
<td class="left">Tab</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Shift Tab</td>
<td class="left">Esc Tab</td>
<td class="left">Esc Tab</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Esc</td>
<td class="left">Esc Esc Esc</td>
<td class="left">Esc Esc Esc</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">F1 to F10</td>
<td class="left">F1 to F10</td>
<td class="left">Esc 1 to Esc 0</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">&lt;Alt F1&gt; to &lt;Alt F10&gt;</td>
<td class="left">Esc F1 to Esc F12</td>
<td class="left">Esc Esc 1 to Esc Esc 0</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">&lt;Alt A&gt; to &lt;Alt Z&gt;</td>
<td class="left">&lt;Esc a&gt; to &lt;Esc z&gt;</td>
<td class="left">&lt;Esc a&gt; to &lt;Esc z&gt;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
The IBMPC keyboard support also recognizes the function keys modified by Shift and Ctrl and &lt;Alt 0&gt; to &lt;Alt 9&gt; but these are not mapped onto corresponding escape sequences in the Unix version.
</p>

<p>
The keyboard mappings are set by default but may be controlled by description files stored in the initial directory.
</p>
</div>
</div>

<div id="outline-container-sec-246" class="outline-2">
<h2 id="sec-246"><span class="section-number-2">246</span> <code>readcursor</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="kvm">kvm</span></span></h2>
<div class="outline-text-2" id="text-246">

<p>
The expression <i>=Readcursor=</i> returns a pair of integers indicating the row and column position of the cursor in the active window.
</p>

<p>
It is used in developing an interactive application in which the cursor must be returned to an expected position after some task such as displaying a pop up window.
</p>
</div>
</div>

<div id="outline-container-sec-247" class="outline-2">
<h2 id="sec-247"><span class="section-number-2">247</span> <code>readfield</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-247">

<p>
The operation readfield is used to read a portion of an existing host file as a character string.  The string or phrase Filename is the name of the file, the integer Start is the offset to the beginning of the field to be read and integer Size is the size of the field to be read.  The result is character string of the items read.  If the logical field extends across a line boundary the field will include the newline indicator appropriate for the host system (either linefeed or return-linefeed).
</p>

<p>
Example
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">readfield</span> <span style="color: #ffaf00;">"Myfile</span> 80 20
</pre>
</div>
<pre class="example">
</pre>

<p>
The result is the string beginning at offset 80 in file Myfile of length 20.
</p>
</div>
</div>

<div id="outline-container-sec-248" class="outline-2">
<h2 id="sec-248"><span class="section-number-2">248</span> <code>readfile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-248">

<p>
The operation readfile is used to read the next record from the sequential text file designated by file port Fnum.  The file port Fnum is the integer returned by open, which must have been called before executing the readfile.
</p>

<p>
A record of text in a text file is a sequence of characters up to but excluding an end-of-line indication.  The end-of-line indication is system dependent and may be one or more characters.  The interface between Q'Nial and the host system recognizes end-of-line and, on successive readfile requests, returns the records of the text file with the end-of-line indications removed.
</p>

<p>
If readfile is used with a second argument N, it reads the next N bytes of the text file and returns them as a string.  In this usage, end-of-line characters are processed as any other character and are not removed.  This second form is intended for reading information from device drivers or a communications port, where end-of-line indications may not be given.
</p>

<p>
The following example shows a text file, Myfile being opened and its records being gathered as a list of strings.  The example has the same effect as the expression getfile "Myfile.
</p>

<div class="org-src-container">

<pre class="src src-nial">File_number <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> <span style="color: #ffaf00;">"Myfile</span> <span style="color: #ffaf00;">"r</span> ;
Records <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">''</span> ;
Record <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> File_number ;
<span style="color: #00ffff;">WHILE</span> Record <span style="color: #ff00ff; font-weight: bold;">~=</span> ?<span style="color: brightred;">?eof</span> <span style="color: #00ffff;">DO</span>
     Records <span style="color: #00ffff;">gets</span> Records <span style="color: #ffffff; font-weight: bold;">append</span> Record ;
     Record <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> File_number ;
<span style="color: #00ffff;">ENDWHILE</span> ;
<span style="color: #ffffff; font-weight: bold;">close</span> File_number ;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-249" class="outline-2">
<h2 id="sec-249"><span class="section-number-2">249</span> <code>readrecord</code></h2>
<div class="outline-text-2" id="text-249">

<p>
The operation readrecord is used to read the component or components indicated by N from the direct access file with file port Fnum.  If N is an integer, the result is the string stored at component position N of the file.  The file must have been opened as a direct file and must have been created using writerecord.
</p>

<p>
If N is a list of integers, the result is a list of the corresponding records.  If there is no component at N, the result is the fault ?missing.  If N is greater than filetally A, the result is the fault ?eof.
</p>

<p>
A direct access file is stored as two host system files: a .ndx file holding index information and a .rec file holding the records.
</p>
<pre class="example">
readrecord Fnum [23,24,25];
</pre>

<div class="org-src-container">

<pre class="src src-nial">convert_records <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">OP</span> Filein Fileout {
   Fin <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> Filein <span style="color: #ffaf00;">"d</span> ;
   Fout <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> Fileout <span style="color: #ffaf00;">"d</span> ;
   Num <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">filetally</span> Fin ;
   <span style="color: #ffffff; font-weight: bold;">writerecord</span> Fout (<span style="color: #ffffff; font-weight: bold;">tell</span> Num)
   (<span style="color: #ffff00;">EACH</span> convert_op (<span style="color: #ffffff; font-weight: bold;">readrecord</span> Fin (<span style="color: #ffffff; font-weight: bold;">tell</span> Num)));
   <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">close</span> Fin Fout ; }
</pre>
</div>

<p>
The first example shows a call of readrecord that returns three records.  The second example shows an operation convert<sub>records</sub> that reads all the records in direct file Filein, modifies them by convert<sub>op</sub> and writes them to direct file Fileout.  For a very large file, it may be necessary to replace the use of <i>=EACH=</i> with a loop.
</p>

<p>
The readrecord operation can access fields of a fixed format file created external to Q'Nial.  If the component number used in a readrecord is beyond the end of file as indicated by the filetally Fnum, stored in the .ndx file, the .rec file is checked to see if the host file information indicates that the .rec file extends beyond the length expected for a file created by the Q'Nial operations.  If so, the .rec file is assumed to consist of a sequence of blocks of records, with each block having fields of the sizes indicated by the .ndx file.  The index information for the record at (N mod filetally Fnum) is used to find the requested component within the block of records found from (N quotient filetally Fnum).
</p>

<p>
To use this feature, a separate process must be followed to create the .ndx file corresponding to one block of records in the external file.  This is done by writing a sequence of strings of the lengths of the records to a dummy direct access file and then renaming the resulting index file and the external file to be names expected by the Q'Nial direct access facility.
</p>
</div>
</div>

<div id="outline-container-sec-250" class="outline-2">
<h2 id="sec-250"><span class="section-number-2">250</span> <code>readscreen</code></h2>
<div class="outline-text-2" id="text-250">

<p>
The operation readscreen is used to obtain a string from the keyboard after issuing the prompt P.  The prompt P must be a character or a string.  After receiving the prompt, the user types a sequence of characters and then presses the Return key.  The sequence of characters, excluding the Return, is the string returned as the result of readscreen.
</p>

<div class="org-src-container">

<pre class="src src-nial">Name <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readscreen</span> <span style="color: #00ff00;">'Your name? : '</span> ;
</pre>
</div>
<pre class="example">
Your name? : Mike
</pre>


<div class="org-src-container">

<pre class="src src-nial">Name
</pre>
</div>
<pre class="example">
Mike
</pre>

<div class="org-src-container">

<pre class="src src-nial">Answer <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #00ff00;">'Do you wish to continue? y/n: '</span> ;
<span style="color: #00ffff;">IF</span> Answer <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #00ff00;">'yY'</span> <span style="color: #00ffff;">THEN</span> ...
</pre>
</div>


<p>
The operation readscreen is similar to the operation read, the difference being that in read, the string received from the keyboard is evaluated, whereas with readscreen, the string is returned.
</p>
</div>
</div>

<div id="outline-container-sec-251" class="outline-2">
<h2 id="sec-251"><span class="section-number-2">251</span> <code>reciprocal</code></h2>
<div class="outline-text-2" id="text-251">

<p>
The operation reciprocal or recip for short, returns a real number which is the reciprocal value of a numeric atom.
</p>

<p>
Reciprocal produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">reciprocal of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">reciprocal of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">1.0 / A if A ~= 0.; ?div if A = 0.</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reciprocal</span> l -2 3.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1. -0.5 0.285714 ?A ?A ?error
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reciprocal</span> -2 (3 -4.5)
</pre>
</div>
<pre class="example">
+----+------------------+
|-0.5|0.333333 -0.222222|
+----+------------------+
</pre>
</div>

<div id="outline-container-sec-251-1" class="outline-3">
<h3 id="sec-251-1"><span class="section-number-3">251.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-251-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reciprocal</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (1 <span style="color: #ffffff; font-weight: bold;">divide</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-251-2" class="outline-3">
<h3 id="sec-251-2"><span class="section-number-3">251.2</span> Equations</h3>
<div class="outline-text-3" id="text-251-2">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">divide</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> B
<span style="color: #ffffff; font-weight: bold;">reciprocal</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reciprocal</span> A   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-252" class="outline-2">
<h2 id="sec-252"><span class="section-number-2">252</span> <code>recover</code></h2>
<div class="outline-text-2" id="text-252">

<p>
The operation recover is prepared by the user of Q'Nial to handle the action to be taken on detection of &lt;Ctrl c&gt; or any other situation that forces a return to top level.  If a recover operation does not exist in the workspace, Q'Nial returns to the top level loop on a &lt;Ctrl c&gt;.  This operation is necessary to provide control over closed applications which do not permit the user to access Q'Nial at the top level loop.  On its call the argument provided to the operation will be a character string giving the nature of the interruption, for example 'user interrupt' if a Ctrl-C has occurred or 'programmed interrupt' if toplevel has been called.
</p>


<div class="org-src-container">

<pre class="src src-nial">recover <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">OP</span> Msg { <span style="color: #ffffff; font-weight: bold;">Continue</span>; }
</pre>
</div>

<div class="org-src-container">

<pre class="src src-nial">recover <span style="color: #00ffff;">IS</span> <span style="color: #00ffff;">Op</span> Msg {
   <span style="color: #00ffff;">IF</span> Msg <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #00ff00;">'user interrupt'</span> <span style="color: #00ffff;">THEN</span>
      <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">readscreen</span> <span style="color: #00ff00;">'Do you wish to restart? y or n : '</span> <span style="color: #ffffff; font-weight: bold;">in</span> <span style="color: #00ff00;">'yY'</span> <span style="color: #00ffff;">THEN</span>
         <span style="color: #ffffff; font-weight: bold;">Restart</span>
      <span style="color: #00ffff;">ELSE</span>
         <span style="color: #ffffff; font-weight: bold;">Continue</span>
      <span style="color: #00ffff;">ENDIF</span>
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffffff; font-weight: bold;">Continue</span>
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>

<p>
In the first example, if &lt;Ctrl c&gt; is pressed or some other action forces a jump to top level, the session ends saving the workspace in continue.nws.  The message parameter is ignored.
</p>

<p>
In the second example of a definition for recover, a jump to top level by a &lt;Ctrl-C&gt; interrupt results in the display of the prompt:
</p>
<pre class="example">
Do you wish to restart? y or n :
</pre>

<p>
If the response is text that begins with y or Y, the expression Restart is executed.  If the session had begun with a workspace named on the command line, the workspace would be reloaded and its Latent expression, if any, evaluated.  If the response begins with something other than y or Y, or the interrupt was of some other kind then the current session ends by executing Continue.
</p>
</div>
</div>

<div id="outline-container-sec-253" class="outline-2">
<h2 id="sec-253"><span class="section-number-2">253</span> <code>RECUR</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-253">

<p>
<i>=RECUR=</i> is a general recursion transformer with five operation arguments: test checks that the argument meets an end condition, endf is applied to the end argument before starting to build the result, parta computes the left value from the argument, which is stacked, joinf combines the left and right values as the recursion unwinds, and partb gives the value to be recurred on to produce the right value.The recursion terminates provided the repeated application of the operation partb results in an array that satisfies test.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">RECUR</span> [ 0 <span style="color: #ff00ff; font-weight: bold;">=</span>, 1 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">product</span>, -1 <span style="color: #ff00ff; font-weight: bold;">+</span>] 4
</pre>
</div>
<pre class="example">
24
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">RECUR</span> [ <span style="color: #ffffff; font-weight: bold;">empty</span>, 0 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">plus</span>, <span style="color: #ffffff; font-weight: bold;">rest</span> ] 3 4 5
</pre>
</div>
<pre class="example">
12
</pre>
</div>

<div id="outline-container-sec-253-1" class="outline-3">
<h3 id="sec-253-1"><span class="section-number-3">253.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-253-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">RECUR</span> <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">TR</span> test endf parta joinf partb <span style="color: #00ffff;">OP</span> A {
   Elements <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>;
   <span style="color: #00ffff;">WHILE</span> <span style="color: #ffffff; font-weight: bold;">not</span> test A <span style="color: #00ffff;">DO</span>
      Elements <span style="color: #ff00ff;">:=</span> Elements <span style="color: #ffffff; font-weight: bold;">append</span> parta A;
      A <span style="color: #ff00ff;">:=</span> partb A;
   <span style="color: #00ffff;">ENDWHILE</span>;
   Res <span style="color: #ff00ff;">:=</span> endf A;
   <span style="color: #00ffff;">FOR</span> E <span style="color: #00ffff;">WITH</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> Elements <span style="color: #00ffff;">DO</span>
      Res <span style="color: #ff00ff;">:=</span> E joinf Res;
   <span style="color: #00ffff;">ENDFOR</span>;
   Res }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-253-2" class="outline-3">
<h3 id="sec-253-2"><span class="section-number-3">253.2</span> Equations</h3>
<div class="outline-text-3" id="text-253-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">RECUR</span> [test, endf, parta, joinf, partb] A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">FORK</span> [test, endf, joinf [parta, <span style="color: #ffff00;">RECUR</span> [test, endf, parta, joinf, partb] partb]] A
<span style="color: #ffff00;">RECUR</span> [ 0 <span style="color: #ff00ff; font-weight: bold;">=</span>, 1 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">pass</span>, <span style="color: #ffffff; font-weight: bold;">product</span>, -1 <span style="color: #ff00ff; font-weight: bold;">+</span>] N <span style="color: #ff00ff; font-weight: bold;">=</span> factorial N
<span style="color: #ffff00;">RECUR</span> [ <span style="color: #ffffff; font-weight: bold;">empty</span>, 0 <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">first</span>, <span style="color: #ffffff; font-weight: bold;">plus</span>, <span style="color: #ffffff; font-weight: bold;">rest</span> ] A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-254" class="outline-2">
<h2 id="sec-254"><span class="section-number-2">254</span> <code>REDUCE</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-254">

<p>
The transformer <i>=REDUCE=</i> transforms an operation f into an operation which, when applied to an array A, has the same effect as evaluating an expression in which f is placed between the items of the array, with grouping done in a right-to-left manner.  If f is an operation that maps a pair of atoms to an atom, REDUCE f reduces a simple array to an atom.  For the built-in reductive operations: sum, product, and, or, max, min, and link, REDUCE f is the same as f.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #ffffff; font-weight: bold;">divide</span> 3 4 5 6
</pre>
</div>
<pre class="example">
.625
</pre>


<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">divide</span> (4 <span style="color: #ffffff; font-weight: bold;">divide</span> ( 5 <span style="color: #ffffff; font-weight: bold;">divide</span> 6 ) )
</pre>
</div>
<pre class="example">
.625
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #ffffff; font-weight: bold;">plus</span> (<span style="color: #ffffff; font-weight: bold;">count</span> 10)
</pre>
</div>
<pre class="example">
55
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #00ff00;">'abcde'</span>
</pre>
</div>
<pre class="example">
abcde
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #ffffff; font-weight: bold;">append</span> <span style="color: #00ff00;">'abcde'</span>
</pre>
</div>
<pre class="example">
+-+----------+
|a|+-+------+|
| ||b|+-+--+||
| || ||c|de|||
| || |+-+--+||
| |+-+------+|
+-+----------+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #ffffff; font-weight: bold;">pass</span> 73 45 39 97
</pre>
</div>
<pre class="example">
+--+----------+
|73|+--+-----+|
|  ||45|39 97||
|  |+--+-----+|
+--+----------+
</pre>
</div>

<div id="outline-container-sec-254-1" class="outline-3">
<h3 id="sec-254-1"><span class="section-number-3">254.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-254-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #66f;">% if f is reductive, apply f directly;</span>
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #00ffff;">THEN</span>
      Res <span style="color: #ff00ff;">:=</span> ?<span style="color: brightred;">?identity</span>;
   <span style="color: #00ffff;">ELSE</span>
      Res <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">last</span> A;
      <span style="color: #00ffff;">FOR</span> B <span style="color: #00ffff;">WITH</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">front</span> A <span style="color: #00ffff;">DO</span>
         Res <span style="color: #ff00ff;">:=</span> B f Res;
      <span style="color: #00ffff;">ENDFOR</span>;
   <span style="color: #00ffff;">ENDIF</span>;
   Res }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-254-2" class="outline-3">
<h3 id="sec-254-2"><span class="section-number-3">254.2</span> Equations</h3>
<div class="outline-text-3" id="text-254-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCE</span> f <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffff00;">REDUCE</span> f <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffff00;">REDUCE</span> f A B C <span style="color: #ff00ff; font-weight: bold;">=</span> A f (B f C)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-255" class="outline-2">
<h2 id="sec-255"><span class="section-number-2">255</span> <code>REDUCECOLS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-255">

<p>
The transformer <i>=REDUCECOLS=</i> does the reduction of the columns of A with the operation f.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCECOLS</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (5 6 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 30)
</pre>
</div>
<pre class="example">
65 70 75 80 85 90
</pre>


<p>
The example returns the sum of the columns of the generated table.
</p>
</div>

<div id="outline-container-sec-255-1" class="outline-3">
<h3 id="sec-255-1"><span class="section-number-3">255.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-255-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCECOLS</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   [<span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 2 <span style="color: #ffffff; font-weight: bold;">max</span> 0,<span style="color: #ffffff; font-weight: bold;">axes</span> <span style="color: #ffffff; font-weight: bold;">first</span> A] <span style="color: #ffff00;">PARTITION</span> <span style="color: #ffff00;">REDUCE</span> f A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-256" class="outline-2">
<h2 id="sec-256"><span class="section-number-2">256</span> <code>REDUCEROWS</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-256">

<p>
The transformer <i>=REDUCEROWS=</i> does the reduction of the rows of A with the operation f.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCEROWS</span> <span style="color: #ffffff; font-weight: bold;">product</span> (3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 12)
</pre>
</div>
<pre class="example">
24 1680 11880
</pre>


<p>
The example returns the product of the rows of the generated table.
</p>
</div>

<div id="outline-container-sec-256-1" class="outline-3">
<h3 id="sec-256-1"><span class="section-number-3">256.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-256-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">REDUCEROWS</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #ffff00;">BYROWS</span> (<span style="color: #ffff00;">REDUCE</span> f) A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-257" class="outline-2">
<h2 id="sec-257"><span class="section-number-2">257</span> reductive</h2>
<div class="outline-text-2" id="text-257">

<p>
A reductive operation is one that extends a functional capability normally defined on a pair to a list, reducing the result by pairwise application of the function.
</p>

<p>
The predefined reductive operations include:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operation</th>
<th scope="col" class="left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">and</td>
<td class="left">logical "and" of a boolean array</td>
</tr>

<tr>
<td class="left">link</td>
<td class="left">the list of all the items of the items in the array</td>
</tr>

<tr>
<td class="left">max</td>
<td class="left">highest item in the array</td>
</tr>

<tr>
<td class="left">min</td>
<td class="left">lowest item in the array</td>
</tr>

<tr>
<td class="left">or</td>
<td class="left">logical "or" of a boolean array</td>
</tr>

<tr>
<td class="left">product</td>
<td class="left">arithmetic product of an array of numbers</td>
</tr>

<tr>
<td class="left">sum</td>
<td class="left">arithmetic sum of an array of numbers</td>
</tr>
</tbody>
</table>

<p>
All of the above operations except link are also multi pervasive.  The transformer REDUCE can be used to produce a reductive operation from a binary one.
</p>
</div>
</div>

<div id="outline-container-sec-258" class="outline-2">
<h2 id="sec-258"><span class="section-number-2">258</span> <code>refresh</code></h2>
<div class="outline-text-2" id="text-258">

<p>
Q'Nial keeps a copy of the values and attributes of the characters displayed on the screen in its memory.  The expression Refresh restores the screen to the display corresponding to the screen memory values and attributes.  It is used after a host operation has overwritten the screen display to restore the screen to its previous display.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">host</span> <span style="color: #00ff00;">'dir'</span> ;
<span style="color: #ffffff; font-weight: bold;">Readchar</span> ;
Refresh ;
</pre>
</div>

<p>
When Q'Nial is in window mode, the screen management output routines update an internal image of the screen as characters are written to the screen but the screen itself is updated only occasionally.  Sometimes it is necessary to insert a Refresh expression to have the screen updated at the time desired.
</p>
</div>
</div>

<div id="outline-container-sec-259" class="outline-2">
<h2 id="sec-259"><span class="section-number-2">259</span> <code>regexp</code></h2>
<div class="outline-text-2" id="text-259">

<p>
The operation regexp is used to find the first substring in a string S that matches a regular expression pattern given by R. The pattern can contain subgroups indicated by parentheses. If there are no subgroups in R then the result is a pair consisting of a boolean indicating if the search succeeded and the first substring in S matched by R. Otherwise it is a longer list with the additional items being the substrings that match the subgroups in R.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'def'</span> regexp <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
+-+---+
|l|def|
+-+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'deg'</span> regexp <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
+-++
|o||
+-++
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #00ff00;">'^(.)[bg](..)[eh]'</span> regexp <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
+-+-----+-+--+
|l|abcde|a|cd|
+-+-----+-+--+
</pre>

<p>
In the first example, the string 'def' matches a substring of the right argument. In the second example the string 'deg' does not match. In the third example, the regular expression pattern searches for a string anchored at the beginning (by using ^) and consisting of any character followed by a "b" or a "g", followed by any two characters followed by a "c" or a "d". The result finds a match and picks out the two substrings corresponding to the two subgroups.
</p>
</div>
</div>

<div id="outline-container-sec-260" class="outline-2">
<h2 id="sec-260"><span class="section-number-2">260</span> <code>regexp_match</code></h2>
<div class="outline-text-2" id="text-260">

<p>
The operation regexp<sub>match</sub> is used to test whether there is a substring in a string S that matches a regular expression pattern given by R. It returns true if a match is found and false otherwise. If the optional argument O is "i then the search is case insensitive.
</p>


<div class="org-src-container">

<pre class="src src-nial">regexp_match <span style="color: #00ff00;">'def'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_match <span style="color: #00ff00;">'deg'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_match <span style="color: #00ff00;">'^.[bg]..[eh]'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_match <span style="color: #00ff00;">'^(.)[bg](..)[eh]'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_match <span style="color: #00ff00;">'DEF'</span> <span style="color: #00ff00;">'abcdefghi'</span> <span style="color: #ffaf00;">"i</span>
</pre>
</div>
<pre class="example">
l
</pre>


<p>
In the first example, the string 'def' matches a substring of the right argument. In the second example the string 'deg' does not match. In the third example, the regular expression pattern searches for a string anchored at the beginning (by using ^) and consisting of any character followed by a "b" or a "g", followed by any two characters followed by a "c" or a "d". A match is found. Example four shows that subgroups are allowed in the pattern and do not affect the match. The final example shows a case insensitive search.
</p>
</div>
</div>

<div id="outline-container-sec-261" class="outline-2">
<h2 id="sec-261"><span class="section-number-2">261</span> <code>regexp_substitute</code></h2>
<div class="outline-text-2" id="text-261">

<p>
The operation regexp<sub>substitute</sub> is used to replace one or more substrings in string T that match the regular expression pattern R with string S. If the optional argument is "i then the search is case insensitive. If it is "g then all substitutions are done.
</p>

<div class="org-src-container">

<pre class="src src-nial">regexp_substitute <span style="color: #00ff00;">'def'</span> <span style="color: #00ff00;">'XX'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
abcXXghi
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_substitute <span style="color: #00ff00;">'xyz'</span> <span style="color: #00ff00;">'456'</span> <span style="color: #00ff00;">'abcdefghi'</span>
</pre>
</div>
<pre class="example">
abcdefghi
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_substitute <span style="color: #00ff00;">'DEF'</span> <span style="color: #00ff00;">'YY'</span> <span style="color: #00ff00;">'abcdefghi'</span> <span style="color: #ffaf00;">"i</span>
</pre>
</div>
<pre class="example">
abcYYghi
</pre>


<div class="org-src-container">

<pre class="src src-nial">regexp_substitute <span style="color: #00ff00;">'a'</span> <span style="color: #00ff00;">'3'</span> <span style="color: #00ff00;">'all able apes pay attention'</span> <span style="color: #ffaf00;">"g</span>
</pre>
</div>
<pre class="example">
3ll 3ble 3pes p3y 3ttention
</pre>

<div class="org-src-container">

<pre class="src src-nial">regexp_substitute <span style="color: #00ff00;">'A'</span> <span style="color: #00ff00;">'3'</span> <span style="color: #00ff00;">'all able apes pay attention'</span> <span style="color: #ffaf00;">"ig</span>
</pre>
</div>
<pre class="example">
3ll 3ble 3pes p3y 3ttention
</pre>


<p>
In the first example, the string 'def' is replaced by 'XX'. In the second example the string 'deg' does not match and T is returned. In the third example, the regular expression pattern matches with a case insensitive search and the substitution is done. Examples four and five show multiple substitutions first with a case sensitive pattern and then with a case insensitive one.
</p>
</div>
</div>

<div id="outline-container-sec-262" class="outline-2">
<h2 id="sec-262"><span class="section-number-2">262</span> <code>registerdllfun</code></h2>
<div class="outline-text-2" id="text-262">

<p>
A Prototype DLL calling interface has been added to the Windows versions of Q'Nial (Console, GUI and DLL version).  This ability allows NIAL code to call external routines in DLL libraries.  These libraries can be user written, part of the Operating System, or 3rd party DLLs.
</p>

<p>
The DLL interface routines manage an internal table that keeps track of the currently installed DLLs and their argument types and result type.  This table also tracks if the actual library has been loaded (by a call to calldllfun).  The table is preserved as part of the workspace, and once DLL functions have been registered in a workspace,  they are still available if the workspace is saved and subsequently loaded.  The CallDLL facility assures that the DLL files are loaded and unloaded appropriately.
</p>

<p>
Every time a workspace is saved all DLL libraries are unloaded and the internal table is adjusted to reflect that.  When a workspace is loaded, none of the DLL libraries will be loaded until a specific call to calldllfun brings in the DLL.  This process assures that resources are not wasted on registered DLL calls that are never used.
</p>

<p>
The registerdllfun routine must always be called first to enter DLL function into the internal mapping table.  This table keeps track of the name and DLL file for the routine and all of the argument types and function results.  The DLL file is not loaded until the routine is called with the calldllfun routine.  So errors involving paths to the DLL file or other related problems are not reported until the first call to calldllfun.
</p>

<p>
The operation registerdllfun initiates an interface to an external routine implemented as a DLL for 32-bit Windows. The name Nm is the name associated with the routine, Dllnm is the actual name of the DLL routine, Path is the path/filename to the DLL executable file, Restype is the result type and Argtypes is the list of argument types.
</p>

<p>
Nm is a phrase or string that is used to identify the requested DLL routine when using the calldllfun operation.  It can be any name you desire.  Duplicates are not allowed and the registration routine will overwrite previous table entries if the same name is used again.
</p>

<p>
Dllnm must be the exact name of the routine in the DLL library (case sensitive, including underscores, etc.).
</p>

<p>
Path must the full path to the DLL library file.  If the DLL library file is in the standard search path for DLLs then the full path is not required.
</p>

<div class="org-src-container">

<pre class="src src-nial">stype must be a <span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #ffffff; font-weight: bold;">or</span> <span style="color: #ffffff; font-weight: bold;">phrase</span> of one the valid types described below
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial">gtypes must be a <span style="color: #ffffff; font-weight: bold;">list</span> of the valid types described below
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial">the only argument <span style="color: #00ffff;">is</span> Nm <span style="color: #ffffff; font-weight: bold;">and</span> this names an already installed DLL routine, <span style="color: #00ffff;">then</span> the routine <span style="color: #00ffff;">is</span> unregistered <span style="color: #ffffff; font-weight: bold;">and</span> the DLL <span style="color: #00ffff;">is</span> unloaded
</pre>
</div>
<pre class="example">
</pre>
</div>

<div id="outline-container-sec-262-1" class="outline-3">
<h3 id="sec-262-1"><span class="section-number-3">262.1</span> Calling Conventions (C or Pascal)</h3>
<div class="outline-text-3" id="text-262-1">
<p>
The facility is able to map in DLL routines compiled for both C and Pascal calling conventions.  The facility makes this determination by checking for a leading underscore on the internal name of the DLL routine.  If one exists, then it is assumed that the C calling style should be used, otherwise the PASCAL calling style is used.  It is possible to create DLL routines that do not follow this standard convention, so be careful.
</p>

<p>
When using either style calling conventions, the facility has a limit of up to 10 words of arguments (10 - 4 byte integers).  Pascal calling convention is  strict in that the number of supplied arguments must be the same as the number of required arguments.  The limit of 10, is a compiler option and can be extended if necessary.
</p>
</div>
</div>

<div id="outline-container-sec-262-2" class="outline-3">
<h3 id="sec-262-2"><span class="section-number-3">262.2</span> Arguments to DLL routines</h3>
<div class="outline-text-3" id="text-262-2">
<p>
Currently, Q'Nial is able to pass only simple types to DLL routines.  The following is a list of the types that can be passed and returned as results:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Type in DLL routine</th>
<th scope="col" class="left">Nial Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">CHAR</td>
<td class="left">character</td>
</tr>

<tr>
<td class="left">SHORT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LONG</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">WCHAR</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LPSTR</td>
<td class="left">string</td>
</tr>

<tr>
<td class="left">LPTSTR</td>
<td class="left">string</td>
</tr>

<tr>
<td class="left">HANDLE</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">DWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LPDWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">WORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">BOOL</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">HWND</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">UINT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">DOUBLE</td>
<td class="left">real</td>
</tr>

<tr>
<td class="left">FLOAT</td>
<td class="left">real</td>
</tr>

<tr>
<td class="left">LRESULT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LPARAM</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LRESULT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">HMENU</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">LPCTSTR</td>
<td class="left">string</td>
</tr>

<tr>
<td class="left">SCHAR</td>
<td class="left">char</td>
</tr>

<tr>
<td class="left">SDWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">SWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">UDWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">UWORD</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">SLONG</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">SSHORT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">ULONG</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">USHORT</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="left">INT</td>
<td class="left">integer</td>
</tr>
</tbody>
</table>

<p>
These type are the simple base types used in the Windows (Win32) API (plus common types which are bolded).  The above type names (in string or phrase form) can be used as the type names required as arguments to the registerdllfun operation.  Each particular type affects Nial values in a different way.  Use of types other than common types generally requires a knowledge of C/C++ types and casting.  The Windows types are supplied to easily map in Windows API DLL calls.
</p>

<p>
When calling DLL routines using calldllfun, the facility will properly cast the incoming Nial type/value to the type of the particular argument specified by the registerdllfun operation.  If the Nial type cannot be converted, then calldllfun will report an error and exit.
</p>
</div>
</div>

<div id="outline-container-sec-262-3" class="outline-3">
<h3 id="sec-262-3"><span class="section-number-3">262.3</span> Variable Parameters</h3>
<div class="outline-text-3" id="text-262-3">
<p>
Variable parameters are supported.  Arguments that are marked as variable parameters, have the returning value of the parameter added to the result list with the first element being the  normal result of the called DLL routine.  The Nial user must then select the portions of the result that are desired.
</p>

<p>
This feature also provides the ability to pass buffers to DLL routines.  Many Windows OS DLL routines require a (char *) type pointer to a pre-allocated buffer and a buffer size.   The routine places the result in the buffer up to the specified size.  The interface to such a routine can be accomplished by sending a Nial string of the desired buffer size and the accompanying size integer as the arguments, having specified the first argument as a variable parameter.  The resulting string is added to the result list  with the first element being the normal result of the DLL routine call.
</p>

<p>
When passing variable parameters, the facility makes an internal copy of the data being passed.  The called DLL routine uses this copy.  This approach helps prevent the possibility of a DLL routine incorrectly manipulating the actual contents of a Nial array and causing a corruption of the workspace.
</p>

<p>
To specify that an argument is a variable parameter in the registerdllfun call prepend a * (asterisk) to the beginning of the type name (i.e. *CHAR).  This indicates that the type is to be passed as a pointer (if it is not already a pointer), and that the result for that parameter is to be appended to the result of the entire call.  Any, none or all of the parameters may be variable.
</p>

<p>
Functions Requiring Pointers to Data
</p>

<p>
Another common requirement of Windows OS DLL calls (and others too), is that they require the address of a variable to be passed as an argument instead of the actual value.  The DLL function uses the value at the supplied memory address.
</p>

<p>
This capability is supported, and can be denoted by prepending a &amp; (ampersand) to the beginning of the type name (i.e. &amp;INT). At the Nial level, you still pass the calldllfun call a plain integer for that particular argument, but the CallDLL interface allocates memory for that argument, copies the value into the new memory, and passes the address of the memory cell to the DLL call.  Upon return, the allocated memory is deallocated.
</p>

<p>
The &amp; modifier can be used in conjunction with the * modifier.  This usage generally denotes an argument that is a pointer to a type and whose value you wish returned along with the result.
</p>
</div>
</div>

<div id="outline-container-sec-262-4" class="outline-3">
<h3 id="sec-262-4"><span class="section-number-3">262.4</span> Example 1</h3>
<div class="outline-text-3" id="text-262-4">
<p>
Let say we have a DLL routine that takes 3 argument.  The first argument is the true argument and the next two are pointers to memory locations where two additional results are to be placed.  The function also returns an integer result.
</p>

<p>
The routine squares the first argument and places the result at the memory location specified by the second argument.  It also cubes the first argument and place the result in the location specified by the third argument.  The function result is what is supplied as the first argument.
</p>

<div class="org-src-container">

<pre class="src src-nial">registerdllfun <span style="color: #ffaf00;">"sq</span> <span style="color: #ffaf00;">"_squarecube</span> <span style="color: #00ff00;">'c:\myops.dll'</span> <span style="color: #ffaf00;">"INT</span> [<span style="color: #ffaf00;">"INT</span>,<span style="color: #ffaf00;">"&amp;*INT</span>,<span style="color: #ffaf00;">"&amp;*INT</span>]
</pre>
</div>
<pre class="example">
</pre>


<div class="org-src-container">

<pre class="src src-nial">calldllfun <span style="color: #ffaf00;">"sq</span> 5 -10 -10
</pre>
</div>
<pre class="example">
+---+----+-----+
| 5 | 25 | 125 |
+---+----+-----+
</pre>

<p>
So the call passes in 5 as the true argument and two -10 values as dummy values for the next two arguments (it is possible that the function might require all arguments to specify proper values).  The result is an array of 3 items, one is the function result and an additional item for every variable parameter in the argument list.
</p>
</div>
</div>

<div id="outline-container-sec-262-5" class="outline-3">
<h3 id="sec-262-5"><span class="section-number-3">262.5</span> Example 2</h3>
<div class="outline-text-3" id="text-262-5">
<p>
The following is a call to a Windows API routines that requires a string buffer to be passed to the call:
</p>

<div class="org-src-container">

<pre class="src src-nial">registerdllfun <span style="color: #ffaf00;">"_GetComputerName</span> <span style="color: #ffaf00;">"GetComputerNameA</span>  <span style="color: #00ff00;">'kernel32.dll'</span> <span style="color: #ffaf00;">"BOOL</span> [<span style="color: #00ff00;">'*LPTSTR'</span>, <span style="color: #00ff00;">'LPDWORD'</span>];
</pre>
</div>

<div class="org-src-container">

<pre class="src src-nial">GetComputerName <span style="color: #00ffff;">IS</span> {
   res name <span style="color: #ff00ff;">:=</span> calldllfun <span style="color: #ffaf00;">"_GetComputerName</span> (1000 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">' '</span>) 1000;
   <span style="color: #00ffff;">IF</span> res <span style="color: #ff00ff; font-weight: bold;">=</span> 1 <span style="color: #00ffff;">THEN</span>
     name
   <span style="color: #00ffff;">ELSE</span>
     <span style="color: #00ff00;">'Error Getting Computer Name'</span>
   <span style="color: #00ffff;">ENDIF</span> }

  GetComputerName
</pre>
</div>
<pre class="example">
INIGO
</pre>

<p>
Notice how the above code calls the DLL routine with an empty string buffer (1000 reshape ' ') and also passes the size of the buffer (1000).  The Windows API requires this in order to safely write the Computer name in the buffer without overflowing the string buffer.  The buffer argument is marked as a variable argument, so the result is passed back in the calldllfun call.
</p>
</div>
</div>

<div id="outline-container-sec-262-6" class="outline-3">
<h3 id="sec-262-6"><span class="section-number-3">262.6</span> A Word of Warning</h3>
<div class="outline-text-3" id="text-262-6">
<p>
Use of DLL routines can cause unexpected results if incorrect parameters as passed.  It is reasonable easy to crash the Nial application with a bad DLL call.  Additionally, memory allocated inside a DLL function is not deallocated by Nial.  Unless there is a symmetric DLL routine to deallocate memory, a memory leak will result if such a routine is used.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-263" class="outline-2">
<h2 id="sec-263"><span class="section-number-2">263</span> regular expression notation</h2>
<div class="outline-text-2" id="text-263">

<p>
The following table gives the standard notations used in regular expressions:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Notation</th>
<th scope="col" class="left">Matching String</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">.</td>
<td class="left">any character</td>
</tr>

<tr>
<td class="left"><code>\ast</code></td>
<td class="left">the previous character zero or more times</td>
</tr>

<tr>
<td class="left"><code>+</code></td>
<td class="left">the previous character 1 or more times</td>
</tr>

<tr>
<td class="left"><code>^</code></td>
<td class="left">when at the beginning of a regular expression, matches the beginning of the string.</td>
</tr>

<tr>
<td class="left"><code>$</code></td>
<td class="left">when at the end of a regular expression, matches the end of the string.</td>
</tr>

<tr>
<td class="left"><code>[xyz]</code></td>
<td class="left">any character in the sequence of characters "xyz" where "xyz" can be almost any sequence of characters.</td>
</tr>

<tr>
<td class="left"><code>[^xyz]</code></td>
<td class="left">any character NOT in the sequence of characters "xyz".</td>
</tr>

<tr>
<td class="left"><code>[x-y]</code></td>
<td class="left">any character in the range of x to y.</td>
</tr>

<tr>
<td class="left">&vert;</td>
<td class="left">allows the optional match of the regular expression on the left or the right of the "&vert;"</td>
</tr>

<tr>
<td class="left"><code>()</code></td>
<td class="left">bracketing allows the specification of groups.</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">Anything that is matched between a set of brackets can later be extracted. Also used for bracketing</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">regular expressions to force order of precedence.</td>
</tr>

<tr>
<td class="left">&lt;other char&gt;</td>
<td class="left">itself</td>
</tr>

<tr>
<td class="left">&lt;\char&gt;</td>
<td class="left">the character</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-264" class="outline-2">
<h2 id="sec-264"><span class="section-number-2">264</span> repeat-loop</h2>
<div class="outline-text-2" id="text-264">

<p>
The REPEAT-loop notation is used when executing an expression sequence repeatedly until a conditional expression returns true.
</p>

<pre class="example">
F := open Filenm "r;
Lines := '';
Done := o;
REPEAT
  Line := readfile F;
  IF isfault Line THEN
    Done := l;
  ELSE
    Lines := Lines append Line;
  ENDIF;
UNTIL Done ENDREPEAT;
</pre>
</div>
</div>

<div id="outline-container-sec-265" class="outline-2">
<h2 id="sec-265"><span class="section-number-2">265</span> <i>reserved words</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-265">

<p>
A reserved word or keyword is one that has a special usage in a Nial construct and must be used only for that purpose.  A block delimits a local environment.  It allows new uses of names which do not interfere with uses of those names outside the block.  For example, within a block, a predefined operation name can be redefined and used for a different purpose.  Only the reserved words of Q'Nial cannot be reused in this fashion.
</p>

<p>
An identifier, which is spelled the same, ignoring case, as any of the reserved words given below cannot be used to name a variable or a definition.  In a local environment, an identifier can be chosen that is the same as a predefined or user-defined global definition name.  Such a choice makes the global use of the name unavailable in the local context.
A reserved word is displayed in upper case in canonical form.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Reserved Word</th>
<th scope="col" class="left">Construct</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">BEGIN</td>
<td class="left">Synonym for { in block</td>
</tr>

<tr>
<td class="left">CASE</td>
<td class="left">case-expression</td>
</tr>

<tr>
<td class="left">DO</td>
<td class="left">for-expression, while-expression</td>
</tr>

<tr>
<td class="left">ELSE</td>
<td class="left">if-expression, case-expression</td>
</tr>

<tr>
<td class="left">ELSEIF</td>
<td class="left">if-expression</td>
</tr>

<tr>
<td class="left">END</td>
<td class="left">case-expression, synonym for } in block</td>
</tr>

<tr>
<td class="left">ENDCASE</td>
<td class="left">case-expression</td>
</tr>

<tr>
<td class="left">ENDFOR</td>
<td class="left">for-expression</td>
</tr>

<tr>
<td class="left">ENDIF</td>
<td class="left">if-expression</td>
</tr>

<tr>
<td class="left">ENDREPEAT</td>
<td class="left">repeat-expression</td>
</tr>

<tr>
<td class="left">ENDWHILE</td>
<td class="left">while-expression</td>
</tr>

<tr>
<td class="left">EXIT</td>
<td class="left">exit-expression</td>
</tr>

<tr>
<td class="left">EXPRESSION</td>
<td class="left">declaration</td>
</tr>

<tr>
<td class="left">EXTERNAL</td>
<td class="left">declaration</td>
</tr>

<tr>
<td class="left">FOR</td>
<td class="left">for-expression</td>
</tr>

<tr>
<td class="left">FROM</td>
<td class="left">case-expression</td>
</tr>

<tr>
<td class="left">GETS</td>
<td class="left">assign-expression</td>
</tr>

<tr>
<td class="left">IF</td>
<td class="left">if-expression</td>
</tr>

<tr>
<td class="left">IS</td>
<td class="left">definition</td>
</tr>

<tr>
<td class="left">LOCAL</td>
<td class="left">declaration</td>
</tr>

<tr>
<td class="left">NONLOCAL</td>
<td class="left">declaration</td>
</tr>

<tr>
<td class="left">OP</td>
<td class="left">synonym for operation</td>
</tr>

<tr>
<td class="left">OPERATION</td>
<td class="left">operation-form, declaration</td>
</tr>

<tr>
<td class="left">REPEAT</td>
<td class="left">repeat-expression</td>
</tr>

<tr>
<td class="left">THEN</td>
<td class="left">if-expression</td>
</tr>

<tr>
<td class="left">TR</td>
<td class="left">synonym for transformer</td>
</tr>

<tr>
<td class="left">TRANSFORMER</td>
<td class="left">transformer-form, declaration</td>
</tr>

<tr>
<td class="left">UNTIL</td>
<td class="left">repeat-expression</td>
</tr>

<tr>
<td class="left">VARIABLE</td>
<td class="left">declaration</td>
</tr>

<tr>
<td class="left">WHILE</td>
<td class="left">while-expression</td>
</tr>

<tr>
<td class="left">WITH</td>
<td class="left">for-expression</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-266" class="outline-2">
<h2 id="sec-266"><span class="section-number-2">266</span> <code>reshap</code></h2>
<div class="outline-text-2" id="text-266">
<p>
:Class:  reshaping operation
:Property:  binary
:Usage:  A reshape B   reshape A B
:SeeAlso: post, shape, tally
:END:
</p>

<p>
The operation reshape is the major mechanism in Nial for creating multivalent arrays.  The operation requires A to be a shape, either Null or a list of integers.  If A is an integer, it is converted to the solitary holding the integer.  If A is not a shape, the result is the fault ?shape.
</p>

<p>
The result of reshape is an array of shape A with items chosen from the list of items of B.  If the number of items to be used to fill the result is less than the tally of B, the remaining items of B are ignored.  If the number is more than the tally of B, the items of B are used cyclically.  If B has no items, fault ?fill is used as the items of the result.
</p>


<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> 4 6 (4 5) 3 <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
+-+---+---+
|4|  6|4 5|
+-+---+---+
|3|abc|  4|
+-+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'abcdefghij'</span>
</pre>
</div>
<pre class="example">
abc
def
</pre>

<div class="org-src-container">

<pre class="src src-nial">5 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> 3 4
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|3 4|3 4|3 4|3 4|3 4|
+---+---+---+---+---+
</pre>

<p>
The last example illustrates that to replicate an arbitrary array, in this case the pair 3 4, reshape is applied to the solitary holding the array.
</p>
</div>

<div id="outline-container-sec-266-1" class="outline-3">
<h3 id="sec-266-1"><span class="section-number-3">266.1</span> Equations</h3>
<div class="outline-text-3" id="text-266-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (<span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A) =f= A
A a <span style="color: #ffffff; font-weight: bold;">shape</span> implies ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A
A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> B
A <span style="color: #00ffff;">is</span> a <span style="color: #ffffff; font-weight: bold;">shape</span> ==&gt; <span style="color: #ffff00;">EACH</span> f (A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffff00;">EACH</span> f B
<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
(<span style="color: #ffffff; font-weight: bold;">tally</span> A) 1 <span style="color: #ffffff; font-weight: bold;">reshape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">post</span> A
<span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
<span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> [ 1 ] <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> [ 0 ] <span style="color: #ffffff; font-weight: bold;">reshape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-267" class="outline-2">
<h2 id="sec-267"><span class="section-number-2">267</span> <code>rest</code></h2>
<div class="outline-text-2" id="text-267">

<p>
The operation rest returns the list of A after dropping the first item of the list.  If the argument of rest is not a list, it is treated as a list.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rest</span> 3 4 5 6
</pre>
</div>
<pre class="example">
4 5 6
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rest</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|0 1|0 2|1 0|1 1|1 2|
+---+---+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rest</span> 7 <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The last example shows that the rest of an atom is the empty list Null.
</p>
</div>

<div id="outline-container-sec-267-1" class="outline-3">
<h3 id="sec-267-1"><span class="section-number-3">267.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-267-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rest</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (1 <span style="color: #ffffff; font-weight: bold;">drop</span> <span style="color: #ffffff; font-weight: bold;">list</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-267-2" class="outline-3">
<h3 id="sec-267-2"><span class="section-number-3">267.2</span> Equations</h3>
<div class="outline-text-3" id="text-267-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rest</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">rest</span> <span style="color: #ffffff; font-weight: bold;">list</span> A

<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">first</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 0 <span style="color: #ffffff; font-weight: bold;">max</span> (<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 1)
<span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">second</span> A
<span style="color: #ffffff; font-weight: bold;">rest</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-268" class="outline-2">
<h2 id="sec-268"><span class="section-number-2">268</span> <code>restart</code></h2>
<div class="outline-text-2" id="text-268">

<p>
The expression Restart is used to restart a Q'Nial session.  It causes the workspace to be cleared and Q'Nial to be reinitialized to be in the same state it was when the session began.  If the original invocation used a named workspace or a definition file, it is reloaded as before.
</p>

<p>
The advantage of Restart over Clearws is that the user can start the application again using Restart and possibly trigger a Latent expression in the starting workspace.
</p>
</div>
</div>

<div id="outline-container-sec-269" class="outline-2">
<h2 id="sec-269"><span class="section-number-2">269</span> <code>resume</code></h2>
<div class="outline-text-2" id="text-269">

<p>
When break debug mode is initiated by means of the Break expression or the operation breakin (or by using &lt;Ctrl b&gt; while awaiting input in window mode on a console version), a break loop is initiated with output like:
</p>
<hr  />
<p>
Break debug loop: enter debug commands, expressions or
</p>
<pre class="example">
type: resume    to exit debug loop
&lt;Return&gt; executes the indicated debug command
</pre>
<p>
    current call stack :
foo
</p>
<hr  />
<p>
?.. C := A + ( + A + A )
&#x2013;&gt;[stepv]
</p>

<p>
In the above example the break loop awaits input with the default command stepv assumed.  If resume is typed then the break loop is exited and control returns to the expression following the break point.
</p>
<pre class="example">
Break
</pre>
<hr  />
<p>
Break debug loop: enter debug commands, expressions or
</p>
<pre class="example">
type: resume    to exit debug loop
&lt;Return&gt; executes the indicated debug command
</pre>
<p>
current call stack :
</p>
<hr  />
<p>
?.. C := A + ( + A + A )
&#x2013;&gt;[stepv] resume
</p>
</div>
</div>

<div id="outline-container-sec-270" class="outline-2">
<h2 id="sec-270"><span class="section-number-2">270</span> <code>reverse</code></h2>
<div class="outline-text-2" id="text-270">

<p>
The operation reverse returns an array of the same shape as A having the items in reverse order.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reverse</span> 4 5 6 7
</pre>
</div>
<pre class="example">
7 6 5 4
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #00ff00;">'able was I ere I saw Melba'</span>
</pre>
</div>
<pre class="example">
ableM was I ere I saw elba
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #00ff00;">'This'</span> <span style="color: #00ff00;">'seems'</span> <span style="color: #00ff00;">'too'</span> <span style="color: #00ff00;">'wonderful'</span>
</pre>
</div>
<pre class="example">
+----+-----+---+---------+
|sihT|smees|oot|lufrednow|
+----+-----+---+---------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">count</span> 3 4
</pre>
</div>
<pre class="example">
+---+---+---+---+
|3 4|3 3|3 2|3 1|
+---+---+---+---+
|2 4|2 3|2 2|2 1|
+---+---+---+---+
|1 4|1 3|1 2|1 1|
+---+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reverse</span> (10 <span style="color: #ffffff; font-weight: bold;">take</span>) <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">sketch</span> 1.23
</pre>
</div>
<pre class="example">
1.23
</pre>

<p>
The fourth example illustrates that the reverse of a 3 by 4 table is a 3 by 4 table with the list of items reversed.  The last example shows the use of take and reverse to right-justify text in a field.
</p>
</div>

<div id="outline-container-sec-270-1" class="outline-3">
<h3 id="sec-270-1"><span class="section-number-3">270.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-270-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> <span style="color: #ffffff; font-weight: bold;">count</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> A) }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-270-2" class="outline-3">
<h3 id="sec-270-2"><span class="section-number-3">270.2</span> Equations</h3>
<div class="outline-text-3" id="text-270-2">
<p>
#+begi<sub>src</sub> nial
   shape reverse A = shape A
</p>

<p>
   reverse reverse A = A
   reverse A=shape A reshape reverse list A
   front A = reverse rest reverse A
   last A = first reverse A
#+end<sub>src</sub>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-271" class="outline-2">
<h2 id="sec-271"><span class="section-number-2">271</span> role</h2>
<div class="outline-text-2" id="text-271">

<p>
The term role is used to describe the class of object associated with an identifier in Nial. The possible roles are: reserved word, variable, expression, operation or transformer. An identifier that corresponds to a reserved word can play no other role in a workspace. An identifier that corresponds to a predefined object in Nial cannot be changed in the global environment, but can take on a different object association in a local environment. In the global environment, once the role of an identifier is established, it must keep the same role, but may have its association changed to another object of the same role.
</p>

<p>
An external-declaration assigns a role to a name in the global environment so that the name can be used in other definitions before it is completely specified.  This mechanism is useful for creating mutually recursive definitions.  An external declaration is made only in the global environment. If the name is already defined with the same role, the declaration has no effect.  If the name has another role, a fault is reported.
</p>

<p>
If the expression on the right of IS in a definition uses the name being defined, the definition is assumed to be recursive.  The name is assigned a role compatible with its use on the right if it does not already have a role.
</p>

<p>
If a definition appears within a block, the association between the name of the identifier and its meaning is made in the local environment.  Otherwise, the association is made in the global environment and the definition assigns a role to the name as representing that kind of expression.
</p>

<p>
If the name being associated in a definition is already in use, the new definition must be for a construct of the same role and the earlier definition is replaced.  The use of a defined name always refers to its most recent definition.
</p>
</div>
</div>

<div id="outline-container-sec-272" class="outline-2">
<h2 id="sec-272"><span class="section-number-2">272</span> <code>rotate</code></h2>
<div class="outline-text-2" id="text-272">

<p>
The operation rotate shifts the items of array B to the left A places, inserting the items that drop off the front of the list on the back.  If A is a negative number, the shift is to the right.
</p>


<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">rotate</span> 24 35 46 57 12 24 39
</pre>
</div>
<pre class="example">
46 57 12 24 39 24 35
</pre>



<div class="org-src-container">

<pre class="src src-nial">-5 <span style="color: #ffffff; font-weight: bold;">rotate</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 5
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|2 0|2 1|2 2|2 3|2 4|
+---+---+---+---+---+
|0 0|0 1|0 2|0 3|0 4|
+---+---+---+---+---+
|1 0|1 1|1 2|1 3|1 4|
+---+---+---+---+---+
</pre>

<p>
The second example shows that on a table rotate works on the list of items in row major order.
</p>
</div>

<div id="outline-container-sec-272-1" class="outline-3">
<h3 id="sec-272-1"><span class="section-number-3">272.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-272-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rotate</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> N A {
   Newlist <span style="color: #ff00ff;">:=</span>  <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">+</span> N <span style="color: #ff00ff; font-weight: bold;">+</span> <span style="color: #ffffff; font-weight: bold;">grid</span> A <span style="color: #ffffff; font-weight: bold;">mod</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #ffffff; font-weight: bold;">list</span> A;
   <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> Newlist }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-272-2" class="outline-3">
<h3 id="sec-272-2"><span class="section-number-3">272.2</span> Equations</h3>
<div class="outline-text-3" id="text-272-2">
<div class="org-src-container">

<pre class="src src-nial">N an integer ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> (N <span style="color: #ffffff; font-weight: bold;">rotate</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
N <span style="color: #ffffff; font-weight: bold;">rotate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> (N <span style="color: #ffffff; font-weight: bold;">rotate</span> <span style="color: #ffffff; font-weight: bold;">list</span> A)
N <span style="color: #ffffff; font-weight: bold;">rotate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> N <span style="color: #ffffff; font-weight: bold;">mod</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">rotate</span> A
N <span style="color: #ffffff; font-weight: bold;">rotate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span>(<span style="color: #ffffff; font-weight: bold;">tally</span> A-N) <span style="color: #ffffff; font-weight: bold;">rotate</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-273" class="outline-2">
<h2 id="sec-273"><span class="section-number-2">273</span> <code>rows</code></h2>
<div class="outline-text-2" id="text-273">

<p>
The operation rows is normally used on a table A.  In this case, it returns a list of lists, with each item being a list of items from one row of the table.  For a multidimensional array, the result is an array of lists of length equal to the length of the last axis of A.  The valence of the result is one less than the valence of A.
</p>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffaf00;">"Bill</span> <span style="color: #ffaf00;">"Tom</span> <span style="color: #ffaf00;">"Mary</span> <span style="color: #ffaf00;">"Jack</span> <span style="color: #ffaf00;">"Dawn</span> <span style="color: #ffaf00;">"Alice</span>
</pre>
</div>
<pre class="example">
Bill Tom  Mary
Jack Dawn Alice
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rows</span> A
</pre>
</div>
<pre class="example">
+-------------+---------------+
|Bill Tom Mary|Jack Dawn Alice|
+-------------+---------------+
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span>  2 2 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 32
</pre>
</div>
<pre class="example">
1 2 3       7  8  9
4 5 6      10 11 12
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rows</span> A
</pre>
</div>
<pre class="example">
+-----+--------+  +--------+--------+
|1 2 3|4 5 6   |  |13 14 15|16 17 18|
+-----+--------+  +--------+--------+
|7 8 9|10 11 12|  |19 20 21|22 23 24|
+-----+--------+ +--------+--------+
</pre>
</div>

<div id="outline-container-sec-273-1" class="outline-3">
<h3 id="sec-273-1"><span class="section-number-3">273.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-273-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">rows</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A ( <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 1 <span style="color: #ffffff; font-weight: bold;">max</span> 0 <span style="color: #ffffff; font-weight: bold;">raise</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-273-2" class="outline-3">
<h3 id="sec-273-2"><span class="section-number-3">273.2</span> Equations</h3>
<div class="outline-text-3" id="text-273-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">front</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">last</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A ==&gt; <span style="color: #ffffff; font-weight: bold;">mix</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
T a <span style="color: #ffffff; font-weight: bold;">variable</span> associated <span style="color: #00ffff;">with</span> a table ==&gt; I <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">rows</span> T <span style="color: #ff00ff; font-weight: bold;">=</span> T|[I,]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-274" class="outline-2">
<h2 id="sec-274"><span class="section-number-2">274</span> <code>save</code></h2>
<div class="outline-text-2" id="text-274">

<p>
The operation save is used to save a workspace with the name given by the phrase or string Wsname.  The convention in Q'Nial is to name workspaces with the extension .nws so that they are easy to find in the directory.  When saving or loading a workspace, the extension may be omitted.
</p>

<p>
The effect of saving a workspace is to place the contents of the current workspace in the named file in an internal format.  The contents of the current workspace are unchanged by doing a save.
</p>
<pre class="example">
save "mywork
</pre>

<p>
A save operation may be executed within an operation or expression.  The effect is to interrupt the execution and do the save at the top level.  If the saved workspace contains a user-defined expression with the name Checkpoint, at the termination of the save, Checkpoint is executed.  Checkpoint can be used to restart the computation.
</p>

<p>
If the saved workspace contains an expression with the name Latent, whenever the workspace is loaded, the load operation will execute the Latent expression.  This can be used to have a workspace automatically begin an application, or to set up desired default values for various switch settings.
</p>
</div>
</div>

<div id="outline-container-sec-275" class="outline-2">
<h2 id="sec-275"><span class="section-number-2">275</span> <code>scan</code></h2>
<div class="outline-text-2" id="text-275">

<p>
The operation scan translates Nial program text to internal form.  This process is called tokenizing as it results in a list containing tokens.  The argument S is a string.  The result is a list beginning with 99 and followed by an alternating sequence of integer codes and phrases.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'A := 3 * 5.2'</span>
</pre>
</div>
<pre class="example">
99 2 A 1 := 16 3 2 * 18 5.2
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'sum 2 (35 + 42.7)'</span>
</pre>
</div>
<pre class="example">
99 2 SUM 16 2 1 ( 16 35 2 + 18 42.7 1 )
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #00ff00;">'foo IS first rest'</span>
</pre>
</div>
<pre class="example">
99 2 FOO 1 IS 2 FIRST 2 REST
</pre>


<p>
The first example has 5 tokens, the second has 7 and the third has 4.  In a token stream, the token for an identifier is in upper case.
</p>

<p>
The scan token codes are given below:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Code</th>
<th scope="col" class="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">1</td>
<td class="left">reserved word or delimiter</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">identifier</td>
</tr>

<tr>
<td class="right">14</td>
<td class="left">string</td>
</tr>

<tr>
<td class="right">15</td>
<td class="left">phrase</td>
</tr>

<tr>
<td class="right">16</td>
<td class="left">integer</td>
</tr>

<tr>
<td class="right">18</td>
<td class="left">real number</td>
</tr>

<tr>
<td class="right">22</td>
<td class="left">fault</td>
</tr>

<tr>
<td class="right">42</td>
<td class="left">atomic character</td>
</tr>

<tr>
<td class="right">40</td>
<td class="left">atomic boolean or bitstring</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-275-1" class="outline-3">
<h3 id="sec-275-1"><span class="section-number-3">275.1</span> Equations</h3>
<div class="outline-text-3" id="text-275-1">
<div class="org-src-container">

<pre class="src src-nial">S a <span style="color: #ffffff; font-weight: bold;">string</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">execute</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">eval</span> <span style="color: #ffffff; font-weight: bold;">parse</span> <span style="color: #ffffff; font-weight: bold;">scan</span> S
S a <span style="color: #ffffff; font-weight: bold;">string</span> ==&gt; <span style="color: #ffffff; font-weight: bold;">scan</span> <span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">scan</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">scan</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-276" class="outline-2">
<h2 id="sec-276"><span class="section-number-2">276</span> scope of a variable</h2>
<div class="outline-text-2" id="text-276">

<p>
The use of an assign-expression indicates that a name (identifier) is to be treated as a variable in the context surrounding the assign-expression.  This context is called the scope of the variable.  The context may be global, in which case the variable may be visible at all levels; or it may be local to some region of program text.  A local scope is created for the parameters of operation forms and for variables created within a block.
</p>

<p>
Because operation forms or blocks may appear within other operation forms or blocks, it is possible to have one scope for a name nested within another.  A name is said to be visible at a point in a program text if it has a local meaning at that point or has a meaning in some surrounding scope or is a global name.  When a name is used in a local scope, it is the local association in the innermost scope that is used, instead of an association with the same name in a surrounding scope.
</p>

<p>
A block is a scope-creating mechanism that permits an expression-sequence to be created so that it has local definitions and variables which are visible only inside the block.  A block may appear as a primary-expression or as the body of an operation-form.
</p>

<p>
Definitions that appear within the block have local scope.  That is, the definitions can be referenced only in the body of the block.  Variables assigned within the block may or may not have local scope, depending on the appearance of a local and/or a nonlocal declaration.  If there is no declaration, all assigned variables have local scope.  Declaring some variables as local does not change the effect on undeclared variables that are used on the left of assignment.  They are automatically localized.
</p>

<p>
If a nonlocal declaration is used, an assigned name that is on the nonlocal list is sought in surrounding scopes.  If the name is not found, a variable is created in the global environment.
</p>
</div>
</div>

<div id="outline-container-sec-277" class="outline-2">
<h2 id="sec-277"><span class="section-number-2">277</span> <code>screensize</code></h2>
<div class="outline-text-2" id="text-277">

<p>
The expression Screensize returns the effective size of the screen in use by Q'Nial.  The result is a pair of integers giving the number of rows and columns.  For the EXTDOS version it is always 25 80.
</p>


<div class="org-src-container">

<pre class="src src-nial">Screensize
</pre>
</div>
<pre class="example">
25 80
</pre>

<p>
Screensize is useful in writing portable applications that use the alphanumerics window package.  The size of windows can be tailored to the available size.
</p>
</div>
</div>

<div id="outline-container-sec-278" class="outline-2">
<h2 id="sec-278"><span class="section-number-2">278</span> <code>second</code></h2>
<div class="outline-text-2" id="text-278">

<p>
The operation second returns the second of the items of A.  If A has only one item or it is empty, it returns the fault ?address.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">second</span> 4 5 6
</pre>
</div>
<pre class="example">
5
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">second</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
0 1
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">second</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
?address
</pre>
</div>

<div id="outline-container-sec-278-1" class="outline-3">
<h3 id="sec-278-1"><span class="section-number-3">278.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-278-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">second</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (1 <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">list</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-278-2" class="outline-3">
<h3 id="sec-278-2"><span class="section-number-3">278.2</span> Equations</h3>
<div class="outline-text-3" id="text-278-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">second</span> <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">second</span> B
<span style="color: #ffffff; font-weight: bold;">second</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-279" class="outline-2">
<h2 id="sec-279"><span class="section-number-2">279</span> <code>see</code></h2>
<div class="outline-text-2" id="text-279">

<p>
The operation <a href="#sec-279">279</a> displays the definition of the user defined object named by the phrase or string Defname.  The canonical form of the definition appears directly on the screen.  The operation cannot be used on predefined names.  The display is in sketch/nodecor mode regardless of the current settings.
</p>

<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span>;
<span style="color: #ffffff; font-weight: bold;">see</span> <span style="color: #ffaf00;">"foo</span>
</pre>
</div>
<pre class="example">
foo IS first rest
</pre>

<p>
It is possible to capture the display given by <a href="#sec-279">279</a> using the composition of operations <a href="#sec-78">78</a> <a href="#sec-76">76</a> <a href="#sec-130">130</a> Defname, which returns the list of lines of the display.  This technique is used in the operation <i>=defedit=</i>.
</p>
</div>

<div id="outline-container-sec-279-1" class="outline-3">
<h3 id="sec-279-1"><span class="section-number-3">279.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-279-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">see</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   Settings <span style="color: #00ffff;">gets</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span> <span style="color: #ffaf00;">"decor</span>;
   <span style="color: #ffff00;">ITERATE</span> <span style="color: #ffffff; font-weight: bold;">writescreen</span> <span style="color: #ffffff; font-weight: bold;">descan</span> <span style="color: #ffffff; font-weight: bold;">deparse</span> <span style="color: #ffffff; font-weight: bold;">getdef</span> A;
   <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">set</span> Settings; }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-280" class="outline-2">
<h2 id="sec-280"><span class="section-number-2">280</span> <code>seed</code></h2>
<div class="outline-text-2" id="text-280">

<p>
The operation seed sets the initial number for the random number generator used by random.  The argument Num is a positive decimal fraction less than 1.  Seed is used to get predictable results from a program that uses random.  Seed returns the value that would have been used to generate the next random number.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seed</span> .25374;
<span style="color: #ffffff; font-weight: bold;">floor</span> (100. <span style="color: #ff00ff; font-weight: bold;">*</span> <span style="color: #ffffff; font-weight: bold;">random</span> 3)
</pre>
</div>
<pre class="example">
60 73 83
</pre>
</div>
</div>

<div id="outline-container-sec-281" class="outline-2">
<h2 id="sec-281"><span class="section-number-2">281</span> <code>seek</code></h2>
<div class="outline-text-2" id="text-281">

<p>
The operation seek returns a pair of values.  The first is a boolean indicating whether or not A is an item of B.  The second is the address of the first occurrence of A as an item of B, searching B in row major order.  If A does not occur in B, the second item of the result is the gage of the shape of B.  Seek is the combination of in and find in one operation.
</p>


<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ffffff; font-weight: bold;">seek</span> 56 34 3 23 57 3
</pre>
</div>
<pre class="example">
l 2
</pre>

<div class="org-src-container">

<pre class="src src-nial">`a <span style="color: #ffffff; font-weight: bold;">seek</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
o 11
</pre>

<p>
Seek is useful when determining whether or not A is in B and, if it is, obtaining its position in B.  Both results are obtained in one internal computation rather than two separate ones.
</p>
</div>

<div id="outline-container-sec-281-1" class="outline-3">
<h3 id="sec-281-1"><span class="section-number-3">281.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-281-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seek</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { A [<span style="color: #ffffff; font-weight: bold;">in</span>,<span style="color: #ffffff; font-weight: bold;">find</span>] B }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-281-2" class="outline-3">
<h3 id="sec-281-2"><span class="section-number-3">281.2</span> Equations</h3>
<div class="outline-text-3" id="text-281-2">
<p>
#+begi<sub>src</sub> nial
   first (A seek B) = A in B
</p>

<p>
   second (A seek B) = A find B
#+end<sub>src</sub>
</p>
</div>
</div>

<div id="outline-container-sec-281-3" class="outline-3">
<h3 id="sec-281-3"><span class="section-number-3">281.3</span> Pragmatics</h3>
<div class="outline-text-3" id="text-281-3">
<p>
The operation seek uses a linear search on the items of B if the array has not been sorted, or uses a binary search algorithm if it has.  The latter fact suggests that an array that is searched frequently should be kept in lexicographical order by applying sortup to it when it is created.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-282" class="outline-2">
<h2 id="sec-282"><span class="section-number-2">282</span> <code>seeprimcalls</code></h2>
<div class="outline-text-2" id="text-282">

<p>
The operation seeprimcalls sets an internal flag to the setting of the boolean argument Mode.  If Mode is true, subsequent execution will monitor the use of all primitive defined expressions, operations and transformers and will print out a message indicating when the named primitive has completed execution.  If Mode is false it turns off the flag that controls monitoring.
</p>

<p>
This mode of execution is useful for following the execution flow during debugging.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seeprimcalls</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>
</div>

<div id="outline-container-sec-283" class="outline-2">
<h2 id="sec-283"><span class="section-number-2">283</span> <code>seeusercalls</code></h2>
<div class="outline-text-2" id="text-283">

<p>
The operation seeusercalls sets an internal flag to the setting of the boolean argument Mod.  If Mod is true, subsequent execution will monitor the use of all user defined expressions, operations and transformers and will print out a message indicating when definitions are entered and executed.  If Mod is false it turns off the flag that controls monitoring.
</p>

<p>
This mode of execution is useful for following the execution flow during debugging.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seeusercalls</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
<pre class="example">
o
</pre>
</div>
</div>

<div id="outline-container-sec-284" class="outline-2">
<h2 id="sec-284"><span class="section-number-2">284</span> <code>separator</code></h2>
<div class="outline-text-2" id="text-284">

<p>
The expression Separator returns the character used to separate names in the directory structure for the operating system.  For DOS and Windows systems, it is the backslash symbol "\".  For Unix, it is the slash symbol "/".
</p>
</div>
</div>

<div id="outline-container-sec-285" class="outline-2">
<h2 id="sec-285"><span class="section-number-2">285</span> <code>set</code></h2>
<div class="outline-text-2" id="text-285">

<p>
The operation set changes internal switches in the Q'Nial interpreter.  The switches are used to control the behaviour of a variety of optional features of Q'Nial.  The argument Sw is a string or phrase in either case.  The result of set is a phrase giving the setting of the switch as it was prior to the execution of the set operation.  The result can be used subsequently to restore the switch to its original value.  The valid phrases and their purposes are tabulated below:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Setting</th>
<th scope="col" class="left">Description of Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">diagram</td>
<td class="left">set default display mode to diagram</td>
</tr>

<tr>
<td class="left">sketch</td>
<td class="left">set default display mode to sketch</td>
</tr>

<tr>
<td class="left">decor</td>
<td class="left">turn on decoration of atoms and empty arrays</td>
</tr>

<tr>
<td class="left">nodecor</td>
<td class="left">turn off decoration of atoms and empty arrays</td>
</tr>

<tr>
<td class="left">trace</td>
<td class="left">turn on tracing of expressions at the top level</td>
</tr>

<tr>
<td class="left">notrace</td>
<td class="left">turn off tracing of expressions at the top level</td>
</tr>

<tr>
<td class="left">log</td>
<td class="left">turn on the automatic logging of the session</td>
</tr>

<tr>
<td class="left">nolog</td>
<td class="left">turn off the automatic logging of the session</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ;
displayinsketchmode <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> Result {
   A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>; <span style="color: #ffffff; font-weight: bold;">write</span> <span style="color: #ffffff; font-weight: bold;">picture</span> Result; <span style="color: #ffffff; font-weight: bold;">set</span> A ; }
</pre>
</div>

<p>
In the above definition, sketch mode is set at the beginning, saving the previous setting in the variable A.  When the definition is ended, the mode is reset to the value in A.  The default settings are sketch, nodecor, notrace and nolog.
</p>
</div>
</div>

<div id="outline-container-sec-286" class="outline-2">
<h2 id="sec-286"><span class="section-number-2">286</span> <code>setdeftrace</code></h2>
<div class="outline-text-2" id="text-286">

<p>
The operation setdeftrace changes the trace mode for the user defined expression, operation or transformer definition named by the string or phrase Defname.  Mode is an optional argument.  If it is omitted, the trace mode is toggled.  If Mode is present and has the value 1, it turns trace on.  Otherwise it turns trace off.  The effect when the trace mode is on is to trace the execution of the body of the operation whenever the operation is executed.
</p>

<p>
The trace mechanism shows intermediate values in the evaluation of expressions.
</p>

<p>
The operation returns the previous setting.  If the result of setdeftrace is assigned to a variable, the previous setting can be restored later.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">library</span> <span style="color: #ffaf00;">"average</span>
</pre>
</div>
<pre class="example">
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setdeftrace</span> <span style="color: #ffaf00;">"average</span>
</pre>
</div>
<pre class="example">
0
</pre>



<div class="org-src-container">

<pre class="src src-nial">average 3 4 5
</pre>
</div>
<pre class="example">
...trace call to operation
...average
...the arguments for the opform are
...A
...A
3 4 5
...A
3 4 5
...sum A
12
...sum A / tally A
4.
...end of operation call
4.
</pre>

<p>
The tracing facility for expressions does not trace all intermediate computations.  Parentheses around an expression will force its result to be shown during a trace.
</p>
</div>
</div>

<div id="outline-container-sec-287" class="outline-2">
<h2 id="sec-287"><span class="section-number-2">287</span> <code>setformat</code></h2>
<div class="outline-text-2" id="text-287">

<p>
The operation setformat controls the format used for picturing real numbers.  String is a format specification for real numbers using the conventions for the C library routine printf.  There are three styles of format:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Control</th>
<th scope="col" class="left">Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">%f</td>
<td class="left">displays a fixed number of places after the decimal point in a fixed size space with no scaling of the number</td>
</tr>

<tr>
<td class="left">%e</td>
<td class="left">displays the number in scientific notation with an exponent scaling the number to have one digit before the decimal point</td>
</tr>

<tr>
<td class="left">%g</td>
<td class="left">displays the number in f format if possible but defaults to e format if the number is not within a suitable range</td>
</tr>
</tbody>
</table>

<p>
A code can be inserted between the percent sign and the letter.  Format '%15.5f' uses a field of width 15 to display a number in f format with 5 decimal places.  The first digit is the width of the field.  For f format, the second digit gives the number of places after the decimal while for e and g it indicates the number of significant digits to be displayed.  Either digit can be omitted.
</p>

<p>
Q'Nial requires that the display of a real number includes a decimal point and that the display of an integer does not include a decimal point.  In a %g format, printf does not include a decimal point if the real number matches an integer to the specified precision.  In this case, Q'Nial makes the field one space wider than that specified in order to accommodate the decimal point.  If an f format is not wide enough to accommodate the number, it is widened so that the number is displayed.
</p>

<p>
If the result of an f format requires more than 40 digits to the left of the decimal point, it is converted to e format.
</p>

<p>
The format '%.17g' is used by operation display in depicting real numbers as this format is accurate enough to reproduce the same number when executed on most systems.  The default format is '%g'.  It works as in C except that a period may be added to distinguish the result from an integer constant.  If the argument to setformat is '' then it resets the formatting to the default value.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%.5f'</span> ;
<span style="color: #ffffff; font-weight: bold;">post</span> <span style="color: #ffffff; font-weight: bold;">exp</span> 10. 80. 90. 100.
</pre>
</div>
<pre class="example">
                                  22026.46579
    55406223843935098300000000000000000.00000
    1220403294317840830000000000000000000000.
2.688117141816135610000000000000000000000e+43
</pre>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 2 2 <span style="color: #ffffff; font-weight: bold;">reshape</span>  9777.985 4464784.692 4070333.511 0.079;
<span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%15.7f'</span> ; [<span style="color: #ffffff; font-weight: bold;">pass</span>,<span style="color: #ffffff; font-weight: bold;">sqrt</span>] X
</pre>
</div>
<pre class="example">
+-------------------------------+-------------------------------+
|   9777.9850000 4464784.6920000|     98.8836943    2113.0037132|
|4070333.5110000       0.0790000|   2017.5067561       0.2810694|
+-------------------------------+-------------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span>  <span style="color: #00ff00;">'%15.7g'</span> ; [<span style="color: #ffffff; font-weight: bold;">pass</span>,<span style="color: #ffffff; font-weight: bold;">sqrt</span>] X
</pre>
</div>
<pre class="example">
+---------------------------------+-------------------------------+
|        9777.985         4464785.|       98.88369        2113.004|
|        4070334.            0.079|       2017.507       0.2810694|
+---------------------------------+-------------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setformat</span> <span style="color: #00ff00;">'%15.7e'</span> ; [<span style="color: #ffffff; font-weight: bold;">pass</span>,<span style="color: #ffffff; font-weight: bold;">sqrt</span>] X
</pre>
</div>
<pre class="example">
+-------------------------------+-------------------------------+
|  9.7779850e+03   4.4647847e+06|  9.8883694e+01   2.1130037e+03|
|  4.0703335e+06   7.9000000e-02|  2.0175068e+03   2.8106939e-01|
+-------------------------------+-------------------------------+
</pre>
</div>
</div>

<div id="outline-container-sec-288" class="outline-2">
<h2 id="sec-288"><span class="section-number-2">288</span> <code>setinterrupts</code></h2>
<div class="outline-text-2" id="text-288">

<p>
The operation setinterrupts permits or prevents the interruption of computation by the use of &lt;Ctrl C&gt;.  If the argument is true, interrupts are permitted.  If it is false, they are blocked.  The default value is true.
</p>

<p>
Setinterrupts is used in a closed application to prevent the user from interfering with a computation in process.  This may be critical if a file is being updated in a sequence of steps, which must all be completed for the data base to remain consistent.
</p>
</div>
</div>

<div id="outline-container-sec-289" class="outline-2">
<h2 id="sec-289"><span class="section-number-2">289</span> <code>setlogname</code></h2>
<div class="outline-text-2" id="text-289">

<p>
The operation setlogname is used to set the name of the host file in which a log of the session is recorded.  The current log file is closed and a new one opened.  The argument Filename must be a phrase or a string.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setlogname</span> <span style="color: #ffaf00;">"dec17pm</span>
</pre>
</div>

<p>
The main purpose of setlogname is to capture the history of part of a session in a particular file for later use.  The log file can produce documentation, for example.
</p>
</div>
</div>

<div id="outline-container-sec-290" class="outline-2">
<h2 id="sec-290"><span class="section-number-2">290</span> <code>setprofile</code></h2>
<div class="outline-text-2" id="text-290">

<p>
The operation setprofile is used to turn on or turn off the gathering of profiling statistics.  The calls must be made at the same scope level in order for profiling to work correctly.  This can either be at the top level, or within the body of some expression or operation.
</p>

<p>
The argument is a boolean value: true starts the profiling process and false stops it.  Profiling can be turned on and off several times within one profiling session.
</p>

<p>
A detailed explanation of the profiling mechanism is given in the help entry on profiling.
</p>
</div>

<div id="outline-container-sec-290-1" class="outline-3">
<h3 id="sec-290-1"><span class="section-number-3">290.1</span> Example of use:</h3>
<div class="outline-text-3" id="text-290-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setprofile</span> <span style="color: #ffffff; font-weight: bold;">True</span>
</pre>
</div>
<p>
o
</p>
</div>
</div>
</div>

<div id="outline-container-sec-291" class="outline-2">
<h2 id="sec-291"><span class="section-number-2">291</span> <code>setprompt</code></h2>
<div class="outline-text-2" id="text-291">

<p>
The operation setprompt sets the Q'Nial prompt to be the string or phrase S.  The default prompt is the string with 5 blank spaces.  The maximum size of a prompt is forty characters.  Setprompt provides the facility to set a visible prompt which can be distinguished from prompts issued by other software.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setprompt</span> <span style="color: #00ff00;">'qnial&gt;'</span>
</pre>
</div>
<pre class="example">
qnial&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-292" class="outline-2">
<h2 id="sec-292"><span class="section-number-2">292</span> <code>settrigger</code></h2>
<div class="outline-text-2" id="text-292">

<p>
The operation settrigger sets the action taken when a fault is generated in an operation.  If Switch is true, whenever a fault is generated, computation is interrupted, a message is displayed indicating the fault that has occurred and the expression where it occurred. Then the Callstack is displayed and a loop is entered that allows you to explore the cause of the fault. If you press Return at the prompt, control is sent to the top level loop.
</p>

<p>
If Switch is false, fault triggering is turned off.
</p>

<p>
The default setting at the start of a session is fault triggering on.  The triggering of an interrupt by fault generation can be turned off for the session by using the -s command line option in console versions or by setting preferences in the GUI version.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">settrigger</span> o
</pre>
</div>
<pre class="example">
l
</pre>
</div>
</div>

<div id="outline-container-sec-293" class="outline-2">
<h2 id="sec-293"><span class="section-number-2">293</span> <code>setwidth</code></h2>
<div class="outline-text-2" id="text-293">

<p>
The operation setwidth sets the width of the display and log lines.  The argument is an integer N.  The result is the previous setting.  The default setting is 80.
</p>

<p>
Setwidth is useful in controlling the format of display on output saved for documentation purposes.  For example, a setting of 130 allows wide Nial diagrams to be printed on a line printer even though they may not display properly on the screen.  Narrower settings are convenient for use in reports.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">setwidth</span> 50
</pre>
</div>
<pre class="example">
80
</pre>
</div>
</div>

<div id="outline-container-sec-294" class="outline-2">
<h2 id="sec-294"><span class="section-number-2">294</span> <code>shape</code></h2>
<div class="outline-text-2" id="text-294">

<p>
The operation shape returns an array that describes the rectangular structure of array A.  Every array has a shape.  For a single, including atoms, the shape is the empty list Null.  For a list, it is a solitary holding the integer giving the length of the list.  For a table or higher valence array, it is a list of integers giving the extent (number of items) along each axis.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> 5 6 7
</pre>
</div>
<pre class="example">
3
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> 4 5 6 7 8 9;
<span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
<pre class="example">
2 3
</pre>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> 2 3 4 5 0 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> 2 ;
<span style="color: #ffffff; font-weight: bold;">shape</span> B
</pre>
</div>
<pre class="example">
2 3 4 5 0 2
</pre>

<p>
The operation shape always returns a list whereas tally returns an integer.  An empty array such as B is one with a zero in its shape.
</p>
</div>

<div id="outline-container-sec-294-1" class="outline-3">
<h3 id="sec-294-1"><span class="section-number-3">294.1</span> Equations</h3>
<div class="outline-text-3" id="text-294-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A
<span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-295" class="outline-2">
<h2 id="sec-295"><span class="section-number-2">295</span> <code>simple</code></h2>
<div class="outline-text-2" id="text-295">

<p>
The operation simple tests whether or not an array has all atomic items or is an empty array.  The result is true if the array is simple and false if it is not.
</p>


<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffffff; font-weight: bold;">simple</span> 2 3 4) (<span style="color: #ffffff; font-weight: bold;">simple</span> <span style="color: #ffaf00;">"abc</span>)
</pre>
</div>
<pre class="example">
ll
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">simple</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">simple</span> (2 3) (4 5 6)
</pre>
</div>
<pre class="example">
o
</pre>


<div class="org-src-container">

<pre class="src src-nial">(<span style="color: #ffffff; font-weight: bold;">simple</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3)
</pre>
</div>
<pre class="example">
o
</pre>


<p>
The first two examples show that a list of integers, an atom and the empty list Null are all simple arrays.  The next two examples show that a pair of lists and the result of a tell are not simple.
</p>
</div>

<div id="outline-container-sec-295-1" class="outline-3">
<h3 id="sec-295-1"><span class="section-number-3">295.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-295-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">simple</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-295-2" class="outline-3">
<h3 id="sec-295-2"><span class="section-number-3">295.2</span> Equation</h3>
<div class="outline-text-3" id="text-295-2">
<p>
simple A = and EACH atomic A
</p>
</div>
</div>
</div>

<div id="outline-container-sec-296" class="outline-2">
<h2 id="sec-296"><span class="section-number-2">296</span> <code>sin</code></h2>
<div class="outline-text-2" id="text-296">

<p>
The operation sin implements the sine function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">sine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">sine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">sine of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?sin</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?sin</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sin</span>  l  -1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0.841 -0.841 0.479 ?sin ?sin ?error
</pre>
</div>

<div id="outline-container-sec-296-1" class="outline-3">
<h3 id="sec-296-1"><span class="section-number-3">296.1</span> Equations</h3>
<div class="outline-text-3" id="text-296-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sin</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">sin</span> A
(<span style="color: #ffffff; font-weight: bold;">sin</span> A <span style="color: #ffffff; font-weight: bold;">power</span> 2) <span style="color: #ff00ff; font-weight: bold;">+</span> (<span style="color: #ffffff; font-weight: bold;">cos</span> A <span style="color: #ffffff; font-weight: bold;">power</span> 2) <span style="color: #ff00ff; font-weight: bold;">=</span> 1.0   (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-297" class="outline-2">
<h2 id="sec-297"><span class="section-number-2">297</span> <code>single</code></h2>
<div class="outline-text-2" id="text-297">

<p>
The operation single returns an array with no axes holding A as its only item.  The result is an array with shape Null and is said to be a single.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">single</span> 2 3
</pre>
</div>
<pre class="example">
o---+
|2 3|
+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">3 <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> 3
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The first example illustrates that a single of a pair contains the pair as its item.  In both diagram and sketch modes, the display of a nonatomic single is decorated with an o in the upper left corner.  The second example illustrates that the single of an atom is the atom itself.
</p>
</div>

<div id="outline-container-sec-297-1" class="outline-3">
<h3 id="sec-297-1"><span class="section-number-3">297.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-297-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">single</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-297-2" class="outline-3">
<h3 id="sec-297-2"><span class="section-number-3">297.2</span> Equations</h3>
<div class="outline-text-3" id="text-297-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A

<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">atomic</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ffffff; font-weight: bold;">equal</span> A
<span style="color: #ffff00;">EACH</span> f <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span>  <span style="color: #ffffff; font-weight: bold;">single</span> f A
A <span style="color: #ffff00;">EACHLEFT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffff00;">EACHBOTH</span> f <span style="color: #ffffff; font-weight: bold;">single</span> B
A <span style="color: #ffff00;">EACHRIGHT</span> f B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ffff00;">EACHBOTH</span> f B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-298" class="outline-2">
<h2 id="sec-298"><span class="section-number-2">298</span> <code>sinh</code></h2>
<div class="outline-text-2" id="text-298">

<p>
The operation sinh implements the hyperbolic sine function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">hyperbolic sine of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">hyperbolic sine of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">hyperbolic sine of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?sinh</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?sinh</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sinh</span>  l  -1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1.1752 -1.1752 0.521095 ?sinh ?sinh ?error
</pre>
</div>

<div id="outline-container-sec-298-1" class="outline-3">
<h3 id="sec-298-1"><span class="section-number-3">298.1</span> Equation</h3>
<div class="outline-text-3" id="text-298-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sinh</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">sinh</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-299" class="outline-2">
<h2 id="sec-299"><span class="section-number-2">299</span> <code>sketch</code></h2>
<div class="outline-text-2" id="text-299">

<p>
The operation sketch computes a character table that gives the picture of the array A as it is displayed in sketch mode.  The details of the display of atoms and empty arrays is affected by the setting of the decor/nodecor switch.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sketch</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 1 3
</pre>
</div>

<p>
The sketch of an array provides an abbreviated display that often serves as an adequate output format for data.  The entry for picture has a more complete description of the picturing mechanism.
</p>
</div>

<div id="outline-container-sec-299-1" class="outline-3">
<h3 id="sec-299-1"><span class="section-number-3">299.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-299-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sketch</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   Old_setting <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>;
   Result <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">picture</span> A;
   <span style="color: #ffffff; font-weight: bold;">set</span> Old_setting;
   Result }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-299-2" class="outline-3">
<h3 id="sec-299-2"><span class="section-number-3">299.2</span> Equation</h3>
<div class="outline-text-3" id="text-299-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sketch</span> <span style="color: #ffffff; font-weight: bold;">sketch</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sketch</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-300" class="outline-2">
<h2 id="sec-300"><span class="section-number-2">300</span> <code>solitary</code></h2>
<div class="outline-text-2" id="text-300">

<p>
The operation solitary returns a list of length one holding A as its only item.  The result is said to be a solitary.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">solitary</span> 2 3
</pre>
</div>
<pre class="example">
+---+
|2 3|
+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span>; <span style="color: #ffffff; font-weight: bold;">solitary</span> 3
</pre>
</div>
<pre class="example">
+-+
|3|
+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"sketch</span>; <span style="color: #ffffff; font-weight: bold;">solitary</span> 3
</pre>
</div>
<pre class="example">
3
</pre>

<p>
The first example illustrates that a solitary of a pair contains the pair as its item.  The second example illustrates that the solitary of an atom is different from the atom itself.  However, as the third example shows, in sketch mode, the display of the solitary of an atom is not framed and hence may have the same display as the atom.
</p>
</div>

<div id="outline-container-sec-300-1" class="outline-3">
<h3 id="sec-300-1"><span class="section-number-3">300.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-300-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">solitary</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">Null</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-300-2" class="outline-3">
<h3 id="sec-300-2"><span class="section-number-3">300.2</span> Equations</h3>
<div class="outline-text-3" id="text-300-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A

<span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">hitch</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ffffff; font-weight: bold;">append</span> A
<span style="color: #ffffff; font-weight: bold;">solitary</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-301" class="outline-2">
<h2 id="sec-301"><span class="section-number-2">301</span> <code>solve</code></h2>
<div class="outline-text-2" id="text-301">

<p>
The operation solve solves the set of linear equations described by the equation A x = B  in matrix notation, where A is an N by N matrix and B is a vector of length N.  Provided that the matrix A is not singular, the result is the vector of length N satisfying the equation (within roundoff error).
</p>

<p>
In the computation, a numerical estimate is made of the singularity of A.  If A cannot be shown to be non-singular with a safe margin, the result of the operation is the fault ?singular.
</p>

<p>
The operation is extended to solve more than one right hand side.  If B is an N by M matrix, columns of N are viewed as right hand sides and the result is an N by M matrix with each column being the solution of the corresponding column.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">seed</span> .314159;
A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">ceiling</span> (100. <span style="color: #ff00ff; font-weight: bold;">*</span> (3 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">random</span> 9))
</pre>
</div>
<pre class="example">
 8 75 24
63 31 99
20 95 48
</pre>


<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">ceiling</span> (10. <span style="color: #ff00ff; font-weight: bold;">*</span>  <span style="color: #ffffff; font-weight: bold;">random</span> 3)
</pre>
</div>
<pre class="example">
4 9 5
</pre>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">solve</span> A
</pre>
</div>
<pre class="example">
0.787745 0.111836 -0.445402
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">innerproduct</span> X
</pre>
</div>
<pre class="example">
4. 9. 5.
</pre>



<div class="org-src-container">

<pre class="src src-nial">I <span style="color: #ff00ff;">:=</span> 0 1 2 <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">=</span> 0 1 2 <span style="color: #ff00ff; font-weight: bold;">*</span> 1.0
</pre>
</div>
<pre class="example">
1. 0. 0.
0. 1. 0.
0. 0. 1.
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">solve</span> I
</pre>
</div>
<pre class="example">
 0.614865   0.102516 -0.518872
0.0810811 0.00745573 -0.055918
-0.416667 -0.0574713  0.347701
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">inverse</span> A
</pre>
</div>
<pre class="example">
 0.614865   0.102516 -0.518872
0.0810811 0.00745573 -0.055918
-0.416667 -0.0574713  0.347701
</pre>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">solve</span> I <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">inverse</span> A
</pre>
</div>
<pre class="example">
l
</pre>

<p>
The final example shows that if the right hand side is set to the unit matrix of size N, solving it with A is equivalent to computing the inverse.
</p>

<p>
For large examples, it is always faster and more accurate to solve a system of equations directly using A solve B than to compute the inverse and do the inner product operation inverse A innerproduct B .  The first form does about half as many arithmetic steps.
</p>
</div>
</div>

<div id="outline-container-sec-302" class="outline-2">
<h2 id="sec-302"><span class="section-number-2">302</span> <code>SORT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-302">

<p>
The transformer SORT returns the list of items of array A ordered according to the comparator f.  The comparator f is the operation to be used in comparisons.  The operations &lt;= and &gt;= are the usual comparators.  If &gt;= is the comparator in SORT, the items are returned in decreasing order.  If &lt;= is the comparator in SORT, the items are returned in increasing order.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">SORT</span> <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> (<span style="color: #ffffff; font-weight: bold;">count</span> 10)
</pre>
</div>
<pre class="example">
10 9 8 7 6 5 4 3 2 1
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">SORT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span>(<span style="color: #ffaf00;">"some</span> <span style="color: #ffaf00;">"words</span> <span style="color: #ffaf00;">"not</span> <span style="color: #ffaf00;">"in</span> <span style="color: #ffaf00;">"order</span>)
</pre>
</div>
<pre class="example">
in not order some words
</pre>
</div>

<div id="outline-container-sec-302-1" class="outline-3">
<h3 id="sec-302-1"><span class="section-number-3">302.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-302-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">SORT</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffff00;">GRADE</span> f A <span style="color: #ffffff; font-weight: bold;">choose</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-302-2" class="outline-3">
<h3 id="sec-302-2"><span class="section-number-3">302.2</span> Equations</h3>
<div class="outline-text-3" id="text-302-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">SORT</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A

N an integer ==&gt; <span style="color: #ffff00;">SORT</span> <span style="color: #ff00ff; font-weight: bold;">&lt;=</span> <span style="color: #ffffff; font-weight: bold;">tell</span> N <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">tell</span> N
<span style="color: #ffff00;">SORT</span> f (<span style="color: #ffff00;">SORT</span> f A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">SORT</span> f A
</pre>
</div>

<p>
The sort is done internally using either a radix sort (on integers) or a list merge sort algorithm from Knuth's Vol 3 Searching and Sorting, Algorithm 5.2.5-L, improved according to exercise 12.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-303" class="outline-2">
<h2 id="sec-303"><span class="section-number-2">303</span> <code>sortup</code></h2>
<div class="outline-text-2" id="text-303">

<p>
The operation sortup returns the list of items of array A ordered according to the lexicographical ordering comparator up.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sortup</span> 3 7 5 4 9 8 2 1 6 10
</pre>
</div>
<pre class="example">
1 2 3 4 5 6 7 8 9 10
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sortup</span> (<span style="color: #ffaf00;">"some</span> <span style="color: #ffaf00;">"words</span> <span style="color: #ffaf00;">"not</span> <span style="color: #ffaf00;">"in</span> <span style="color: #ffaf00;">"order</span>)
</pre>
</div>
<pre class="example">
in not order some words
</pre>
</div>

<div id="outline-container-sec-303-1" class="outline-3">
<h3 id="sec-303-1"><span class="section-number-3">303.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-303-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sortup</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">SORT</span> <span style="color: #ffffff; font-weight: bold;">up</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-303-2" class="outline-3">
<h3 id="sec-303-2"><span class="section-number-3">303.2</span> Equation</h3>
<div class="outline-text-3" id="text-303-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">gradeup</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sortup</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-304" class="outline-2">
<h2 id="sec-304"><span class="section-number-2">304</span> <code>split</code></h2>
<div class="outline-text-2" id="text-304">

<p>
The operation split restructures array A by partitioning the items of A into arrays using the given axis numbers in I to determine the partition.  The axis numbers in I indicate the axes that are to become axes of the items.  The remaining axes are axes of the result.  The argument I must be an array of integers in tell valence A without duplicates.
</p>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 6
</pre>
</div>
<pre class="example">
1 2 3
4 5 6
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">split</span> A
</pre>
</div>
<pre class="example">
+-----+-----+
|1 2 3|4 5 6|
+-----+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">B <span style="color: #ff00ff;">:=</span> 2 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 24
</pre>
</div>
<pre class="example">
1  2  3  4   13 14 15 16
5  6  7  8   17 18 19 20
9 10 11 12   21 22 23 24
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">split</span> B
</pre>
</div>
<pre class="example">
+-----------+-----------+-----------+
|1 2 3 4    |5 6 7 8    |9 10 11 12 |
+-----------+-----------+-----------+
|13 14 15 16|17 18 19 20|21 22 23 24|
+-----------+-----------+-----------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 <span style="color: #ffffff; font-weight: bold;">split</span> B
</pre>
</div>
<pre class="example">
+--------+--------+--------+--------+
|1 5 9   |2 6 10  |3 7 11  |4 8 12  |
+--------+--------+--------+--------+
|13 17 21|14 18 22|15 19 23|16 20 24|
+--------+--------+--------+--------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 2 <span style="color: #ffffff; font-weight: bold;">split</span> B
</pre>
</div>
<pre class="example">
+----------+-----------+
|1  2  3  4|13 14 15 16|
|5  6  7  8|17 18 19 20|
|9 10 11 12|21 22 23 24|
+----------+-----------+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 0 <span style="color: #ffffff; font-weight: bold;">split</span> B
</pre>
</div>
<pre class="example">
+----+-----+-----+-----+
|1 13| 2 14| 3 15| 4 16|
|5 17| 6 18| 7 19| 8 20|
|9 21|10 22|11 23|12 24|
+----+-----+-----+-----+
</pre>

<p>
The first example shows that splitting along the last axis of an array is equivalent to taking its rows.  The second example shows that the split of the middle axis of a trivalent array is a table, with its shape given by the first and third axes.  The last two examples illustrate two axes being "pushed down".  The result is a list with tables as items.  The order of the axes in the item is determined by the order of the items in I.
</p>

<p>
The operation blend uses the same control argument to undo the effect of a split.  A common requirement is to partition an array along its axes, apply some operation f to the resulting items and to rebuild the result into its original form.  Partition is used to do this without computing all the intermediate structures.
</p>
</div>

<div id="outline-container-sec-304-1" class="outline-3">
<h3 id="sec-304-1"><span class="section-number-3">304.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-304-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">split</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> I A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">empty</span> A <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?empty right arg in split'</span>
   <span style="color: #00ffff;">ELSEIF</span> <span style="color: #ffffff; font-weight: bold;">not</span>(I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">diverse</span> I) <span style="color: #00ffff;">THEN</span>
      <span style="color: #ffffff; font-weight: bold;">fault</span> <span style="color: #00ff00;">'?invalid left arg in split'</span>
   <span style="color: #00ffff;">ELSE</span>
     J <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">except</span> <span style="color: #ffffff; font-weight: bold;">link</span> I;
     <span style="color: #ffffff; font-weight: bold;">tally</span> J <span style="color: #ffffff; font-weight: bold;">raise</span> (J <span style="color: #ffffff; font-weight: bold;">link</span> I <span style="color: #ffffff; font-weight: bold;">fuse</span> A)
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-304-2" class="outline-3">
<h3 id="sec-304-2"><span class="section-number-3">304.2</span> Equations</h3>
<div class="outline-text-3" id="text-304-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">~=</span> 0 ==&gt; <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">-</span> 1 <span style="color: #ffffff; font-weight: bold;">split</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">rows</span> A
<span style="color: #ffffff; font-weight: bold;">diverse</span> I <span style="color: #ffffff; font-weight: bold;">and</span> (I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A) ==&gt;
               <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">first</span> (I <span style="color: #ffffff; font-weight: bold;">split</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> (I <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A)
<span style="color: #ffffff; font-weight: bold;">diverse</span> I <span style="color: #ffffff; font-weight: bold;">and</span> (I <span style="color: #ffffff; font-weight: bold;">allin</span> <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A) ==&gt;
               <span style="color: #ffffff; font-weight: bold;">shape</span> (I <span style="color: #ffffff; font-weight: bold;">split</span> A) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">except</span> (I <span style="color: #ffffff; font-weight: bold;">choose</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-305" class="outline-2">
<h2 id="sec-305"><span class="section-number-2">305</span> <code>sqrt</code></h2>
<div class="outline-text-2" id="text-305">

<p>
The operation sqrt implements the square root function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">square root of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">square root of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">square root of A</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?sqrt</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?sqrt</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-305-1" class="outline-3">
<h3 id="sec-305-1"><span class="section-number-3">305.1</span> Example</h3>
<div class="outline-text-3" id="text-305-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sqrt</span>  o  1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0. 1. 0.707107 ?sqrt ?sqrt ?error
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sqrt</span>  4.0
</pre>
</div>
<pre class="example">
2.
</pre>
</div>
</div>

<div id="outline-container-sec-305-2" class="outline-3">
<h3 id="sec-305-2"><span class="section-number-3">305.2</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-305-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sqrt</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (A <span style="color: #ffffff; font-weight: bold;">power</span> .5)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-305-3" class="outline-3">
<h3 id="sec-305-3"><span class="section-number-3">305.3</span> Equation</h3>
<div class="outline-text-3" id="text-305-3">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sqrt</span> A <span style="color: #ffffff; font-weight: bold;">power</span> 2 <span style="color: #ff00ff; font-weight: bold;">=</span> A (within roundoff error)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-306" class="outline-2">
<h2 id="sec-306"><span class="section-number-2">306</span> standard definitions&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-306">

<p>
Q'Nial has a large set of predefined expressions, operations and transformers. Most of these are implemented directly in the interpreter. However, there are a number of them which are defined as standard definitions in the file defs.ndf. This file is placed in the initial subdirectory of nialroot that is used in initializing Q'Nial.  The definitions are embedded in the interpreter as a default set of standard definitions in case the interpreter cannot find the file.
</p>

<p>
When Q'Nial is invoked and the clear workspace is not found, the workspace is initialized with the standard definitions from defs.ndf. All definitions included in this stage cannot be modified or erased and the operation see does not display their text. A user can create their own initial set of definitions by editing defs.ndf to add or remove definitions.
</p>
</div>
</div>

<div id="outline-container-sec-307" class="outline-2">
<h2 id="sec-307"><span class="section-number-2">307</span> <code>status</code></h2>
<div class="outline-text-2" id="text-307">

<p>
The expression <a href="#sec-307">307</a> provides seven integers indicating the use of memory by Q'Nial.  In order of display, the items are as follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Index</th>
<th scope="col" class="left">Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="left">Number of free words in the workspace</td>
</tr>

<tr>
<td class="right">1</td>
<td class="left">Number of words in the largest free block</td>
</tr>

<tr>
<td class="right">2</td>
<td class="left">Number of free blocks</td>
</tr>

<tr>
<td class="right">3</td>
<td class="left">Total number of words in workspace</td>
</tr>

<tr>
<td class="right">4</td>
<td class="left">Stack size in words</td>
</tr>

<tr>
<td class="right">5</td>
<td class="left">Atom table size in words</td>
</tr>

<tr>
<td class="right">6</td>
<td class="left">Internal buffer size</td>
</tr>
</tbody>
</table>

<p>
The first entry is an indication of how full the workspace is when compared with the fourth entry.  A word can contain an integer, a reference to an array item, or 4 characters.  The second entry gives an upper limit to the number of integers that can be in a largest size array.  The third item is a measure of the fragmentation of memory.  The number of free words divided by the number of free blocks gives the average block size.  The fourth item gives the current size of the workspace.  It can grow provided the system has space available. The remaining entries give the sizes of internal areas that can grow as necessary.
</p>

<p>
The starting workspace size can be specified as a parameter to the nial command that starts a session in console versions or in a dialog box in a GUI version.  The workspace and the other areas can grow in size provided there is sufficient space and workspace growth is allowed (the default).
</p>

<p>
In Q'Nial for Windows the status entries can be displayed in a pop up window by selecting the Status field in the Workspace menu.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">status</span>
</pre>
</div>
<pre class="example">
64198 63828 5 100000 4000 6000 1000
</pre>
</div>
</div>

<div id="outline-container-sec-308" class="outline-2">
<h2 id="sec-308"><span class="section-number-2">308</span> <code>step</code></h2>
<div class="outline-text-2" id="text-308">

<p>
The command step is used in debugging a definition that has been suspended using Break or &lt;Ctrl B&gt;.  The effect of step is to execute the next expression in an expression sequence and to suspend execution again.  If the current expression involves a call on a defined operation or expression, execution is suspended on the first expression in its body.  If the current expression is the last one in the expression sequence where the break began, the effect is the same as using resume.
</p>

<p>
The related command stepv displays the result of the expression executed on a step before displaying the next expression.
</p>
</div>
</div>

<div id="outline-container-sec-309" class="outline-2">
<h2 id="sec-309"><span class="section-number-2">309</span> <code>stepin</code></h2>
<div class="outline-text-2" id="text-309">

<p>
The command <a href="#sec-309">309</a> is used in debugging a definition that has been suspended using Break or &lt;Ctrl B&gt;.  The effect of stepin is to execute the next expression in an expression sequence tracing the intermediate values generated and to suspend execution again.  If the current expression involves a call on a defined operation or expression, execution is suspended on the first expression in its body.  If the current expression is the last one in the expression sequence where the break began, the effect is the same as using resume.
</p>
</div>
</div>

<div id="outline-container-sec-310" class="outline-2">
<h2 id="sec-310"><span class="section-number-2">310</span> <i>strand notation</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-310">

<p>
A primary-sequence of length two or greater is called a strand.  The value of a strand is a list of values.  Each item of the list has the value of the primary-expression in the corresponding position in the primary-sequence.
</p>

<p>
The elements of the primary-sequence can be constants, parenthesized expressions or lists in bracket-comma notation.
</p>
<div class="org-src-container">

<pre class="src src-nial">8 9 10
</pre>
</div>
<pre class="example">
8 9 10
</pre>

<div class="org-src-container">

<pre class="src src-nial">8 (3 4 5) 18
</pre>
</div>
<pre class="example">
+-+-----+--+
|8|3 4 5|18|
+-+-----+--+
</pre>

<div class="org-src-container">

<pre class="src src-nial">8 <span style="color: #00ff00;">'abc'</span> <span style="color: #ffaf00;">"apple</span>
</pre>
</div>
<pre class="example">
+-+---+-----+
|8|abc|apple|
+-+---+-----+
</pre>

<div class="org-src-container">

<pre class="src src-nial">6 [7,8,9] 10
</pre>
</div>
<pre class="example">
+-+-----+--+
|6|7 8 9|10|
+-+-----+--+
</pre>
</div>
</div>

<div id="outline-container-sec-311" class="outline-2">
<h2 id="sec-311"><span class="section-number-2">311</span> <code>string</code></h2>
<div class="outline-text-2" id="text-311">

<p>
The operation string is used to convert an atom to a string that corresponds to the display of the atom.  The form of the string is not sensitive to the setting of the decor/nodecor display mode, returning the sketch of the undecorated atom.  The string of a string is the string itself.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"diagram</span> ; <span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
+-+-+-+
|a|b|c|
+-+-+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #00ff00;">'abc'</span>
</pre>
</div>
<pre class="example">
+-+-+-+
|a|b|c|
+-+-+-+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">string</span> 2.35
</pre>
</div>
<pre class="example">
+-+-+-+-+
|2|.|3|5|
+-+-+-+-+
</pre>

<p>
The string of a phrase is the string of the message in the phrase.  Thus, string is the left inverse of phrase.
</p>
</div>

<div id="outline-container-sec-311-1" class="outline-3">
<h3 id="sec-311-1"><span class="section-number-3">311.1</span> Equations</h3>
<div class="outline-text-3" id="text-311-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">isstring</span> S ==&gt; <span style="color: #ffffff; font-weight: bold;">string</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> S
<span style="color: #ffffff; font-weight: bold;">isstring</span> S ==&gt; <span style="color: #ffffff; font-weight: bold;">string</span> <span style="color: #ffffff; font-weight: bold;">phrase</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> S
<span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">string</span> S <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">string</span> S
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-312" class="outline-2">
<h2 id="sec-312"><span class="section-number-2">312</span> <code>string_split</code></h2>
<div class="outline-text-2" id="text-312">

<p>
The operation string<sub>split</sub> is used to break string S into substrings using the characters in C as places to break the string. If two characters in C are adjacent in S then an empty string is placed in the result. The optional third argument is an integer which limits the number of substrings returned.
</p>


<div class="org-src-container">

<pre class="src src-nial">string_split <span style="color: #00ff00;">' .'</span> <span style="color: #00ff00;">'The quick brown fox.'</span>
</pre>
</div>
<pre class="example">
+---+-----+-----+---+
|The|quick|brown|fox|
+---+-----+-----+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">string_split <span style="color: #00ff00;">' .,'</span> <span style="color: #00ff00;">'The quick, brown fox.'</span>
</pre>
</div>
<pre class="example">
+---+-----++-----+---+
|The|quick||brown|fox|
+---+-----++-----+---+
</pre>

<p>
The first example shows a string being broken on spaces and the period. The second is also broken on a comma and results in an empty string as one of the items of the result.
</p>
</div>
</div>

<div id="outline-container-sec-313" class="outline-2">
<h2 id="sec-313"><span class="section-number-2">313</span> <code>string_translate</code></h2>
<div class="outline-text-2" id="text-313">

<p>
The operation string<sub>translate</sub> is used to translate characters in string S based on mapping characters in C to the corresponding ones in D. The optional control argument O is a string or phrase where 'd' deletes the characters in C, 'c' complements characters by replacing characters not in C by the last character in D, and 's' translates characters in C to those in D but also squeezes many occurrences to one.
</p>


<div class="org-src-container">

<pre class="src src-nial">string_translate <span style="color: #00ff00;">'abc'</span> <span style="color: #00ff00;">'def'</span> <span style="color: #00ff00;">'hello able cats'</span>
</pre>
</div>
<pre class="example">
hello dele fdts
</pre>



<div class="org-src-container">

<pre class="src src-nial">string_translate <span style="color: #00ff00;">' '</span> <span style="color: #00ff00;">'_'</span> <span style="color: #00ff00;">'a whole lot of     loving'</span> <span style="color: #00ff00;">'s'</span>
</pre>
</div>
<pre class="example">
a_whole_lot_of_loving
</pre>

<div class="org-src-container">

<pre class="src src-nial">string_translate <span style="color: #00ff00;">'xz'</span> <span style="color: #00ff00;">''</span> <span style="color: #00ff00;">'extraneous zeal'</span> <span style="color: #00ff00;">'d'</span>
</pre>
</div>
<pre class="example">
etraneous eal
</pre>

<div class="org-src-container">

<pre class="src src-nial">string_translate <span style="color: #00ff00;">'xz'</span> <span style="color: #00ff00;">'b'</span> <span style="color: #00ff00;">'extraneous zeal'</span> <span style="color: #00ff00;">'c'</span>
</pre>
</div>
<pre class="example">
bxbbbbbbbbbzbbb
</pre>

<p>
The first example illustrates the translation of characters directly. The second shows translation with squeezing. The third example shows the use the 'd' option to delete characters. Example four shows the use of the complement option.
</p>
</div>
</div>

<div id="outline-container-sec-314" class="outline-2">
<h2 id="sec-314"><span class="section-number-2">314</span> <code>sublist</code></h2>
<div class="outline-text-2" id="text-314">

<p>
The operation sublist returns a list of items of B chosen according to the list of booleans given in A, selecting those items of B where the corresponding item of A is true.  If the tally of A is not the same as the tally of B, it is coerced to have the same tally as B using reshape.  If B is not a list, the result is the same as applying sublist to the list of B.  The tally of the result is the sum of A after it has been extended, if necessary.
</p>


<div class="org-src-container">

<pre class="src src-nial">lolloll <span style="color: #ffffff; font-weight: bold;">sublist</span> 2 3 4 8 5 10 6
</pre>
</div>
<pre class="example">
2 4 8 10 6
</pre>

<div class="org-src-container">

<pre class="src src-nial">lo <span style="color: #ffffff; font-weight: bold;">sublist</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
hlowrd
</pre>


<p>
The first example shows the use of sublist to select the items of the list that are even numbers.  The second example uses the left argument cyclically.
</p>
</div>

<div id="outline-container-sec-314-1" class="outline-3">
<h3 id="sec-314-1"><span class="section-number-3">314.1</span> Equations</h3>
<div class="outline-text-3" id="text-314-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffffff; font-weight: bold;">sublist</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> (<span style="color: #ffffff; font-weight: bold;">tally</span> B <span style="color: #ffffff; font-weight: bold;">reshape</span> A)
<span style="color: #ffffff; font-weight: bold;">list</span> (A <span style="color: #ffffff; font-weight: bold;">sublist</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">sublist</span> B
A <span style="color: #ffffff; font-weight: bold;">sublist</span> <span style="color: #ffffff; font-weight: bold;">list</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">sublist</span> B
l <span style="color: #ffffff; font-weight: bold;">sublist</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
o <span style="color: #ffffff; font-weight: bold;">sublist</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-315" class="outline-2">
<h2 id="sec-315"><span class="section-number-2">315</span> <code>sum</code></h2>
<div class="outline-text-2" id="text-315">

<p>
The operation sum adds the items of a simple array of numbers, reducing them to a single number that is their sum.  The type of the result is the highest type of the items.  The operation is extended to non-simple arrays by the multi pervasive mechanism.  For an empty simple array, the result is 0.  The symbol + is a synonym for sum.  The operation plus is sum restricted to use on pairs.
</p>

<div class="org-src-container">

<pre class="src src-nial">R <span style="color: #00ffff;">gets</span> l 2 2.5 `a <span style="color: #ffaf00;">"abc</span> ?<span style="color: brightred;">?error</span>;
R <span style="color: #ffff00;">OUTER</span> <span style="color: #ff00ff; font-weight: bold;">+</span> R
</pre>
</div>
<pre class="example">
     2       3     3.5  ?A  ?A  ?error
     3       4     4.5  ?A  ?A  ?error
   3.5     4.5      5.  ?A  ?A  ?error
?A      ?A      ?A      ?A  ?A  ?A
?A      ?A      ?A      ?A  ?A  ?A
?error  ?error  ?error  ?A  ?A  ?error
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> 3. 45. 23. 18. 3.5
</pre>
</div>
<pre class="example">
92.5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> (3 4 5) (2 3 2) (0 2 4) (1 1 1)
</pre>
</div>
<pre class="example">
6 10 12
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
0
</pre>


<p>
The first example shows the result of sum on all combinations of types of atoms.  The second last example shows that pervasive extension of sum adds a list of triples in an item by item fashion.  The last example shows that the sum of an empty array is 0.
</p>
</div>

<div id="outline-container-sec-315-1" class="outline-3">
<h3 id="sec-315-1"><span class="section-number-3">315.1</span> Equations</h3>
<div class="outline-text-3" id="text-315-1">
<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ffffff; font-weight: bold;">sum</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> B <span style="color: #ffffff; font-weight: bold;">sum</span> A
<span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> (<span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">single</span>) A
<span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">sum</span> A =f= <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffffff; font-weight: bold;">link</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">link</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">sum</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-316" class="outline-2">
<h2 id="sec-316"><span class="section-number-2">316</span> <code>symbols</code></h2>
<div class="outline-text-2" id="text-316">

<p>
The operation symbols is used to get information on the use of names in the workspace.  If Sw is 0, the result is a list of pairs giving the names and roles of all the user defined names.  If Sw is 1, the result is the similar list for both system and user names.  The roles and their meaning are as follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Role</th>
<th scope="col" class="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ident</td>
<td class="left">identifier</td>
</tr>

<tr>
<td class="left">var</td>
<td class="left">variable</td>
</tr>

<tr>
<td class="left">expr</td>
<td class="left">expression</td>
</tr>

<tr>
<td class="left">op</td>
<td class="left">operation</td>
</tr>

<tr>
<td class="left">tr</td>
<td class="left">transformer</td>
</tr>

<tr>
<td class="left">res</td>
<td class="left">reserved word</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5;

foo <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">rest</span>

<span style="color: #ffffff; font-weight: bold;">symbols</span> 0
</pre>
</div>
<pre class="example">
+-----+------+
|A var|FOO op|
+-----+------+
</pre>
</div>
</div>

<div id="outline-container-sec-317" class="outline-2">
<h2 id="sec-317"><span class="section-number-2">317</span> <i>synonym</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-317">

<p>
A synonym is an alternate symbol or name that represents a Nial term.  For example, the symbol
</p>

<p>
The list of all synonyms in Nial follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Alternate</th>
<th scope="col" class="left">Role</th>
<th scope="col" class="left">Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">div</td>
<td class="left">operation</td>
<td class="left">divide</td>
</tr>

<tr>
<td class="left">Falsehood, o</td>
<td class="left">expression</td>
<td class="left">False</td>
</tr>

<tr>
<td class="left">inv</td>
<td class="left">operation</td>
<td class="left">inverse</td>
</tr>

<tr>
<td class="left">ip</td>
<td class="left">operation</td>
<td class="left">innerproduct</td>
</tr>

<tr>
<td class="left">istruthvalue</td>
<td class="left">operation</td>
<td class="left">isboolean</td>
</tr>

<tr>
<td class="left">opp</td>
<td class="left">operation</td>
<td class="left">opposite</td>
</tr>

<tr>
<td class="left">prod</td>
<td class="left">operation</td>
<td class="left">product</td>
</tr>

<tr>
<td class="left">recip</td>
<td class="left">operation</td>
<td class="left">reciprocal</td>
</tr>

<tr>
<td class="left">Truth, l</td>
<td class="left">expression</td>
<td class="left">True</td>
</tr>

<tr>
<td class="left">vacate</td>
<td class="left">operation</td>
<td class="left">Null first</td>
</tr>

<tr>
<td class="left">void</td>
<td class="left">operation</td>
<td class="left">Null first</td>
</tr>

<tr>
<td class="left"><code>+</code></td>
<td class="left">operation</td>
<td class="left">sum</td>
</tr>

<tr>
<td class="left"><code>*</code></td>
<td class="left">operation</td>
<td class="left">product</td>
</tr>

<tr>
<td class="left"><code>/</code></td>
<td class="left">operation</td>
<td class="left">divide</td>
</tr>
</tbody>
</table>

<p>
The following synonyms are available for keywords or delimiters used in the syntax rules:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">[</td>
<td class="left">&lt;&lt;</td>
<td class="left">]</td>
</tr>

<tr>
<td class="left">&gt;&gt;</td>
<td class="left">:=</td>
<td class="left">GETS</td>
</tr>

<tr>
<td class="left">{</td>
<td class="left">BEGIN</td>
<td class="left">}</td>
</tr>

<tr>
<td class="left">END</td>
<td class="left">OPERATION</td>
<td class="left">OP</td>
</tr>

<tr>
<td class="left">TRANSFORMER</td>
<td class="left">TR</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-318" class="outline-2">
<h2 id="sec-318"><span class="section-number-2">318</span> <code>system</code></h2>
<div class="outline-text-2" id="text-318">
<p>
:Class:  constant expression
:Usage:  System
:SeeAlso: copyright, version, nialroot
:END:
</p>

<p>
The expression System returns a phrase indicating the operating system in use.  Possible values are EXTDOS, Windows or UNIX.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">System</span>
</pre>
</div>
<pre class="example">
Windows
</pre>
</div>
</div>

<div id="outline-container-sec-319" class="outline-2">
<h2 id="sec-319"><span class="section-number-2">319</span> <code>take</code></h2>
<div class="outline-text-2" id="text-319">

<p>
The operation take selects a number of items from B as indicated by A.
</p>

<p>
If B is a list and A is a non-negative integer, the result is the list formed from taking A items from the front of B.  If A is negative, it takes items from the right end of B.
</p>

<p>
If B is a table and A is a pair of non-negative integers, the result is the table formed by taking the number of rows and columns indicated by A from the upper left corner of B.  If one or both of the items of A are negative, the items are taken from the other end of the axis.
</p>

<p>
For higher dimensional arrays B, the tally of A must equal the valence of B and the result is obtained by taking from the front or back of the extents along each axis according to the sign of the corresponding item of A.
</p>

<p>
In all of the above cases, if an item of abs A is longer than the extent along the corresponding axis in B, the corresponding positions in the result are filled with the type of the first item of B.  If B is empty then the result is filled with the fault value ?fill.
</p>

<p>
If B is a single, the result is an array of shape abs A, with all its items equal to the item of B.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">take</span> <span style="color: #ffaf00;">"Able</span> <span style="color: #ffaf00;">"Baker</span> <span style="color: #ffaf00;">"Charlie</span> <span style="color: #ffaf00;">"Dog</span>
</pre>
</div>
<pre class="example">
Able Baker
</pre>

<div class="org-src-container">

<pre class="src src-nial">T1 <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 4
</pre>
</div>
<pre class="example">
+---+---+---+---+
|0 0|0 1|0 2|0 3|
+---+---+---+---+
|1 0|1 1|1 2|1 3|
+---+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">1 2 <span style="color: #ffffff; font-weight: bold;">take</span> T1
</pre>
</div>
<pre class="example">
+---+---+
|0 0|0 1|
+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">3 -5 <span style="color: #ffffff; font-weight: bold;">take</span> T1
</pre>
</div>
<pre class="example">
+---+---+---+---+---+
|0 0|0 0|0 1|0 2|0 3|
+---+---+---+---+---+
|0 0|1 0|1 1|1 2|1 3|
+---+---+---+---+---+
|0 0|0 0|0 0|0 0|0 0|
+---+---+---+---+---+
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 3 <span style="color: #ffffff; font-weight: bold;">take</span> <span style="color: #ffffff; font-weight: bold;">single</span> 3 5
</pre>
</div>
<pre class="example">
+---+---+---+
|3 5|3 5|3 5|
+---+---+---+
|3 5|3 5|3 5|
+---+---+---+
</pre>

<p>
The last example shows that taking from a single repeats the item of the single in every item of the result.
</p>
</div>

<div id="outline-container-sec-319-1" class="outline-3">
<h3 id="sec-319-1"><span class="section-number-3">319.1</span> Equations</h3>
<div class="outline-text-3" id="text-319-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">take</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> B <span style="color: #ffffff; font-weight: bold;">and</span> (<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> A) ==&gt; <span style="color: #ffffff; font-weight: bold;">shape</span> (A <span style="color: #ffffff; font-weight: bold;">take</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A
<span style="color: #ffffff; font-weight: bold;">valence</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> 0 <span style="color: #ffffff; font-weight: bold;">and</span> (<span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">isinteger</span> A) ==&gt; A <span style="color: #ffffff; font-weight: bold;">take</span> B <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">abs</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-320" class="outline-2">
<h2 id="sec-320"><span class="section-number-2">320</span> <del>takeright</del></h2>
<div class="outline-text-2" id="text-320">

<p>
The operation takeright is an obsolete operation that takes items from the ends of extents.  It is provided to retain compatibility with earlier versions of Q'Nial.
</p>
</div>

<div id="outline-container-sec-320-1" class="outline-3">
<h3 id="sec-320-1"><span class="section-number-3">320.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-320-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">takeright</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A B { <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ffffff; font-weight: bold;">take</span> B }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-321" class="outline-2">
<h2 id="sec-321"><span class="section-number-2">321</span> <code>tally</code></h2>
<div class="outline-text-2" id="text-321">

<p>
The operation tally returns an integer indicating the number of items of the array at the first level of nesting.  This is called the tally of the array.  The tally of a single is 1.  The tally of a list is the number of items in it.  The tally of a table is the product of the number of rows and columns.  In general, the tally of an array is the product of its shape.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffaf00;">"abc</span>
</pre>
</div>
<pre class="example">
1
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> 3 4 5
</pre>
</div>
<pre class="example">
3
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
<pre class="example">
11
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> (2 3) (4 5 6)
</pre>
</div>
<pre class="example">
2
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
12
</pre>
</div>

<div id="outline-container-sec-321-1" class="outline-3">
<h3 id="sec-321-1"><span class="section-number-3">321.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-321-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffffff; font-weight: bold;">product</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-321-2" class="outline-3">
<h3 id="sec-321-2"><span class="section-number-3">321.2</span> Equations</h3>
<div class="outline-text-3" id="text-321-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 1
<span style="color: #ffffff; font-weight: bold;">tally</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-322" class="outline-2">
<h2 id="sec-322"><span class="section-number-2">322</span> <code>tan</code></h2>
<div class="outline-text-2" id="text-322">

<p>
The operation tan implements the tangent function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">tangent of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">tangent of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">tangent of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tan</span>  l  -1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
1.55741 -1.55741 0.546302 ?A ?A ?error
</pre>
</div>

<div id="outline-container-sec-322-1" class="outline-3">
<h3 id="sec-322-1"><span class="section-number-3">322.1</span> Definition Equation</h3>
<div class="outline-text-3" id="text-322-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tan</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffffff; font-weight: bold;">sin</span> A <span style="color: #ffffff; font-weight: bold;">divide</span> <span style="color: #ffffff; font-weight: bold;">cos</span> A)
<span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">tan</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-323" class="outline-2">
<h2 id="sec-323"><span class="section-number-2">323</span> <code>tanh</code></h2>
<div class="outline-text-2" id="text-323">

<p>
The operation tanh implements the hyperbolic tangent function of mathematics.  It produces the following results when applied to atoms of the six types:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic Type</th>
<th scope="col" class="left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">hyperbolic tangent of the corresponding real</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">hyperbolic tangent of the corresponding real</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">hyperbolic tangent of angle A given in radians</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">fault ?A</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">argument A</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tanh</span>  l  -1  0.5  `a  <span style="color: #ffaf00;">"abc</span>  ?<span style="color: brightred;">?error</span>
</pre>
</div>
<pre class="example">
0.761594 -0.761594 0.462117 ?A ?A ?error
</pre>
</div>

<div id="outline-container-sec-323-1" class="outline-3">
<h3 id="sec-323-1"><span class="section-number-3">323.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-323-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tanh</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffffff; font-weight: bold;">sinh</span> A <span style="color: #ffffff; font-weight: bold;">divide</span> <span style="color: #ffffff; font-weight: bold;">cosh</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-323-2" class="outline-3">
<h3 id="sec-323-2"><span class="section-number-3">323.2</span> Equations</h3>
<div class="outline-text-3" id="text-323-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tanh</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">opposite</span> <span style="color: #ffffff; font-weight: bold;">tanh</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-324" class="outline-2">
<h2 id="sec-324"><span class="section-number-2">324</span> <code>TEAM</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-324">

<p>
The transformer TEAM applies the operations of atlas f to corresponding items in the list of A.  There must be the same number of items in A as there are operations in the atlas f.  The result has the shape of A.  If f is an operation that is not an atlas, TEAM f A is the application of f to A.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TEAM</span> [<span style="color: #ff00ff; font-weight: bold;">+</span>,<span style="color: #ff00ff; font-weight: bold;">*</span>,<span style="color: #ffffff; font-weight: bold;">max</span>,<span style="color: #ffffff; font-weight: bold;">min</span>] (3 2)(4 5)(2 3 4)(2 3 4)
</pre>
</div>
<pre class="example">
5 20 4 2
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TEAM</span> [<span style="color: #ff00ff; font-weight: bold;">+</span>,<span style="color: #ff00ff; font-weight: bold;">*</span>,<span style="color: #ffffff; font-weight: bold;">max</span>,<span style="color: #ffffff; font-weight: bold;">min</span>] <span style="color: #ffffff; font-weight: bold;">count</span> 2 2
</pre>
</div>
<pre class="example">
2 2
2 2
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TEAM</span> <span style="color: #ffffff; font-weight: bold;">second</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5
</pre>
</div>
<pre class="example">
2
</pre>
</div>
</div>

<div id="outline-container-sec-325" class="outline-2">
<h2 id="sec-325"><span class="section-number-2">325</span> <code>tell</code></h2>
<div class="outline-text-2" id="text-325">

<p>
The operation tell is used to generate an array of addresses from a shape.  For a non-negative integer N, it generates the list of integers from 0 to N - 1.  For a list of non-negative integers, tell generates the array of all combinations of tell applied to the items of the list.  If list A is not a shape, the result is the fault ?shape.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> 5
</pre>
</div>
<pre class="example">
0 1 2 3 4
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
+---+---+---+---+
|0 0|0 1|0 2|0 3|
+---+---+---+---+
|1 0|1 1|1 2|1 3|
+---+---+---+---+
|2 0|2 1|2 2|2 3|
+---+---+---+---+
</pre>

<p>
The examples show tell being applied to a shape and returning the array of addresses.
</p>
</div>

<div id="outline-container-sec-325-1" class="outline-3">
<h3 id="sec-325-1"><span class="section-number-3">325.1</span> Equations</h3>
<div class="outline-text-3" id="text-325-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A <span style="color: #ffffff; font-weight: bold;">choose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">isinteger</span> A <span style="color: #ffffff; font-weight: bold;">or</span> isshape A ==&gt; <span style="color: #ffffff; font-weight: bold;">tell</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">cart</span> <span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">tell</span> A
N an integer <span style="color: #ffffff; font-weight: bold;">and</span> (N <span style="color: #ff00ff; font-weight: bold;">&gt;=</span> 0) ==&gt; <span style="color: #ffffff; font-weight: bold;">tell</span> (N <span style="color: #ff00ff; font-weight: bold;">+</span> 1) <span style="color: #ff00ff; font-weight: bold;">=</span> (<span style="color: #ffffff; font-weight: bold;">tell</span> N <span style="color: #ffffff; font-weight: bold;">append</span> N)
<span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">tell</span> 0 <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">tell</span> 1 <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> 0
<span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> 1 <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> 0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-326" class="outline-2">
<h2 id="sec-326"><span class="section-number-2">326</span> <code>third</code></h2>
<div class="outline-text-2" id="text-326">

<p>
The operation third returns the third of the items of A.  Third is defined in terms of pick and its behaviour is affected by that of pick.  The third of a triple is its last item.  The third of a table is the third item in the list of items in row major order.  The third of an array with two or fewer items is the fault ?address.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">third</span> 4 5 6
</pre>
</div>
<pre class="example">
6
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">third</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 3 4
</pre>
</div>
<pre class="example">
0 2
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">third</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
0
</pre>
</div>

<div id="outline-container-sec-326-1" class="outline-3">
<h3 id="sec-326-1"><span class="section-number-3">326.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-326-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">third</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { 2 <span style="color: #ffffff; font-weight: bold;">pick</span> <span style="color: #ffffff; font-weight: bold;">list</span> A }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-326-2" class="outline-3">
<h3 id="sec-326-2"><span class="section-number-3">326.2</span> Equation</h3>
<div class="outline-text-3" id="text-326-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">third</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">third</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-327" class="outline-2">
<h2 id="sec-327"><span class="section-number-2">327</span> <code>time</code></h2>
<div class="outline-text-2" id="text-327">

<p>
The expression Time returns a real number giving the time in seconds spent in executing Q'Nial since the beginning of the session.  On systems permitting multi-processing, the time represents central processor time in seconds.
</p>

<p>
The expression Time is useful for estimating the relative costs of Q'Nial operations in terms of processor time.
</p>
</div>
</div>

<div id="outline-container-sec-328" class="outline-2">
<h2 id="sec-328"><a id="406ee6r0xhg0" name="406ee6r0xhg0"></a><span class="section-number-2">328</span> <span class="todo TODO">TODO</span> <code>TIMEIT</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-328">

<p>
// Undocumented transformer. Probably just records execution time.
</p>
</div>
</div>

<div id="outline-container-sec-329" class="outline-2">
<h2 id="sec-329"><span class="section-number-2">329</span> <code>times</code></h2>
<div class="outline-text-2" id="text-329">

<p>
The operation times is the same as product (and synonym *) except that it enforces the rule that it must be applied to a pair.  Product is multi pervasive and can add up any number of items.
</p>


<div class="org-src-container">

<pre class="src src-nial">7 <span style="color: #ffffff; font-weight: bold;">times</span> 9
</pre>
</div>
<pre class="example">
63
</pre>



<div class="org-src-container">

<pre class="src src-nial">(2 3 4) <span style="color: #ffffff; font-weight: bold;">times</span> (12 22 33)
</pre>
</div>
<pre class="example">
24 66 132
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">times</span> 2 3 4
</pre>
</div>
<pre class="example">
?times expects a pair
</pre>
</div>
</div>

<div id="outline-container-sec-330" class="outline-2">
<h2 id="sec-330"><span class="section-number-2">330</span> <code>timestamp</code></h2>
<div class="outline-text-2" id="text-330">

<p>
The expression Timestamp gives the current date and time in the standard format for the host system.  The details of this expression are implementation dependent.
</p>

<p>
The result is reported as a string giving the date and time.  Timestamp is useful for dating reports and messages.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Timestamp</span>
</pre>
</div>
<pre class="example">
Mon Jan 27 14:07:37 1997
</pre>
</div>
</div>

<div id="outline-container-sec-331" class="outline-2">
<h2 id="sec-331"><span class="section-number-2">331</span> <code>toend</code></h2>
<div class="outline-text-2" id="text-331">

<p>
The command toend is used in debugging a definition that has been suspended using Break or &lt;Ctrl B&gt;.  The effect of toend is to execute all the expressions to the end of the current loop or the end of the definition. If there is a loop then execution suspends on the expression following the loop. If the toend is issued when not in a loop, execution suspends on the expression being returned from the definition.
</p>
</div>
</div>

<div id="outline-container-sec-332" class="outline-2">
<h2 id="sec-332"><span class="section-number-2">332</span> <code>tolower</code></h2>
<div class="outline-text-2" id="text-332">

<p>
The operation tolower is used to ensure that a string has all its letters in lower case.  Applied to a string  A, it results in a string with all the upper case letters converted to lower case leaving all other characters unchanged.  It can also be used on a single character.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tolower</span> <span style="color: #00ff00;">'abcDE*?12xyZ'</span>
</pre>
</div>
<pre class="example">
abcde*?12xyz
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tolower</span> <span style="color: #00ff00;">'STATEMENT IN LOWER CASE'</span>
</pre>
</div>
<pre class="example">
statement in lower case
</pre>
</div>
</div>

<div id="outline-container-sec-333" class="outline-2">
<h2 id="sec-333"><span class="section-number-2">333</span> <code>tonumber</code></h2>
<div class="outline-text-2" id="text-333">

<p>
The operation tonumber converts the string A holding a character representation of a number to its corresponding numeric representation.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tonumber</span> <span style="color: #00ff00;">'345'</span>
</pre>
</div>
<pre class="example">
345
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tonumber</span> <span style="color: #00ff00;">'37.456'</span>
</pre>
</div>
<pre class="example">
37.456
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tonumber</span> <span style="color: #00ff00;">'123456789012345'</span>
</pre>
</div>
<pre class="example">
1.23457e+14
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tonumber</span> <span style="color: #00ff00;">'l'</span>
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tonumber</span> <span style="color: #00ff00;">'"abc'</span>
</pre>
</div>
<pre class="example">
?not a number
</pre>
</div>

<div id="outline-container-sec-333-1" class="outline-3">
<h3 id="sec-333-1"><span class="section-number-3">333.1</span> Equation</h3>
<div class="outline-text-3" id="text-333-1">
<div class="org-src-container">

<pre class="src src-nial">Numstr a <span style="color: #ffffff; font-weight: bold;">string</span> representing a number ==&gt; tostring Numstr <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">execute</span> Numstr
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-334" class="outline-2">
<h2 id="sec-334"><span class="section-number-2">334</span> top level loop&#xa0;&#xa0;&#xa0;<span class="tag"><span class="concept">concept</span></span></h2>
<div class="outline-text-2" id="text-334">

<p>
Nial program fragments are entered during interactive input with a process called the top level loop; or brought into the system under the control of a systems operation, loaddefs.  This systems operation has the effect of loading a sequence of program fragments from a file as though the fragments had been entered interactively in the order they appear in the file.
</p>

<p>
The global environment is the collection of associations between names and meanings that are known at the top level loop.  Such names have global scope in that they can be referenced by any program text.  All other names have a local scope that associates a meaning with the name only during execution of a specific portion of a program text.
</p>

<p>
In direct input at the top level loop, a remark ends at the end of the line unless a backslash symbol ( \ ) is used to extend the line.  In a definition file, a remark ends at the first blank line.  A remark cannot appear within a definition or expression-sequence.
</p>

<p>
The expressions in an expression-sequence are evaluated in left-to-right order.  If the sequence does not terminate with a semicolon, the array returned is the result of the last expression.  If the sequence does end with a semicolon, the array returned is the fault ?noexpr.  At the top level loop, if the array returned is the fault ?noexpr, it is not displayed.
</p>

<p>
In window mode for a console version of Q'Nial when a window is used interactively from the top level loop, the terminal acts as though it has a screen the size of the window.  In particular, as the cursor attempts to move below the bottom line of the window, the text is scrolled one line at a time.  The speed of scrolling can be changed using the operation setscroll.
</p>
</div>
</div>

<div id="outline-container-sec-335" class="outline-2">
<h2 id="sec-335"><span class="section-number-2">335</span> <code>topic</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="old">old</span></span></h2>
<div class="outline-text-2" id="text-335">

<p>
The operation topic uses the Q'Nial Help Facility for console versions to display help on the subject given as the argument to the operation.  Name should be a phrase or string naming a particular subject.
</p>
</div>
</div>

<div id="outline-container-sec-336" class="outline-2">
<h2 id="sec-336"><span class="section-number-2">336</span> <code>toplevel</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="ex">ex</span></span></h2>
<div class="outline-text-2" id="text-336">

<p>
The expression Toplevel ends the execution of the definition currently being executed and returns control to the top level loop where an operation named recover is executed if it is present in the workspace.
</p>

<p>
The major purpose for Toplevel is to handle an exception condition within a definition by forcing the definition to terminate.  Use of a recover operation makes it possible to recover gracefully in such cases.
</p>
</div>
</div>

<div id="outline-container-sec-337" class="outline-2">
<h2 id="sec-337"><span class="section-number-2">337</span> <code>toraw</code></h2>
<div class="outline-text-2" id="text-337">

<p>
The operation toraw converts the simple array A of real number, integers, or characters to a boolean array corresponding to the internal bit pattern for the data.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toraw</span> <span style="color: #00ff00;">'345'</span>
</pre>
</div>
<pre class="example">
oooooooooollololoolloloo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toraw</span> 345
</pre>
</div>
<pre class="example">
ooooooooooooooooooooooololollool
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toraw</span> 34.5
</pre>
</div>
<pre class="example">
ooooooooooooooooooooooooooooooooolooooooolooooololoooooooooooooo
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toraw</span> lollo
</pre>
</div>
<pre class="example">
lollo
</pre>
</div>

<div id="outline-container-sec-337-1" class="outline-3">
<h3 id="sec-337-1"><span class="section-number-3">337.1</span> Equation</h3>
<div class="outline-text-3" id="text-337-1">
<div class="org-src-container">

<pre class="src src-nial">imple A <span style="color: #ffffff; font-weight: bold;">and</span> <span style="color: #ffffff; font-weight: bold;">and</span> (<span style="color: #ffffff; font-weight: bold;">type</span> A <span style="color: #ffffff; font-weight: bold;">match</span> <span style="color: #ffffff; font-weight: bold;">type</span> <span style="color: #ffffff; font-weight: bold;">first</span> A) =&gt; A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">fromraw</span> (<span style="color: #ffffff; font-weight: bold;">toraw</span> A) (<span style="color: #ffffff; font-weight: bold;">first</span> A)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-338" class="outline-2">
<h2 id="sec-338"><span class="section-number-2">338</span> <code>toupper</code></h2>
<div class="outline-text-2" id="text-338">

<p>
The operation toupper is used to ensure that a string has all its letters in upper case.  Applied to a string A, it results in a string with all the lower case letters converted to upper case leaving all other characters unchanged.  It can also be used on a single character.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toupper</span> <span style="color: #00ff00;">'abcDE*?12xyZ'</span>
</pre>
</div>
<pre class="example">
ABCDE*?12XYZ
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">toupper</span> <span style="color: #00ff00;">'a statement in upper case'</span>
</pre>
</div>
<pre class="example">
A STATEMENT IN UPPER CASE
</pre>
</div>
</div>

<div id="outline-container-sec-339" class="outline-2">
<h2 id="sec-339"><span class="section-number-2">339</span> transformer</h2>
<div class="outline-text-2" id="text-339">

<p>
A transformer is a functional object that is used to construct a new operation from a given operation argument, usually producing a modified version of the given operation.  Most transformers used in Nial are provided in the core language.  However, there is a mechanism that constructs a named transformer in terms of one or more operation parameters.  A user-defined transformer describes the modified operation as a parameterized algorithm for manipulating data.
</p>

<p>
A transformer usually specifies a general algorithm which can have an operation as a parameter.  For example, the EACH family of transformers generalizes a number of looping mechanisms for applying an operation to items of arrays.
</p>

<p>
A user-defined transformer could provide the skeleton for processing the records of a file and allow an arbitrary operation to be applied to each record.  Such a transformer is often called a filter.
</p>

<p>
The process of evaluating an operation call of an operation modified by a transformer requires two steps.  The modified operation is formed; and then the modified operation is given the array argument which it uses to produce the result.
</p>


<div class="org-src-container">

<pre class="src src-nial">TWICE <span style="color: #00ffff;">is</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f (f f)

TWICE <span style="color: #ffffff; font-weight: bold;">rest</span> 4 5 6 7 8
</pre>
</div>
<pre class="example">
6 7 8
</pre>
</div>
</div>

<div id="outline-container-sec-340" class="outline-2">
<h2 id="sec-340"><span class="section-number-2">340</span> <i>transformer form</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-340">

<p>
A transformer-form is the syntactic structure used to describe a transformer in terms of an operation expression involving formal operation parameters.  The names that follow the keyword transformer in the transformer-form are called formal operation parameters.  The body of a transformer-form is the operation-expression which uses these names.  The first rule requires that the operation-expression be an operation-form; the second allows any operation- expression to be used.
</p>

<pre class="example">
transformer-form ::= TRANSFORMER
   { identifier }+ operation-form
   | TRANSFORMER { identifier }+
     ( operation-expression )
</pre>

<p>
The effect of applying a transformer-form to an operation-expression is the effect of an operation formed in the body of the transformer, such that wherever one of the formal operation parameters occurs, it is replaced with the corresponding argument operation-expression.
</p>

<p>
On the other hand, if the formal operation parameters consist of only one name, the operation formed is associated with the argument operation-expression.  If the operation formed has two or more names, the operation-expression must denote an atlas of the same length; and the formal operation parameters are associated with the operations of the atlas in their sequence.
</p>

<p>
The associations are made with the argument operation-expression in the environment where the transformer is applied.  If there is a mismatch between the number of formal operation parameters and the argument, the result of applying the transform is the fault ?tr<sub>parameter</sub>.
</p>
</div>
</div>

<div id="outline-container-sec-341" class="outline-2">
<h2 id="sec-341"><span class="section-number-2">341</span> <code>transpose</code></h2>
<div class="outline-text-2" id="text-341">

<p>
The operation transpose is used to reverse the axes of a table or array of higher valence.  If A is an M by N table, the transpose is the N by M table whose rows are the columns of A.  Transpose has no effect on a single or a list.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">transpose</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+
|0 0|1 0|
+---+---+
|0 1|1 1|
+---+---+
|0 2|1 2|
+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial">A <span style="color: #ff00ff;">:=</span> 2 3 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">count</span> 24
</pre>
</div>
<pre class="example">
1  2  3  4   13 14 15 16
5  6  7  8   17 18 19 20
9 10 11 12   21 22 23 24
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">transpose</span> A
</pre>
</div>
<pre class="example">
1 13    2 14    3 15    4 16
5 17    6 18    7 19    8 20
9 21   10 22   11 23   12 24
</pre>
</div>

<div id="outline-container-sec-341-1" class="outline-3">
<h3 id="sec-341-1"><span class="section-number-3">341.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-341-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">transpose</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A ( <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">tell</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ffffff; font-weight: bold;">fuse</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-341-2" class="outline-3">
<h3 id="sec-341-2"><span class="section-number-3">341.2</span> Equations</h3>
<div class="outline-text-3" id="text-341-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">transpose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
<span style="color: #ffffff; font-weight: bold;">transpose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">reverse</span> <span style="color: #ffffff; font-weight: bold;">axes</span> A <span style="color: #ffffff; font-weight: bold;">fuse</span> A
<span style="color: #ffffff; font-weight: bold;">transpose</span> <span style="color: #ffffff; font-weight: bold;">transpose</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> A
<span style="color: #ffffff; font-weight: bold;">transpose</span> <span style="color: #ffffff; font-weight: bold;">single</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">single</span> A
<span style="color: #ffffff; font-weight: bold;">transpose</span> <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-342" class="outline-2">
<h2 id="sec-342"><span class="section-number-2">342</span> <code>trs</code></h2>
<div class="outline-text-2" id="text-342">

<p>
The expression Trs returns a list of phrases giving the names of all user defined transformers in the workspace.
</p>
</div>

<div id="outline-container-sec-342-1" class="outline-3">
<h3 id="sec-342-1"><span class="section-number-3">342.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-342-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Trs</span> <span style="color: #00ffff;">IS</span> {
   Names Roles <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">symbols</span> 0;
   "<span style="color: #00ffff;">tr</span> <span style="color: #ffffff; font-weight: bold;">match</span> Roles <span style="color: #ffffff; font-weight: bold;">sublist</span> Names }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-343" class="outline-2">
<h2 id="sec-343"><span class="section-number-2">343</span> <code>true</code></h2>
<div class="outline-text-2" id="text-343">

<p>
The constant expression True denotes the boolean atom for true, which Nial also denotes by l.   It is the result of comparing two identical arrays for equality.
</p>
</div>

<div id="outline-container-sec-343-1" class="outline-3">
<h3 id="sec-343-1"><span class="section-number-3">343.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-343-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #00ffff;">IS</span> (0 <span style="color: #ffffff; font-weight: bold;">equal</span> 0)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-343-2" class="outline-3">
<h3 id="sec-343-2"><span class="section-number-3">343.2</span> Equations</h3>
<div class="outline-text-3" id="text-343-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> 1
<span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">single</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
<span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">False</span>
<span style="color: #ffffff; font-weight: bold;">max</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">True</span>
<span style="color: #ffffff; font-weight: bold;">abs</span> <span style="color: #ffffff; font-weight: bold;">True</span> <span style="color: #ff00ff; font-weight: bold;">=</span> 1
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-344" class="outline-2">
<h2 id="sec-344"><span class="section-number-2">344</span> <code>TWIG</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="tr">tr</span></span></h2>
<div class="outline-text-2" id="text-344">

<p>
The transformer TWIG transforms an operation f into an operation that applies f to every simple array in the nested structure of A.  The resulting operation is called the TWIG transform of f.  The result of applying the TWIG transform of f to A has the same shape as A.  If f maps simple arrays to simple arrays of the same shape, the result has the same structure as A.
</p>

<div class="org-src-container">

<pre class="src src-nial">T1 <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">count</span> 2 3
</pre>
</div>
<pre class="example">
+---+---+---+
|1 1|1 2|1 3|
+---+---+---+
|2 1|2 2|2 3|
+---+---+---+
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TWIG</span> <span style="color: #ffffff; font-weight: bold;">tally</span> T1
</pre>
</div>
<pre class="example">
2 2 2
2 2 2
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TWIG</span> <span style="color: #ffffff; font-weight: bold;">tell</span> T1
</pre>
</div>
<pre class="example">
+-----+---------+-------------+
|+---+|+---+---+|+---+---+---+|
||0 0|||0 0|0 1|||0 0|0 1|0 2||
|+---+|+---+---+|+---+---+---+|
+-----+---------+-------------+
|+---+|+---+---+|+---+---+---+|
||0 0|||0 0|0 1|||0 0|0 1|0 2||
|+---+|+---+---+|+---+---+---+|
||1 0|||1 0|1 1|||1 0|1 1|1 2||
|+---+|+---+---+|+---+---+---+|
+-----+---------+-------------+
</pre>

<p>
The first example shows that the result of applying a TWIG transform to a table is a table of the same shape.  The items of T1 are simple and hence have been mapped by tally to 2.  In the second example, the structure of the result is not preserved because tell maps a pair to a table of pairs.
</p>
</div>

<div id="outline-container-sec-344-1" class="outline-3">
<h3 id="sec-344-1"><span class="section-number-3">344.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-344-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">TWIG</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">TRANSFORMER</span> f <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A {
   <span style="color: #00ffff;">IF</span> <span style="color: #ffffff; font-weight: bold;">simple</span> A <span style="color: #00ffff;">THEN</span>
      f A
   <span style="color: #00ffff;">ELSE</span>
      <span style="color: #ffff00;">EACH</span> (<span style="color: #ffff00;">TWIG</span> f) A
   <span style="color: #00ffff;">ENDIF</span> }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-344-2" class="outline-3">
<h3 id="sec-344-2"><span class="section-number-3">344.2</span> Equations</h3>
<div class="outline-text-3" id="text-344-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffff00;">TWIG</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
f unary pervasive ==&gt; <span style="color: #ffff00;">TWIG</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> f A
(<span style="color: #ffff00;">TWIG</span> f) (<span style="color: #ffff00;">TWIG</span> g) A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">TWIG</span> (f g) A
<span style="color: #ffff00;">TWIG</span> f <span style="color: #ffffff; font-weight: bold;">list</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">list</span> <span style="color: #ffff00;">TWIG</span> f A
A <span style="color: #00ffff;">is</span> a <span style="color: #ffffff; font-weight: bold;">shape</span> ==&gt; <span style="color: #ffff00;">TWIG</span> f (A <span style="color: #ffffff; font-weight: bold;">reshape</span> B) <span style="color: #ff00ff; font-weight: bold;">=</span> A <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffff00;">TWIG</span> f B
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-345" class="outline-2">
<h2 id="sec-345"><span class="section-number-2">345</span> <code>type</code></h2>
<div class="outline-text-2" id="text-345">

<p>
The operation type maps an atom A to the representative value of the corresponding atomic type.  It is extended to arbitrary arrays by being unary pervasive.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Atomic type</th>
<th scope="col" class="left">Representative atom</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">boolean</td>
<td class="left">o</td>
</tr>

<tr>
<td class="left">integer</td>
<td class="left">0</td>
</tr>

<tr>
<td class="left">real</td>
<td class="left">0.</td>
</tr>

<tr>
<td class="left">character</td>
<td class="left">&lt;blank&gt;</td>
</tr>

<tr>
<td class="left">phrase</td>
<td class="left">"</td>
</tr>

<tr>
<td class="left">fault</td>
<td class="left">?</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">set</span> <span style="color: #ffaf00;">"decor</span>;
<span style="color: #ffffff; font-weight: bold;">type</span> l  3  3.3  `3  <span style="color: #00ff00;">'3.3'</span>  <span style="color: #ffaf00;">"33</span>
</pre>
</div>
<pre class="example">
+-+-+--+--+-----+--+
|o|0|0.|` |'   '|""|
+-+-+--+--+-----+--+
</pre>

<p>
The operation type is provided as a computational way of transforming an array to a standard value, while preserving structure and type information.  Executing a type test predicate, isboolean, isinteger, etc., is equivalent to testing that the type of an array is equal to the corresponding representative atom.
</p>
</div>
</div>

<div id="outline-container-sec-346" class="outline-2">
<h2 id="sec-346"><span class="section-number-2">346</span> unary pervasive</h2>
<div class="outline-text-2" id="text-346">

<p>
A unary pervasive operation maps an array to another array with identical structure, mapping each atom by the function's behaviour on atoms.  All of the scientific operations and the unary operations of arithmetic and logic are unary pervasive.
</p>

<p>
The scientific operations are implemented using the library routines provided with the C compiler used to construct Q'Nial.  The accuracy of the result is determined by the precision of the floating point number system of the computer and the accuracy of the library routine approximation.
</p>

<p>
The following table describes the unary pervasive operations:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operation</th>
<th scope="col" class="left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">abs</td>
<td class="left">absolute value</td>
</tr>

<tr>
<td class="left">arccos</td>
<td class="left">inverse cosine function</td>
</tr>

<tr>
<td class="left">arcsin</td>
<td class="left">inverse sine function</td>
</tr>

<tr>
<td class="left">arctan</td>
<td class="left">inverse tangent function</td>
</tr>

<tr>
<td class="left">ceiling</td>
<td class="left">lowest integer above a real number</td>
</tr>

<tr>
<td class="left">char</td>
<td class="left">integer to character conversion</td>
</tr>

<tr>
<td class="left">charrep</td>
<td class="left">character to integer conversion</td>
</tr>

<tr>
<td class="left">cos</td>
<td class="left">cosine function</td>
</tr>

<tr>
<td class="left">cosh</td>
<td class="left">hyperbolic cosine function</td>
</tr>

<tr>
<td class="left">exp</td>
<td class="left">exponential function</td>
</tr>

<tr>
<td class="left">floor</td>
<td class="left">next higher integer above a real number</td>
</tr>

<tr>
<td class="left">ln</td>
<td class="left">natural logarithm</td>
</tr>

<tr>
<td class="left">log</td>
<td class="left">logarithm base 10</td>
</tr>

<tr>
<td class="left">not</td>
<td class="left">opposite of a boolean value</td>
</tr>

<tr>
<td class="left">opposite</td>
<td class="left">opposite of a number</td>
</tr>

<tr>
<td class="left">reciprocal</td>
<td class="left">reciprocal of a number</td>
</tr>

<tr>
<td class="left">sin</td>
<td class="left">sine function</td>
</tr>

<tr>
<td class="left">sinh</td>
<td class="left">hyperbolic sine function</td>
</tr>

<tr>
<td class="left">sqrt</td>
<td class="left">square root of a number</td>
</tr>

<tr>
<td class="left">tan</td>
<td class="left">tangent function</td>
</tr>

<tr>
<td class="left">tanh</td>
<td class="left">hyperbolic tangent function</td>
</tr>

<tr>
<td class="left">type</td>
<td class="left">representative atom of same type</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-sec-346-1" class="outline-3">
<h3 id="sec-346-1"><span class="section-number-3">346.1</span> Equations</h3>
<div class="outline-text-3" id="text-346-1">
<div class="org-src-container">

<pre class="src src-nial">f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffff00;">EACH</span> f A
<span style="color: #ffffff; font-weight: bold;">shape</span> f A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-347" class="outline-2">
<h2 id="sec-347"><span class="section-number-2">347</span> <code>unequal</code></h2>
<div class="outline-text-2" id="text-347">

<p>
The operation
</p>

<div class="org-src-container">

<pre class="src src-nial">2 3 4 <span style="color: #ff00ff; font-weight: bold;">~=</span> [2,3,4]
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Null</span> <span style="color: #ff00ff; font-weight: bold;">~=</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial">2 (3 4) <span style="color: #ff00ff; font-weight: bold;">~=</span> (2 3) 4
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">unequal</span> (2 3) (2 3) (2 3)
</pre>
</div>
<pre class="example">
o
</pre>
</div>

<div id="outline-container-sec-347-1" class="outline-3">
<h3 id="sec-347-1"><span class="section-number-3">347.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-347-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">unequal</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">equal</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-348" class="outline-2">
<h2 id="sec-348"><span class="section-number-2">348</span> <code>up</code></h2>
<div class="outline-text-2" id="text-348">

<p>
The operation <a href="#sec-348">348</a> is used to do a lexicographic comparison of two arrays returning true if A is lexicographically less than or equal to B and false otherwise.  If A and B are atoms of the same type, then their values are compared using &lt;=, otherwise A is viewed as less than B if A has a lower type than B.  The types are ordered lowest to highest by boolean, integer, real, character, phrase, and fault.
</p>

<p>
If one of A and B is not atomic then the list of items of A are compared lexicographically to those of B.  The comparison is based on the first position where the items differ, and the result is the lexicographic comparison of the two items.  If the lists of items agree up to the point where one is exhausted, then the array with the shorter list precedes the longer one.
</p>

<p>
If A and B are arrays with the same list of items, then the comparison is decided by comparing their shapes lexicographically.
</p>

<div class="org-src-container">

<pre class="src src-nial">2 <span style="color: #ffffff; font-weight: bold;">up</span> 1.5
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">[2] <span style="color: #ffffff; font-weight: bold;">up</span> 3
</pre>
</div>
<pre class="example">
1
</pre>

<div class="org-src-container">

<pre class="src src-nial">5 <span style="color: #ffffff; font-weight: bold;">up</span> 3 4 5
</pre>
</div>
<pre class="example">
o
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">tell</span> 10 <span style="color: #ffffff; font-weight: bold;">up</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
l
</pre>

<div class="org-src-container">

<pre class="src src-nial">(2 2 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'abcd'</span>) <span style="color: #ffffff; font-weight: bold;">up</span> (1 4 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #00ff00;">'abcd'</span>)
</pre>
</div>
<pre class="example">
o
</pre>

<p>
The first example indicates that 2 precedes 1.5 because the two atoms are of different type and type integer precedes type real.  The second example is true because the lists of items differ in the first item, and 2 precedes 3.  In the third example the lists of items differ in the first item and 5 does not precede 3.  In the fourth example, the arrays differ in the first item and the up comparison of 0 and 0 0 is true because they agree in the first item and 0 is shorter.  In the final example, the result is false because the items are the same and the up comparison of 2 2 and 1 4 is false.
</p>
</div>

<div id="outline-container-sec-348-1" class="outline-3">
<h3 id="sec-348-1"><span class="section-number-3">348.1</span> Equations</h3>
<div class="outline-text-3" id="text-348-1">
<div class="org-src-container">

<pre class="src src-nial">(A <span style="color: #ffffff; font-weight: bold;">up</span> B) <span style="color: #ffffff; font-weight: bold;">and</span> (A <span style="color: #ff00ff; font-weight: bold;">~=</span> B) ==&gt; <span style="color: #ffffff; font-weight: bold;">not</span> (B <span style="color: #ffffff; font-weight: bold;">up</span> A)
A <span style="color: #ff00ff; font-weight: bold;">=</span> B ==&gt; A <span style="color: #ffffff; font-weight: bold;">up</span> B
(A <span style="color: #ffffff; font-weight: bold;">up</span> B) <span style="color: #ffffff; font-weight: bold;">and</span> (B <span style="color: #ffffff; font-weight: bold;">up</span> A) &lt;==&gt; A <span style="color: #ff00ff; font-weight: bold;">=</span> B
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-348-2" class="outline-3">
<h3 id="sec-348-2"><span class="section-number-3">348.2</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-348-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">sortup</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">SORT</span> <span style="color: #ffffff; font-weight: bold;">up</span>;
<span style="color: #ffffff; font-weight: bold;">gradeup</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffff00;">GRADE</span> <span style="color: #ffffff; font-weight: bold;">up</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-349" class="outline-2">
<h2 id="sec-349"><span class="section-number-2">349</span> <code>update</code></h2>
<div class="outline-text-2" id="text-349">

<p>
The operation <a href="#sec-349">349</a> provides the semantics of the <code>Nm@I := A</code> form of assignment expression.  Nm must be an existing variable represented by a string, phrase or a cast.  I is the address of the location to be updated.  A is the array to be placed in the variable.
</p>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 3 4 5; <span style="color: #ffffff; font-weight: bold;">update</span> <span style="color: #ffaf00;">"X</span> 0 8
</pre>
</div>
<pre class="example">
8 4 5
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">update</span> !X 2 <span style="color: #ffaf00;">"goodbye</span>
</pre>
</div>
<pre class="example">
8 4 goodbye
</pre>

<p>
The major purpose of <a href="#sec-349">349</a> is to allow a selective update at one location in the array associated with a global variable without forcing a copy.  By passing the name of the variable to the operation that is using update, rather than its value, no sharing of the internal data is made and hence the update can be done in place.
</p>
</div>
</div>

<div id="outline-container-sec-350" class="outline-2">
<h2 id="sec-350"><span class="section-number-2">350</span> <code>updateall</code></h2>
<div class="outline-text-2" id="text-350">

<p>
The operation updateall provides the semantics of the Nm#I := A form of assignment expression.  Nm must be an existing variable represented by a string, phrase or a cast.  I is the array of addresses of the locations to be updated.  A is the array of values to be placed in the variable.
</p>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 3 4 5;
<span style="color: #ffffff; font-weight: bold;">updateall</span> <span style="color: #ffaf00;">"X</span> (0 2) (8 10)
</pre>
</div>
<pre class="example">
8 4 10
</pre>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">updateall</span> !X (1 2) (<span style="color: #ffaf00;">"hello</span> <span style="color: #ffaf00;">"goodbye</span>)
</pre>
</div>
<pre class="example">
8 hello goodbye
</pre>


<p>
The major purpose of updateall is to allow a selective update at several locations in the array associated with a global variable without forcing a copy.  By passing the name of the variable to the operation that is using update, rather than its value, no sharing of the internal data is made, and hence the update can be done in place.
</p>
</div>
</div>

<div id="outline-container-sec-351" class="outline-2">
<h2 id="sec-351"><span class="section-number-2">351</span> user primitives</h2>
<div class="outline-text-2" id="text-351">

<p>
The Nial Tools software packages for Windows and for Unix provide a capability to extend the Q'Nial interpreters provided with each package by adding new user written primitives corresponding to expressions, operations and transformers. The new routines are written in "C" to meet the abstract machine interface for the Q'Nial interpreter.
</p>

<p>
This requires that the licensee have a C compiler that can produce object modules compatible with the object files provided with the package. The extended interpreter is built by linking the user written routines with object files.
</p>

<p>
This approach to extending Nial is appropriate if the new primitive is called frequently and one wants to avoid the overhead of using a DLL interface (under Windows) or the callc operation (under Unix).
</p>
</div>
</div>

<div id="outline-container-sec-352" class="outline-2">
<h2 id="sec-352"><span class="section-number-2">352</span> <code>vacate</code></h2>
<div class="outline-text-2" id="text-352">

<p>
The operation vacate is a renaming of the operation (0 reshape).  It is used in Version 4 of Array Theory to produce an empty array with the same prototype as its argument. In Version 6 of Array Theory it always returns Null.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">vacate</span> 3 (4 5)<span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>
</div>

<div id="outline-container-sec-352-1" class="outline-3">
<h3 id="sec-352-1"><span class="section-number-3">352.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-352-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">vacate</span> <span style="color: #00ffff;">is</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A ( 0 <span style="color: #ffffff; font-weight: bold;">reshape</span> A )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-352-2" class="outline-3">
<h3 id="sec-352-2"><span class="section-number-3">352.2</span> Equations</h3>
<div class="outline-text-3" id="text-352-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">vacate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">vacate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">void</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-353" class="outline-2">
<h2 id="sec-353"><span class="section-number-2">353</span> <code>valence</code></h2>
<div class="outline-text-2" id="text-353">

<p>
The operation valence returns an integer indicating the number of axes of A.  If A is a single, list or table, the result is 0, 1 or 2 respectively.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> 3
</pre>
</div>
<pre class="example">
0
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> 4 5 6
</pre>
</div>
<pre class="example">
1
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> <span style="color: #ffffff; font-weight: bold;">tell</span> 2 3
</pre>
</div>
<pre class="example">
2
</pre>



<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">valence</span> (0 0 0 0 1 1 0 1 <span style="color: #ffffff; font-weight: bold;">reshape</span> 3)
</pre>
</div>
<pre class="example">
8
</pre>
</div>

<div id="outline-container-sec-353-1" class="outline-3">
<h3 id="sec-353-1"><span class="section-number-3">353.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-353-1">
<div class="org-src-container">

<pre class="src src-nial">:     <span style="color: #ffffff; font-weight: bold;">valence</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A (<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">shape</span> A)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-353-2" class="outline-3">
<h3 id="sec-353-2"><span class="section-number-3">353.2</span> Equations</h3>
<div class="outline-text-3" id="text-353-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">shape</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">tally</span> <span style="color: #ffffff; font-weight: bold;">valence</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> 1
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-354" class="outline-2">
<h2 id="sec-354"><span class="section-number-2">354</span> <code>value</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="eval">eval</span></span></h2>
<div class="outline-text-2" id="text-354">

<p>
The operation value provides the semantics of value of a variable that is implicit whenever a variable is used in a value context.  The argument Nm is either a string or phrase denoting a variable or it is the cast of a variable.  The result is the value of the variable.  If Nm is a string or phrase, the value is sought in the environment at the point of application of value.  If Nm is a cast, the value is sought in the environment where the cast was created.  The major use of value is in conjunction with assign which allows arbitrary variables to be stored and later retrieved using value.
</p>


<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #ff00ff;">:=</span> 3 4 5 ; <span style="color: #ffffff; font-weight: bold;">value</span> <span style="color: #ffaf00;">"X</span> <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">value</span> !X
</pre>
</div>
<pre class="example">
l
</pre>
</div>
</div>

<div id="outline-container-sec-355" class="outline-2">
<h2 id="sec-355"><span class="section-number-2">355</span> <i>variable</i>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="syntax">syntax</span></span></h2>
<div class="outline-text-2" id="text-355">

<p>
A variable is a name associated with an array value.  Its syntactic form is that of an identifier.
</p>

<pre class="example">
variable ::= identifier
</pre>

<pre class="example">
indexed-variable ::=
     variable @ primary-expression
   | variable @@ primary-expression
   | variable # primary-expression
   | variable | primary-expression
</pre>

<p>
A variable is given an association with an array value by its use on the left side of an assign-expression, its appearance in a local or nonlocal declaration, its designation as a variable in an external-declaration or its use as the first argument of the operation assign.
</p>

<p>
When a variable is used as a primary-expression, its meaning is the array value associated with the identifier.  If the variable exists but has not been assigned, it will have as its default value the fault ?no<sub>value</sub>.  If an identifier is mentioned as a primary-expression but has not yet been given an association, a parse error will occur with the fault ?undefined identifier:.
</p>
</div>

<div id="outline-container-sec-355-1" class="outline-3">
<h3 id="sec-355-1"><span class="section-number-3">355.1</span> Role of a Variable</h3>
<div class="outline-text-3" id="text-355-1">
<p>
A variable gives a name to the result of a computation.  If the same result is needed later in the program, the named variable can be used, thereby avoiding the necessity of repeating the computation.  A variable can be assigned different array values throughout the computation.
</p>

<p>
Although an identifier can be of any length up to 80 characters, a compromise is usually made between choosing explicit variable names and choosing brief names to avoid unnecessary typing.  An identifier used as a variable cannot be a Q'Nial reserved word.  In a local environment, a variable identifier can be chosen the same as a predefined or user-defined global definition name.  Such a choice makes the global use of the name unavailable in the local context.
</p>

<p>
In any context, an identifier can name only one of: a variable, an array- expression, an operation-expression, or a transformer-expression.  During one session, the role of a name, i.e.  the class of syntactic object it names, cannot be changed.
</p>
</div>
</div>

<div id="outline-container-sec-355-2" class="outline-3">
<h3 id="sec-355-2"><span class="section-number-3">355.2</span> Indexed Variable</h3>
<div class="outline-text-3" id="text-355-2">
<p>
An indexed variable is a variable for which a part of the associated array value is referenced.  An index is the value of the primary-expression within an indexed-variable which specifies the location or locations of the part or parts of the array that are selected.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-356" class="outline-2">
<h2 id="sec-356"><span class="section-number-2">356</span> <code>vars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="sys">sys</span></span></h2>
<div class="outline-text-2" id="text-356">

<p>
The expression Vars returns a list of phrases giving the names of all user variables in the workspace.
</p>
</div>

<div id="outline-container-sec-356-1" class="outline-3">
<h3 id="sec-356-1"><span class="section-number-3">356.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-356-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Vars</span> <span style="color: #00ffff;">IS</span> {
   Names Roles <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">pack</span> <span style="color: #ffffff; font-weight: bold;">symbols</span> 0;
   <span style="color: #ffaf00;">"var</span> <span style="color: #ffffff; font-weight: bold;">match</span> Roles <span style="color: #ffffff; font-weight: bold;">sublist</span> Names }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-357" class="outline-2">
<h2 id="sec-357"><span class="section-number-2">357</span> <code>version</code></h2>
<div class="outline-text-2" id="text-357">

<p>
The expression Version returns a string containing the release and version number of Q'Nial.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Version</span>
</pre>
</div>
<pre class="example">
Q'Nial (Public Domain Edition) Version 6.3 PC Windows Aug  8 2005
</pre>
</div>
</div>

<div id="outline-container-sec-358" class="outline-2">
<h2 id="sec-358"><span class="section-number-2">358</span> <del>void</del></h2>
<div class="outline-text-2" id="text-358">

<p>
The operation void is an obsolete operation that has the same effect as the operation (0 reshape).  It is used in Version 4 of Array Theory to produce an empty array with A as its prototype. In Version 6 of Array Theory it always returns Null.
</p>


<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">void</span> 3 (4 5) <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
</pre>
</div>
<pre class="example">
l
</pre>
</div>

<div id="outline-container-sec-358-1" class="outline-3">
<h3 id="sec-358-1"><span class="section-number-3">358.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-358-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">void</span> <span style="color: #00ffff;">is</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A ( 0 <span style="color: #ffffff; font-weight: bold;">reshape</span> <span style="color: #ffffff; font-weight: bold;">solitary</span> A )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-358-2" class="outline-3">
<h3 id="sec-358-2"><span class="section-number-3">358.2</span> Equations</h3>
<div class="outline-text-3" id="text-358-2">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">void</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">Null</span>
<span style="color: #ffffff; font-weight: bold;">vacate</span> A <span style="color: #ff00ff; font-weight: bold;">=</span> <span style="color: #ffffff; font-weight: bold;">void</span> <span style="color: #ffffff; font-weight: bold;">first</span> A
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-359" class="outline-2">
<h2 id="sec-359"><span class="section-number-2">359</span> <code>watch</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="debug">debug</span></span></h2>
<div class="outline-text-2" id="text-359">

<p>
The operation watch provides a means to watch when a variable has its value changed.  The first argument to watch is a variable reference expressed as a cast.  For a global variable X, the cast is !X; for a local variable Y in definition G, the cast is !G:Y.
</p>

<p>
The second argument is a string of program text to be executed when the variable is changed.  If it is empty then it indicates that the watch should be removed.  The program text can display the value being set, execute a break, or take some other action.
</p>

<p>
The result of watch is the variable reference and the previous watch expression if any.  This can be used to restore the watch setting by storing it and using it as the argument to watch at a later time.
</p>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">count</span> 5;
<span style="color: #ffffff; font-weight: bold;">watch</span> !x <span style="color: #00ff00;">'write ''X changed to: '' X'</span>
</pre>
</div>
<pre class="example">
+------------------++
|+---+------------+||
||100|2 7926 42354|||
|+---+------------+||
+------------------++
</pre>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #00ffff;">gets</span> <span style="color: #00ff00;">'abc'</span>
</pre>
</div>
<pre class="example">
+--------------+---+
|X changed to: |abc|
+--------------+---+
abc
</pre>

<div class="org-src-container">

<pre class="src src-nial">X <span style="color: #00ffff;">gets</span> 3 4 5 6
</pre>
</div>
<pre class="example">
+--------------+-------+
|X changed to: |3 4 5 6|
+--------------+-------+
3 4 5 6
</pre>

<div class="org-src-container">

<pre class="src src-nial">foo <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">op</span> A { B <span style="color: #00ffff;">gets</span> <span style="color: #ffffff; font-weight: bold;">count</span> A; <span style="color: #ffffff; font-weight: bold;">reverse</span> B }

<span style="color: #ffffff; font-weight: bold;">watch</span> !foo:b  <span style="color: #00ff00;">'write ''B in foo changed to: '' B'</span>
</pre>
</div>
<pre class="example">
+--------------------------------------++
|+---+--------------------------------+||
||100|+--+------------+--------------+|||
||   ||50|2 7926 42470|23 7798 7798 B||||
||   |+--+------------+--------------+|||
|+---+--------------------------------+||
+--------------------------------------++
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">watchlist</span>
</pre>
</div>
<pre class="example">
+-----------------------------+----------------------------------------+
|+--+------------------------+|+------+-------------------------------+|
||!X|write 'X changed to: ' X|||!FOO:B|write 'B in foo changed to: ' B||
|+--+------------------------+|+------+-------------------------------+|
+-----------------------------+----------------------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">watch</span> !x <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
+------------------+------------------------+
|+---+------------+|write 'X changed to: ' X|
||100|2 7926 42354||                        |
|+---+------------+|                        |
+------------------+------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">watchlist</span>
</pre>
</div>
<pre class="example">
+----------------------------------------+
|+------+-------------------------------+|
||!FOO:B|write 'B in foo changed to: ' B||
|+------+-------------------------------+|
+----------------------------------------+
</pre>

<p>
To clear all watches use:
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">Watchlist</span> <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">watch</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-360" class="outline-2">
<h2 id="sec-360"><span class="section-number-2">360</span> <code>watchlist</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="debug">debug</span></span></h2>
<div class="outline-text-2" id="text-360">

<p>
The execution of Watchlist prints out a list of the variable watches that are in effect.
</p>

<p>
Its main use is to assist in clearing the watches as debugging proceeds.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">Watchlist</span>
</pre>
</div>
<pre class="example">
+-----------------------------+----------------------------------------+
|+--+------------------------+|+------+-------------------------------+|
||!X|write 'X changed to: ' X|||!FOO:B|write 'B in foo changed to: ' B||
|+--+------------------------+|+------+-------------------------------+|
+-----------------------------+----------------------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">watch</span> !x <span style="color: #00ff00;">''</span>
</pre>
</div>
<pre class="example">
+------------------+------------------------+
|+---+------------+|write 'X changed to: ' X|
||100|2 7926 42354||                        |
|+---+------------+|                        |
+------------------+------------------------+
</pre>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">watchlist</span>
</pre>
</div>
<pre class="example">
+----------------------------------------+
|+------+-------------------------------+|
||!FOO:B|write 'B in foo changed to: ' B||
|+------+-------------------------------+|
+----------------------------------------+
</pre>

<p>
To clear all watches use:
</p>
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffff00;">EACH</span> <span style="color: #ffffff; font-weight: bold;">first</span> <span style="color: #ffffff; font-weight: bold;">Watchlist</span> <span style="color: #ffff00;">EACHLEFT</span> <span style="color: #ffffff; font-weight: bold;">watch</span> <span style="color: #00ff00;">''</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-361" class="outline-2">
<h2 id="sec-361"><span class="section-number-2">361</span> <code>while</code>-loop&#xa0;&#xa0;&#xa0;<span class="tag"><span class="control">control</span></span></h2>
<div class="outline-text-2" id="text-361">

<p>
The WHILE-loop notation is used for executing an expression sequence repeatedly as long as a conditional expression returns true.
</p>

<div class="org-src-container">

<pre class="src src-nial">F <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">open</span> Filenm <span style="color: #ffaf00;">"r</span>;
Lines <span style="color: #ff00ff;">:=</span> <span style="color: #00ff00;">''</span>;
Line <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> F;
<span style="color: #00ffff;">WHILE</span> <span style="color: #ffffff; font-weight: bold;">not</span> <span style="color: #ffffff; font-weight: bold;">isfault</span> Line <span style="color: #00ffff;">DO</span>
  Lines <span style="color: #ff00ff;">:=</span> Lines <span style="color: #ffffff; font-weight: bold;">append</span> Line;
  Line <span style="color: #ff00ff;">:=</span> <span style="color: #ffffff; font-weight: bold;">readfile</span> F;
<span style="color: #00ffff;">ENDWHILE</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-362" class="outline-2">
<h2 id="sec-362"><span class="section-number-2">362</span> <code>window</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="gui">gui</span></span></h2>
<div class="outline-text-2" id="text-362">

<p>
The expression Window returns the parameters of the current window, Position, Size, Textcolor, Cursorcolor, Bordercolor and Title.  If no window is active, it returns a Null result.  The parameters returned are:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Argument</th>
<th scope="col" class="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Position</td>
<td class="left">a pair of integers giving the row and column of the upper left corner of the window in screen coordinates</td>
</tr>

<tr>
<td class="left">Size</td>
<td class="left">a pair of integers giving the height and width of the window in units of character positions</td>
</tr>

<tr>
<td class="left">Textcolor</td>
<td class="left">a control tuple specifying the attributes of window text</td>
</tr>

<tr>
<td class="left">Cursorcolor</td>
<td class="left">the control tuple specifying the attributes of cursor line characters</td>
</tr>

<tr>
<td class="left">Bordercolor</td>
<td class="left">the control tuple specifying the attributes of the border characters</td>
</tr>

<tr>
<td class="left">Title</td>
<td class="left">a string centered in the top of the window border</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-363" class="outline-2">
<h2 id="sec-363"><span class="section-number-2">363</span> <code>write</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="io">io</span></span></h2>
<div class="outline-text-2" id="text-363">

<p>
The operation write displays the picture of an array on the display screen.  The result is the no-expression fault <code>?noexpr</code>.  The picture displayed depends on the settings of the diagram/sketch and decor/nodecor switches.  The effect of write is the same as applying <a href="#sec-369">369</a> to the picture of the array.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">write</span> 3 (4 5);
</pre>
</div>
<pre class="example">
+-+---+
|3|4 5|
+-+---+
</pre>
</div>

<div id="outline-container-sec-363-1" class="outline-3">
<h3 id="sec-363-1"><span class="section-number-3">363.1</span> Definition&#xa0;&#xa0;&#xa0;<span class="tag"><span class="def">def</span></span></h3>
<div class="outline-text-3" id="text-363-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">write</span> <span style="color: #00ffff;">IS</span> <span style="color: #ffffff; font-weight: bold;">OPERATION</span> A { <span style="color: #ffffff; font-weight: bold;">writescreen</span> <span style="color: #ffffff; font-weight: bold;">picture</span> A }
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-364" class="outline-2">
<h2 id="sec-364"><span class="section-number-2">364</span> <code>writearray</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-364">

<p>
The operation writearray writes array A to the direct access file designated by F at component number N.  If a component already exists at that component number and A can fit in the space taken by that component, the existing one is overwritten.  If not, the new component is written at the end of the .rec file and the .ndx file is updated to indicate the starting point for the new component.  The space used by the previous value is recorded for a future compression.
</p>

<p>
The second argument N can be a list of numbers, in which case the items of A are written to the components designated by the integers in N.  The file must be open for direct access.  The other direct access file operations, readrecord and writerecord, must not be used on a file that is created using writearray.  However, eraserecord and filetally are used for both kinds of direct access files.
</p>

<p>
After a writearray or writerecord, if the total unused space is a significant amount of the space occupied by the .rec file, the file is compressed with the records being placed in order.
</p>

<p>
The content of an array component is placed in the file in a binary form independent of the workspace in which it was created.  Data that is written to a direct access file, erased, and then read in again, may take up more space in the workspace after this process due to lack of sharing of internal representations.
</p>
</div>
</div>

<div id="outline-container-sec-365" class="outline-2">
<h2 id="sec-365"><span class="section-number-2">365</span> <code>writechars</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-365">

<p>
The operation writechars writes S to the screen at the current cursor position, without supplying a trailing "new line" character.  Thus, the cursor is left at the position just after the text.  S may be a string, a phrase or a single character.  The principal use of writechars is in applications where the display screen is managed as a fixed object and scrolling must be avoided.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">writechars</span> <span style="color: #00ff00;">'hello world'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-366" class="outline-2">
<h2 id="sec-366"><span class="section-number-2">366</span> <code>writefield</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-366">

<p>
The operation writefield is used to write a character string to a portion of an existing host file.  The first argument is the file name, followed by the integer offset to the beginning of the field to be written and by the string to be written.  The result is the ?noexpr fault.
</p>
</div>

<div id="outline-container-sec-366-1" class="outline-3">
<h3 id="sec-366-1"><span class="section-number-3">366.1</span> Example</h3>
<div class="outline-text-3" id="text-366-1">
<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">writefield</span> <span style="color: #ffaf00;">"phonefile</span> 200 <span style="color: #00ff00;">'Mike Smith  389-4444'</span>
</pre>
</div>

<p>
In the example, writefield overwrites the contents of file phonefile starting at position 200 by the string given as the third argument.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-367" class="outline-2">
<h2 id="sec-367"><span class="section-number-2">367</span> <code>writefile</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-367">

<p>
The operation <a href="#sec-367">367</a> is used to write the character array S to the file designated by file designator N.  The file designator is an integer returned by open.  The file must have been opened for writing, appending or communication.
</p>

<p>
The argument S may be a character, a string, or an array of characters of any valence.  If it is a character or string, a single record is written to the file.  If it is a table, the rows of the table are written as records to the file.  The appropriate end-of-line indication is added for each record written.  If the argument S is empty, an empty record is written.
</p>

<p>
If <a href="#sec-367">367</a> is successful, the result is the no-expression fault <code>?noexpr</code>.  If the argument is not a character, string or character table, the fault ?not text data is returned.
</p>

<p>
If the optional third argument is present, it is used to indicate whether the end-of-line indication should be written.  If the third argument is o or 0 the indication is omitted; if it is l or 1, the indication is placed in the file.  This form of <a href="#sec-367">367</a> is used in communications mode to send information to a device driver on the EXTDOS version.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">writefile</span> 5 <span style="color: #00ff00;">'a line of text'</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-368" class="outline-2">
<h2 id="sec-368"><span class="section-number-2">368</span> <code>writerecord</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="file">file</span></span></h2>
<div class="outline-text-2" id="text-368">

<p>
The operation <a href="#sec-368">368</a> writes string S to the direct access file designated by F at component number N.
</p>

<p>
If a component already exists at that component number and S can fit in the space taken by that component, the existing one is overwritten.  If not, the new component is written at the end of the .rec file and the .ndx file is updated to indicate the starting point for the new component.
</p>

<p>
The second argument N can be a list of numbers, in which case the items of S must be strings and are written to the components designated by the integers in N.  The file must be open for direct access.  The other direct access file operations, <a href="#sec-244">244</a> and <a href="#sec-364">364</a>, must not be used on a file that is created using writerecord.  However, <a href="#sec-98">98</a> and <a href="#sec-115">115</a> are used for both kinds of direct access files.
</p>

<p>
The data written in the .rec file by <a href="#sec-368">368</a> does not contain any end-of-line indications unless they explicitly are part of the strings being written.
</p>
</div>
</div>

<div id="outline-container-sec-369" class="outline-2">
<h2 id="sec-369"><span class="section-number-2">369</span> <code>writescreen</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="io">io</span></span></h2>
<div class="outline-text-2" id="text-369">

<p>
The operation <a href="#sec-369">369</a> is used to write character data to the display screen.  The argument S may be a character, a string, or a character table.  If it is a character or string, a single line is displayed.  If it is a table, the rows of the table are written as lines.  If the argument S is empty, an empty line is displayed.  In window mode, the data is written within the bounds of the active window.
</p>

<p>
The result of the operation is the no-expression fault ?noexpr.  If the argument is not a character, string or character table, the fault ?not text data is returned.
</p>

<p>
After the text is displayed, the cursor is placed on the line following the last line written.
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">writescreen</span>  <span style="color: #00ff00;">'End of Manual'</span>;
</pre>
</div>

<p>
The operation <a href="#sec-369">369</a> is similar to the operation <a href="#sec-367">367</a>.  For most host systems, <a href="#sec-367">367</a> may be used with the standard output device to get the same effect as a <a href="#sec-369">369</a>.  The argument S may be a character, a string, or a character table.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
if A is in the range -1 to 1; otherwise, the fault ?arcsin
</p>

<div class="org-src-container">

<pre class="src src-nial"><span style="color: #ffffff; font-weight: bold;">arcsin</span> l -2 0.35
</pre>
</div>
<pre class="example">
1.5708 ?arcsin 0.357571
</pre></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p>DEFINITION NOT FOUND.</p></div>


</div>
</div></div>
</body>
</html>
